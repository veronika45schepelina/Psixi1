

```html
<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Центр супервизоров.рф</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Raleway:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        :root {
            --primary: #A88DC0;
            --primary-light: #B4A9D2;
            --primary-dark: #CDC7E3;
            --secondary: #E4D6E9;
            --accent: #F6EAF3;
            --text: #4A4A4A;
            --text-light: #6A6A6A;
            --background: #FFFFFF;
            --background-alt: #F6EAF3;
            --card: #FFFFFF;
            --shadow: rgba(168, 141, 192, 0.15);
            --transition: all 0.3s ease;
            --error: #E74C3C;
            --success: #2ECC71;
            --gradient-bg: linear-gradient(135deg, #F6EAF3 0%, #E4D6E9 50%, #CDC7E3 100%);
            --glass-bg: rgba(255, 255, 255, 0.4);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            --glass-border: 1px solid rgba(255, 255, 255, 0.18);
            --widget-bg: #fff;
            --widget-border: #ddd;
            --neon-glow: 0 0 10px #A88DC0, 0 0 20px #A88DC0, 0 0 30px #A88DC0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Inter", sans-serif;
            background: var(--gradient-bg);
            color: var(--text);
            line-height: 1.7;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(168, 141, 192, 0.1) 0%, rgba(168, 141, 192, 0) 70%);
            z-index: -1;
            animation: pulse-bg 10s infinite alternate;
        }

        @keyframes pulse-bg {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Улучшенная навигация с градиентом и тенью */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.2rem 5%;
            background: linear-gradient(to right, var(--primary-light), var(--primary-dark));
            backdrop-filter: blur(10px);
            box-shadow: var(--glass-shadow);
            border: var(--glass-border);
            z-index: 1000;
            transition: var(--transition);
            border-bottom-left-radius: 50px;
            border-bottom-right-radius: 50px;
        }

        @keyframes neon-nav {
            0% { box-shadow: var(--neon-glow); }
            100% { box-shadow: none; }
        }

        .navbar.scrolled {
            padding: 0.8rem 5%;
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .nav-logo {
            font-family: "Raleway", sans-serif;
            font-weight: 600;
            font-size: 1.8rem;
            color: #703f9b;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .nav-auth {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .nav-logout {
            display: none;
            align-items: center;
        }

        .nav-item {
            font-size: 1rem;
            color: #5e288da8;
            text-decoration: none;
            transition: var(--transition);
            position: relative;
        }

        .nav-item::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: #fff;
            transition: var(--transition);
        }

        .nav-item:hover::after {
            width: 100%;
        }

        .nav-item:hover {
            color: #fff;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-family: "Raleway", sans-serif;
            font-weight: 500;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            display: inline-block;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid transparent;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px var(--shadow);
        }

        .btn-login {
            background: var(--accent);
            color: var(--primary);
            border: 1px solid var(--primary-light);
        }

        .btn-login:hover {
            background: var(--primary-light);
            color: #FFFFFF;
        }

        .btn-register {
            background: var(--primary);
            color: #FFFFFF;
        }

        .btn-register:hover {
            background: var(--primary-dark);
        }

        .btn-info {
            background: var(--secondary);
            color: var(--text);
        }

        .btn-info:hover {
            background: var(--primary-light);
            color: #FFFFFF;
        }

        .menu-toggle {
            font-size: 1.7rem;
            cursor: pointer;
            color: #fff;
            z-index: 1001;
            transition: transform 0.3s ease;
        }

        .menu-toggle:hover {
            transform: rotate(90deg);
        }

        /* Мобильное меню */
        .mobile-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 350px;
            height: 100vh;
            background: var(--gradient-bg);
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding-top: 5rem;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.15);
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 999;
            border-left: 1px solid var(--secondary);
        }

        .mobile-menu.active {
            right: 0;
        }

        .mobile-menu .nav-item {
            font-size: 1.3rem;
            padding: 1.2rem 2.5rem;
            width: 100%;
            text-align: center;
            color: var(--primary);
            transition: var(--transition);
            opacity: 0;
            transform: translateY(20px);
        }

        .mobile-menu.active .nav-item {
            opacity: 1;
            transform: translateY(0);
        }

        .mobile-menu .nav-item:nth-child(1) { transition-delay: 0.05s; }
        .mobile-menu .nav-item:nth-child(2) { transition-delay: 0.1s; }
        .mobile-menu .nav-item:nth-child(3) { transition-delay: 0.15s; }
        .mobile-menu .nav-item:nth-child(4) { transition-delay: 0.2s; }
        .mobile-menu .nav-item:nth-child(5) { transition-delay: 0.25s; }

        .mobile-menu .nav-item:hover {
            background: var(--accent);
            transform: scale(1.05);
        }

        .mobile-menu .nav-auth {
            flex-direction: column;
            padding: 1.5rem 2.5rem;
            gap: 1.2rem;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
            transition-delay: 0.35s;
        }

        .mobile-menu.active .nav-auth {
            opacity: 1;
            transform: translateY(0);
        }

        .mobile-menu .nav-logout {
            display: none;
            flex-direction: column;
            padding: 1.5rem 2.5rem;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
            transition-delay: 0.35s;
        }

        .mobile-menu.active .nav-logout {
            opacity: 1;
            transform: translateY(0);
        }

        /* Overlay для мобильного меню */
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease;
            z-index: 998;
        }

        .menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Модальные окна */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 2.5rem;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--glass-shadow);
            border: var(--glass-border);
            transform: scale(0.9);
            opacity: 0;
            transition: var(--transition);
            position: relative;
        }

        .modal-overlay.active .modal {
            transform: scale(1);
            opacity: 1;
        }

        .modal-large {
            max-width: 100vw;
            max-height: 100vh;
            width: 100vw;
            height: 100vh;
            padding: 1rem;
            border-radius: 0;
        }

        .modal-wide {
            max-width: 800px;
        }

        .modal-close {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--primary);
            transform: rotate(90deg);
        }

        .modal-title {
            font-family: "Raleway", sans-serif;
            font-weight: 600;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--text);
            text-align: center;
            text-shadow: 0 2px 4px var(--shadow);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text);
        }

        .form-input {
            width: 100%;
            padding: 0.8rem 1.2rem;
            border: var(--glass-border);
            border-radius: 15px;
            font-family: "Inter", sans-serif;
            font-size: 1rem;
            transition: var(--transition);
            background: var(--glass-bg);
            backdrop-filter: blur(5px);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(168, 141, 192, 0.2);
        }

        .form-input.error {
            border-color: var(--error);
        }

        .form-error {
            color: var(--error);
            font-size: 0.85rem;
            margin-top: 0.3rem;
            display: none;
        }

        .form-error.show {
            display: block;
        }

        .role-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .role-option {
            flex: 1;
            text-align: center;
            padding: 1rem;
            border: var(--glass-border);
            border-radius: 15px;
            cursor: pointer;
            transition: var(--transition);
            background: var(--glass-bg);
            backdrop-filter: blur(5px);
        }

        .role-option:hover {
            border-color: var(--primary-light);
            transform: translateY(-5px);
        }

        .role-option.selected {
            border-color: var(--primary);
            background: var(--accent);
            box-shadow: var(--glass-shadow);
        }

        .role-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--primary);
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .form-footer {
            text-align: center;
            margin-top: 1.5rem;
        }

        .form-link {
            color: #8700ff;
            text-decoration: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .form-link:hover {
            text-decoration: underline;
        }

        /* Личный кабинет */
        .dashboard {
            display: none;
            padding: 6rem 5% 4rem;
            min-height: 100vh;
            background: var(--gradient-bg);
        }

        .dashboard-header {
            margin-bottom: 2.5rem;
            text-align: center;
        }

        .dashboard-title {
            font-family: "Raleway", sans-serif;
            font-weight: 600;
            font-size: 2.2rem;
            color: var(--text);
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px var(--shadow);
        }

        .dashboard-subtitle {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .dashboard-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 1rem;
            justify-content: center;
        }

        .tab-btn {
            padding: 0.8rem 1.5rem;
            background: var(--glass-bg);
            border: var(--glass-border);
            border-radius: 15px;
            font-family: "Raleway", sans-serif;
            font-weight: 500;
            font-size: 1rem;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(5px);
        }

        .tab-btn.active {
            background: var(--primary);
            color: #FFFFFF;
            box-shadow: var(--glass-shadow);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* Поиск специалистов */
        .search-filters {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--glass-shadow);
            border: var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .specialists-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .specialist-card {
            background: var(--glass-bg);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--glass-shadow);
            transition: var(--transition);
            border: var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .specialist-card:hover {
            transform: translateY(-10px) rotate(1deg);
            box-shadow: 0 15px 35px var(--shadow);
        }

        .specialist-header {
            padding: 1.5rem;
            background: var(--gradient-bg);
            text-align: center;
        }

        .specialist-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 1rem;
            border: 4px solid var(--card);
            box-shadow: 0 4px 10px var(--shadow);
        }

        .specialist-name {
            font-family: "Raleway", sans-serif;
            font-weight: 600;
            font-size: 1.3rem;
            margin-bottom: 0.3rem;
            color: #FFFFFF;
        }

        .specialist-specialty {
            color: #FFFFFF;
            font-weight: 500;
        }

        .specialist-body {
            padding: 1.5rem;
        }

        .specialist-info {
            margin-bottom: 1rem;
        }

        .specialist-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .rating-stars {
            color: #FFD700;
        }

        .specialist-price {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .specialist-footer {
            padding: 0 1.5rem 1.5rem;
        }

        /* Календарь */
        .calendar-container {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--glass-shadow);
            overflow: hidden;
            position: relative;
            border: var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .calendar-header h3 {
            font-family: "Raleway", sans-serif;
            font-size: 1.8rem;
            color: var(--primary-dark);
            animation: fadeInUp 0.5s ease;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.8rem;
            margin-top: 1rem;
        }

        .calendar-day {
            text-align: center;
            padding: 1rem;
            border-radius: 10px;
            cursor: pointer;
            background: var(--glass-bg);
            border: var(--glass-border);
            font-weight: 500;
            transition: var(--transition);
            backdrop-filter: blur(5px);
        }

        .calendar-day:hover {
            transform: scale(1.1);
            background: var(--primary-light);
            color: #FFFFFF;
        }

        .calendar-day.selected {
            background: var(--primary);
            color: #FFFFFF;
            box-shadow: 0 4px 15px rgba(168, 141, 192, 0.3);
            animation: pulse 1s infinite;
        }

        .calendar-day.disabled {
            color: #CCC;
            cursor: not-allowed;
        }

        .calendar-day.has-bookings {
            background: var(--accent);
            color: var(--primary-dark);
        }

        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .time-slot {
            padding: 0.5rem;
            text-align: center;
            border: var(--glass-border);
            border-radius: 10px;
            cursor: pointer;
            background: var(--glass-bg);
            transition: var(--transition);
            animation: fadeInUp 0.5s ease;
            backdrop-filter: blur(5px);
        }

        .time-slot:hover {
            transform: translateY(-5px);
            box-shadow: var(--glass-shadow);
        }

        .time-slot.selected {
            background: var(--primary);
            color: #FFFFFF;
            border-color: var(--primary);
        }

        .time-slot.booked {
            background: linear-gradient(135deg, #FFCCCC 0%, #FFB3B3 100%);
            color: var(--error);
            cursor: not-allowed;
            position: relative;
        }

        .time-slot.booked::after {
            content: attr(data-client);
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card);
            padding: 0.5rem 1rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px var(--shadow);
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
        }

        .time-slot.booked:hover::after {
            opacity: 1;
            visibility: visible;
        }

        .time-slot.available {
            border-color: var(--success);
        }

        /* Список клиентов */
        .clients-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .client-card {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: var(--glass-shadow);
            transition: var(--transition);
            cursor: pointer;
            border: var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .client-card:hover {
            transform: translateY(-5px) rotate(1deg);
            box-shadow: 0 15px 35px var(--shadow);
        }

        .plan-card {
            background: var(--accent);
            border-left: 4px solid var(--primary);
        }

        .client-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .client-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 2px 5px var(--shadow);
        }

        .client-name {
            font-family: "Raleway", sans-serif;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .client-next-session {
            color: var(--primary);
            font-weight: 500;
        }

        .client-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .client-actions .btn {
            flex: 1;
            min-width: 100px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }

        /* Детальный вид клиента в модале */
        .client-detail-modal .modal {
            max-width: 700px;
        }

        .client-detail {
            display: none;
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--glass-shadow);
            border: var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .client-detail.active {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        .client-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .client-problem {
            background: var(--accent);
            padding: 1rem;
            border-radius: 10px;
            font-weight: 500;
        }

        /* Дневник клиента */
        .client-journal {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: var(--glass-shadow);
            margin-bottom: 2rem;
            border: var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .journal-entry {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--secondary);
        }

        .journal-date {
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 0.5rem;
        }

        .journal-content {
            color: var(--text-light);
            background: var(--accent);
            padding: 1rem;
            border-radius: 10px;
            box-shadow: inset 0 2px 5px var(--shadow);
        }

        .journal-form textarea {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            border: var(--glass-border);
            border-radius: 15px;
            font-family: "Inter", sans-serif;
            resize: vertical;
            transition: var(--transition);
            background: var(--glass-bg);
            backdrop-filter: blur(5px);
        }

        .journal-form textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Уведомления */
        .notification-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 3000;
        }

        .notification {
            background: var(--glass-bg);
            border-radius: 15px;
            padding: 1rem 1.5rem;
            margin-bottom: 0.5rem;
            box-shadow: var(--glass-shadow);
            border: var(--glass-border);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification.hide {
            transform: translateX(100%);
            opacity: 0;
        }

        .notification.success {
            border-left: 4px solid var(--success);
        }

        .notification.error {
            border-left: 4px solid var(--error);
        }

        .notification.info {
            border-left: 4px solid var(--primary);
        }

        .notification.new-appointment {
            border-left: 4px solid #F39C12;
            background: #FEF9E7;
        }

        .notification-icon {
            font-size: 1.2rem;
        }

        .notification.success .notification-icon {
            color: var(--success);
        }

        .notification.error .notification-icon {
            color: var(--error);
        }

        .notification.info .notification-icon {
            color: var(--primary);
        }

        .notification.new-appointment .notification-icon {
            color: #F39C12;
        }

        /* Индикатор загрузки */
        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 4000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .loader-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid var(--accent);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Герой секция с большой фото справа и дополнительным текстом */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
            padding: 6rem 5% 4rem;
            background: var(--gradient-bg);
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODAwcHgiIGhlaWdodD0iODAwcHgiIHZpZXdCb3g9IjAgMCA4MDAgODAwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPHRpdGxlPkFydGJvYXJkIDFjb3B5PC90aXRsZT4KICAgIDxnIGlkPSJBcnRib2FyZCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IkFydGJvYXJkLTFjb3B5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTQuMDAwMDAwLCAtNTQuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NC4wMDAwMDAsIDU0LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjgwMCIgaGVpZ2h0PSI4MDAiIHJ4PSIxMDAiIHN0eWxlPSJmaWxsOiAjZjBmMGUwOyI+PC9yZWN0PgogICAgICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMDAuMDAwMDAwLCAxMDAuMDAwMDAwKSIgb3BhY2l0eT0iMC42Ij4KICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iR3JvdXAtMiI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGlkPSJSZWN0YW5nbGUtMmNvcHktMyIgZD0iTTAgMCBMMTAwIDAgTDEwMCAxMDAgTDAgMTAwIEwwIDAgWiIgc3R5bGU9ImZpbGw6ICNmZmZmZmY7Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGlkPSJSZWN0YW5nbGUtMmNvcHktMyIgZD0iTTAwIDAgTLEgMCAgTLEgMTAwIEwwIDEwMCBMMCAwIFoiIHN0eWxlPSJmaWxsOiAjZmZmZmZmOyI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+');
            background-size: cover;
            background-position: center;
            z-index: 0;
            opacity: 0.3;
            filter: blur(5px);
        }

        .hero-content {
            max-width: 50%;
            position: relative;
            z-index: 1;
            text-align: left;
            animation: slideInLeft 1s ease;
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .hero-image {
            max-width: 190%;
            height: auto;
            border-radius: 50px;
            margin-right: 0%;
            object-fit: cover;
            position: relative;
            overflow: hidden;
        }

        .hero-image::after {
            content: "Профессиональная поддержка и рост\\AВаше пространство для развития";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 1.5rem;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            white-space: pre-wrap;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            animation: fadeInText 2s ease-in-out;
        }

        @keyframes fadeInText {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes neon-glow {
            0% { box-shadow: var(--neon-glow); }
            100% { box-shadow: none; }
        }

        .hero-title {
            font-family: "Raleway", sans-serif;
            font-weight: 700;
            font-size: 3.5rem;
            line-height: 1.2;
            margin-bottom: 1rem;
            color: #460c79bd;
            text-shadow: 0 4px 8px var(--shadow);
            animation: fadeInUp 1s ease;
        }

        .hero-description {
            font-size: 1rem;
            margin-bottom: 2rem;
            color: #a88dc0;
            animation: fadeInUp 1s ease 0.5s forwards;
            opacity: 0;
        }

        .stats {
            display: flex;
            justify-content: flex-start;
            gap: 2rem;
            margin-bottom: 4rem;
            animation: fadeInUp 1s ease 1s forwards;
            opacity: 0;
        }

        .stat-item {
            background: var(--glass-bg);
            padding: 1rem 2rem;
            border-radius: 15px;
            text-align: center;
            color: #6f4096;
            box-shadow: var(--glass-shadow);
            border: var(--glass-border);
            backdrop-filter: blur(10px);
            transition: var(--transition);
        }

        .stat-item:hover {
            transform: scale(1.1);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
        }

        .stat-label {
            font-size: 1rem;
        }

        /* Особенности */
        .features {
            padding: 5rem 5%;
            background: var(--background);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .feature-card {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 2.5rem 2rem;
            text-align: center;
            box-shadow: var(--glass-shadow);
            transition: var(--transition);
            opacity: 0;
            transform: translateY(30px);
            border: var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .feature-card.animate {
            animation: fadeInUp 0.8s ease forwards;
        }

        .feature-card:nth-child(2) {
            animation-delay: 0.2s;
        }

        .feature-card:nth-child(3) {
            animation-delay: 0.4s;
        }

        .feature-card:hover {
            transform: translateY(-10px) rotate(2deg);
            box-shadow: 0 15px 35px var(--shadow);
        }

        .feature-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            animation: bounce 1s infinite;
        }

        .feature-title {
            font-family: "Raleway", sans-serif;
            font-weight: 600;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .feature-description {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        /* Секция помощи */
        .help {
            padding: 5rem 5%;
            background: var(--gradient-bg);
            position: relative;
        }

        .help::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%23E4D6E9' fill-opacity='0.1' d='M0,128L48,117.3C96,107,192,85,288,112C384,139,480,213,576,218.7C672,224,768,160,864,138.7C960,117,1056,139,1152,149.3C1248,160,1344,160,1392,160L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E");
            background-size: cover;
            background-position: center;
            z-index: 0;
            opacity: 0.5;
        }

        .section-title {
            font-family: "Raleway", sans-serif;
            font-weight: 700;
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 3.5rem;
            position: relative;
            z-index: 1;
            color: #FFFFFF;
            text-shadow: 0 4px 8px var(--shadow);
        }

        .section-title::after {
            content: "";
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: #FFFFFF;
            border-radius: 2px;
        }

        .help-cards {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .help-card {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: var(--glass-shadow);
            transition: var(--transition);
            opacity: 0;
            transform: translateY(30px);
            color: #FFFFFF;
            border: var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .help-card.animate {
            animation: fadeInUp 0.8s ease forwards;
        }

        .help-card:nth-child(1) {
            animation-delay: 0.1s;
        }

        .help-card:nth-child(2) {
            animation-delay: 0.2s;
        }

        .help-card:nth-child(3) {
            animation-delay: 0.3s;
        }

        .help-card:nth-child(4) {
            animation-delay: 0.4s;
        }

        .help-card:hover {
            transform: translateY(-5px) rotate(1deg);
            box-shadow: 0 15px 35px var(--shadow);
        }

        .help-title {
            font-family: "Raleway", sans-serif;
            font-weight: 600;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: #703f9b;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .help-title i {
            color: #794ba1;
            font-size: 1.8rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .help-list {
            list-style: none;
        }

        .help-list li {
            margin-bottom: 0.8rem;
            padding-left: 2rem;
            position: relative;
            font-size: 1.1rem;
            color: #a88dc0;
        }

        .help-list li::before {
            content: "•";
            color: #703f9b;
            font-size: 1.5rem;
            position: absolute;
            left: 0;
            top: -0.4rem;
        }

        /* Улучшенный футер с дополнительной информацией */
        .footer {
            background: var(--gradient-bg);
            color: #FFFFFF;
            padding: 4rem 5% 2rem;
            text-align: center;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            text-align: left;
        }

        .footer-logo {
            font-family: "Raleway", sans-serif;
            font-weight: 700;
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: #703f9b;
        }

        .footer-description {
            margin-bottom: 1.5rem;
            opacity: 0.8;
            color: #703f9b;
        }

        .footer-heading {
            font-family: "Raleway", sans-serif;
            font-weight: 600;
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            color: #703f9bb5;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            color: #703f9bc8;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-links a {
            color: #703f9bc1;
            text-decoration: none;
            opacity: 0.8;
            transition: var(--transition);
        }

        .footer-links a:hover {
            opacity: 1;
            color: #FFFFFF;
            transform: translateX(5px);
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            justify-content: center;
        }

        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            color: #703f9b;;
            transition: var(--transition);
        }

        .social-links a:hover {
            background: #FFFFFF;
            color: var(--primary);
            transform: rotate(360deg);
        }

        .copyright {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            opacity: 0.7;
            color: #703f9b;
        }

        /* Дополнительная информация в футере */
        .footer-info-additional {
            margin-top: 2rem;
            font-size: 0.9rem;
            opacity: 0.8;
            color: #703f9b;
        }

        .footer-info-additional p {
            margin-bottom: 1rem;
        }

        /* Анимации */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scaleX(0);
            }

            to {
                opacity: 1;
                transform: scaleX(1);
            }
        }

        /* Адаптивность - улучшенная для мобильных устройств */
        @media (max-width: 1200px) {
            .features-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }

            .help-cards {
                gap: 1.5rem;
            }

            .calendar-grid {
                gap: 0.6rem;
            }

            .time-slots {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
        }

        @media (max-width: 992px) {
            .nav-auth {
                display: none;
            }

            .nav-logout {
                display: none;
            }

            .mobile-menu .nav-auth {
                display: flex;
            }

            .mobile-menu .nav-logout {
                display: flex;
            }

            .role-selector {
                flex-direction: column;
            }

            .features-grid,
            .help-cards {
                grid-template-columns: 1fr;
            }

            .specialists-grid,
            .clients-list {
                grid-template-columns: 1fr;
            }

            .filter-row {
                grid-template-columns: 1fr;
            }

            .calendar-container {
                padding: 1.5rem;
            }

            .calendar-header h3 {
                font-size: 1.5rem;
            }

            .calendar-day {
                padding: 0.8rem;
                font-size: 0.9rem;
            }

            .time-slot {
                padding: 0.8rem;
                font-size: 0.9rem;
            }

            .hero-content {
                max-width: 800px;
            }

            .hero-title {
                font-size: 2.5rem;
            }

            .hero-description {
                font-size: 1.1rem;
            }

            .modal-wide {
                max-width: 90%;
            }
        }

        @media (max-width: 768px) {
            body {
                background: linear-gradient(135deg, #CDC7E3 0%, #E4D6E9 50%, #F6EAF3 100%);
            }

            .hero {
                flex-direction: column;
                align-items: center;
                padding: 3rem 1rem;
                min-height: auto;
                background: radial-gradient(circle, rgba(168, 141, 192, 0.2) 0%, rgba(168, 141, 192, 0) 70%);
            }

            .hero::before {
                opacity: 0.5;
                filter: blur(3px);
            }

            .hero-content {
                max-width: 100%;
                text-align: center;
                order: 2;
                margin-top: 1rem;
                animation: fadeInUp 1s ease;
            }

            .hero-image {
                max-width: 140%;
                margin: 0 auto;
                order: 1;
                border-radius: 30px;
                animation: float 2s ease-in-out infinite;
            }

            @keyframes float {
                0% { transform: translateY(0px); }
                50% { transform: translateY(-10px); }
                100% { transform: translateY(0px); }
            }

            .hero-image::after {
                font-size: 1rem;
                padding: 0.5rem;
                background: rgba(0, 0, 0, 0.4);
                border-radius: 15px;
                animation: pulse 1.5s infinite;
            }

            .hero-title {
                font-size: 1.8rem;
                line-height: 1.4;
                color: #460c79;
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
                animation: fadeInUp 1s ease;
            }

            .hero-description {
                font-size: 1rem;
                margin-bottom: 1rem;
                color: #a88dc0;
                animation: fadeInUp 1s ease 0.3s forwards;
            }

            .stats {
                flex-direction: column;
                gap: 1rem;
                justify-content: center;
                animation: fadeInUp 1s ease 0.6s forwards;
            }

            .stat-item {
                padding: 0.8rem 1.5rem;
                font-size: 0.9rem;
                border-radius: 20px;
                background: linear-gradient(135deg, var(--glass-bg), var(--accent));
                box-shadow: 0 4px 12px rgba(168, 141, 192, 0.2);
                animation: bounce 1.5s infinite;
            }

            .stat-number {
                font-size: 1.5rem;
            }

            .features {
                padding: 3rem 1rem;
            }

            .feature-card {
                padding: 1.5rem;
                border-radius: 25px;
                box-shadow: 0 6px 18px rgba(168, 141, 192, 0.2);
                animation: fadeInUp 0.8s ease forwards;
            }

            .feature-icon {
                font-size: 2.5rem;
                animation: bounce 1.5s infinite;
            }

            .feature-title {
                font-size: 1.3rem;
            }

            .feature-description {
                font-size: 1rem;
            }

            .help {
                padding: 3rem 1rem;
            }

            .section-title {
                font-size: 1.8rem;
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            }

            .help-card {
                padding: 1.5rem;
                border-radius: 25px;
                box-shadow: 0 6px 18px rgba(168, 141, 192, 0.2);
                animation: fadeInUp 0.8s ease forwards;
            }

            .help-title {
                font-size: 1.3rem;
            }

            .help-list li {
                font-size: 1rem;
            }

            .footer {
                padding: 2rem 1rem;
            }

            .footer-content {
                gap: 1rem;
                grid-template-columns: 1fr;
                text-align: center;
            }

            .social-links {
                justify-content: center;
            }

            .navbar {
                padding: 0.8rem 3%;
                background: linear-gradient(to bottom, var(--primary-light), var(--primary-dark));
                border-bottom-left-radius: 30px;
                border-bottom-right-radius: 30px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            }

            .nav-logo {
                font-size: 1.5rem;
                color: rgb(86, 53, 116);
            }

            .menu-toggle {
                font-size: 1.5rem;
            }

            .dashboard-tabs {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .tab-btn {
                flex: 1 1 45%;
                font-size: 0.9rem;
                padding: 0.6rem 1rem;
                border-radius: 20px;
            }

            .calendar-grid {
                gap: 0.4rem;
            }

            .calendar-day {
                padding: 0.6rem;
                font-size: 0.8rem;
                border-radius: 8px;
            }

            .time-slots {
                grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
                gap: 0.8rem;
            }

            .time-slot {
                padding: 0.6rem;
                font-size: 0.8rem;
                border-radius: 8px;
            }

            .specialist-card {
                margin-bottom: 1rem;
                border-radius: 25px;
            }

            .client-card {
                padding: 1rem;
                border-radius: 25px;
            }

            .client-header {
                flex-direction: column;
                text-align: center;
            }

            .client-avatar {
                margin-bottom: 1rem;
            }

            .client-actions {
                flex-direction: column;
                gap: 0.5rem;
            }

            .client-actions .btn {
                width: 100%;
            }

            .notification-container {
                top: 80px;
                right: 10px;
                left: 10px;
                width: calc(100% - 20px);
            }

            .notification {
                padding: 0.8rem 1rem;
                font-size: 0.9rem;
                border-radius: 20px;
            }

            .modal {
                width: 95%;
                padding: 1.5rem;
                border-radius: 20px;
            }

            .modal-title {
                font-size: 1.5rem;
            }

            .form-group {
                margin-bottom: 1rem;
            }

            .form-input {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
                border-radius: 15px;
            }

            .calendar-header h3 {
                font-size: 1.2rem;
            }

            .calendar-day {
                padding: 0.4rem;
                font-size: 0.7rem;
            }

            .time-slots {
                grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
                gap: 0.5rem;
            }

            .time-slot {
                padding: 0.4rem;
                font-size: 0.7rem;
            }

            .specialist-avatar {
                width: 80px;
                height: 80px;
            }

            .specialist-name {
                font-size: 1.1rem;
            }

            .specialist-footer .btn {
                padding: 0.8rem;
                font-size: 0.9rem;
                border-radius: 30px;
            }

            .client-avatar {
                width: 50px;
                height: 50px;
            }

            .client-name {
                font-size: 1rem;
            }

            .notification {
                flex-direction: column;
                text-align: center;
                padding: 1rem;
            }

            .notification-icon {
                margin-bottom: 0.5rem;
            }

            .dashboard {
                padding: 4rem 3% 3rem;
            }

            .dashboard-title {
                font-size: 1.8rem;
            }

            .dashboard-subtitle {
                font-size: 1rem;
            }

            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
                border-radius: 25px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }

            .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            }

            .nav-right {
                gap: 1rem;
            }

            .nav-item {
                font-size: 0.9rem;
            }

            .nav-logo {
                font-size: 1.3rem;
            }

            .mobile-menu .nav-item {
                font-size: 1.1rem;
                padding: 1rem 2rem;
                border-radius: 15px;
                margin: 0.5rem;
                background: linear-gradient(135deg, var(--accent), var(--secondary));
            }

            .mobile-menu .nav-item:hover {
                background: linear-gradient(135deg, var(--primary-light), var(--primary-dark));
            }

            .mobile-menu .nav-auth .btn {
                width: 80%;
                margin: 0 auto;
                border-radius: 30px;
            }

            .section-title {
                font-size: 1.6rem;
            }

            .form-label {
                font-size: 0.9rem;
            }

            .role-selector {
                flex-direction: column;
            }

            .role-option {
                border-radius: 20px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }

            .role-icon {
                animation: bounce 1.5s infinite;
            }

            .hero::before {
                background-size: contain;
            }
        }

        @media (max-width: 576px) {
            .navbar {
                padding: 0.8rem 3%;
                border-bottom-left-radius: 30px;
                border-bottom-right-radius: 30px;
            }

            .nav-logo {
                font-size: 1.3rem;
            }

            .menu-toggle {
                font-size: 1.4rem;
            }

            .hero {
                padding: 2rem 1rem;
            }

            .hero-title {
                font-size: 1.6rem;
            }

            .hero-description {
                font-size: 1rem;
            }

            .hero-image::after {
                font-size: 0.9rem;
            }

            .stats {
                gap: 0.5rem;
            }

            .stat-item {
                padding: 0.6rem 1rem;
            }

            .stat-number {
                font-size: 1.2rem;
            }

            .stat-label {
                font-size: 0.8rem;
            }

            .features-grid {
                gap: 1rem;
            }

            .feature-card {
                padding: 1.2rem;
            }

            .feature-icon {
                font-size: 2rem;
            }

            .feature-title {
                font-size: 1.2rem;
            }

            .feature-description {
                font-size: 0.9rem;
            }

            .help-cards {
                gap: 1rem;
            }

            .help-card {
                padding: 1.2rem;
            }

            .help-title {
                font-size: 1.2rem;
            }

            .help-list li {
                font-size: 0.9rem;
            }

            .footer {
                padding: 2rem 1rem;
            }

            .footer-content {
                grid-template-columns: 1fr;
            }

            .footer-description {
                font-size: 0.9rem;
            }

            .footer-info-additional p {
                font-size: 0.8rem;
            }

            .dashboard-tabs {
                flex-direction: column;
                gap: 0.5rem;
            }

            .tab-btn {
                flex: 1;
                min-width: auto;
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }

            .modal {
                width: 100%;
                height: 100vh;
                border-radius: 0;
                padding: 1rem;
            }

            .modal-title {
                font-size: 1.4rem;
            }

            .btn {
                padding: 0.8rem 1rem;
                font-size: 0.9rem;
                border-radius: 30px;
            }

            .search-filters {
                padding: 1rem;
                border-radius: 15px;
            }

            .filter-row {
                gap: 0.5rem;
            }

            .specialist-card {
                border-radius: 25px;
                padding: 1rem;
            }

            .specialist-avatar {
                width: 80px;
                height: 80px;
            }

            .specialist-name {
                font-size: 1.1rem;
            }

            .specialist-specialty {
                font-size: 0.9rem;
            }

            .dashboard {
                padding: 3rem 1rem;
            }

            .dashboard-title {
                font-size: 1.6rem;
            }

            .dashboard-subtitle {
                font-size: 0.9rem;
            }

            .calendar-container {
                padding: 1rem;
                border-radius: 15px;
            }

            .calendar-header h3 {
                font-size: 1.2rem;
            }

            .calendar-day {
                padding: 0.5rem;
                font-size: 0.8rem;
                border-radius: 10px;
            }

            .time-slots {
                gap: 0.5rem;
            }

            .time-slot {
                padding: 0.5rem;
                font-size: 0.8rem;
                border-radius: 10px;
            }

            .notification {
                padding: 0.8rem;
                font-size: 0.8rem;
                border-radius: 15px;
            }

            .client-card {
                padding: 1rem;
                border-radius: 20px;
            }

            .client-name {
                font-size: 1.1rem;
            }

            .client-actions .btn {
                padding: 0.5rem;
                font-size: 0.8rem;
            }

            .hero-image {
                border-radius: 20px;
            }

            .hero-image::after {
                font-size: 0.8rem;
                padding: 0.5rem;
            }

            .stats {
                gap: 0.5rem;
            }

            .stat-item {
                padding: 0.6rem 1rem;
                border-radius: 15px;
            }

            .stat-number {
                font-size: 1.4rem;
            }

            .stat-label {
                font-size: 0.8rem;
            }

            .feature-card {
                border-radius: 20px;
                padding: 1.5rem;
            }

            .feature-icon {
                font-size: 2.5rem;
            }

            .feature-title {
                font-size: 1.3rem;
            }

            .feature-description {
                font-size: 1rem;
            }

            .help-card {
                border-radius: 20px;
                padding: 1.5rem;
            }

            .help-title {
                font-size: 1.3rem;
            }

            .help-list li {
                font-size: 1rem;
            }

            .footer-logo {
                font-size: 1.5rem;
            }

            .footer-heading {
                font-size: 1.2rem;
            }

            .footer-links li {
                font-size: 1rem;
            }

            .social-links a {
                width: 35px;
                height: 35px;
            }

            .copyright {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 400px) {
            .nav-logo {
                font-size: 1.2rem;
            }

            .menu-toggle {
                font-size: 1.4rem;
            }

            .mobile-menu .nav-item {
                font-size: 1.1rem;
                padding: 1rem 2rem;
            }

            .hero-title {
                font-size: 1.5rem;
            }

            .hero-description {
                font-size: 1rem;
            }

            .section-title {
                font-size: 1.8rem;
            }

            .feature-icon {
                font-size: 2.5rem;
            }

            .feature-title {
                font-size: 1.3rem;
            }

            .feature-description {
                font-size: 1rem;
            }

            .help-title {
                font-size: 1.3rem;
            }

            .help-list li {
                font-size: 1rem;
            }

            .footer-logo {
                font-size: 1.5rem;
            }

            .footer-heading {
                font-size: 1.1rem;
            }

            .footer-links a {
                font-size: 0.9rem;
            }

            .copyright {
                font-size: 0.8rem;
            }
        }

        /* Стили для оценки занятия */
        .rate-session-modal .modal {
            max-width: 600px;
        }

        .emotions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .emotion-btn {
            padding: 0.5rem;
            border: var(--glass-border);
            background: var(--glass-bg);
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(5px);
        }

        .emotion-btn.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: #FFFFFF;
        }

        /* Стили для опроса */
        .survey-modal .modal {
            max-width: 600px;
        }

        .survey-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .survey-option {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: var(--glass-border);
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            background: var(--glass-bg);
            backdrop-filter: blur(5px);
        }

        .survey-option:hover,
        .survey-option.selected {
            border-color: var(--primary);
            background: var(--accent);
            box-shadow: var(--glass-shadow);
        }

        /* Стили для профильных медиа */
        .media-preview {
            max-width: 200px;
            max-height: 200px;
            border-radius: 10px;
            margin-top: 0.5rem;
        }

        .video-preview {
            width: 100%;
            max-width: 300px;
            height: auto;
        }

        /* Стили для заметок специалиста */
        .notes-modal .modal {
            max-width: 700px;
            padding: 3rem;
        }

        .notes-list {
            margin-bottom: 2rem;
        }

        .note-entry {
            background: var(--accent);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 15px var(--shadow);
            animation: fadeInUp 0.5s ease;
            position: relative;
        }

        .note-date {
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 0.5rem;
        }

        .note-content {
            margin-bottom: 1rem;
        }

        .note-actions {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            display: flex;
            gap: 0.5rem;
        }

        .note-edit-btn,
        .note-delete-btn {
            font-size: 0.8rem;
            padding: 0.3rem 0.6rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .note-edit-btn {
            background: var(--primary);
            color: #FFFFFF;
        }

        .note-delete-btn {
            background: var(--error);
            color: #FFFFFF;
        }

        .note-emotions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .emotion-tag {
            background: var(--primary-light);
            color: #FFFFFF;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            animation: scaleIn 0.3s ease;
        }

        .notes-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .notes-form textarea {
            min-height: 200px;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: inset 0 2px 10px var(--shadow);
            background: var(--glass-bg);
            backdrop-filter: blur(5px);
        }

        .problem-selector,
        .request-selector {
            margin-bottom: 1rem;
        }

        .problem-option,
        .request-option {
            display: block;
            padding: 0.5rem;
            margin: 0.25rem 0;
            border: var(--glass-border);
            border-radius: 5px;
            cursor: pointer;
            background: var(--glass-bg);
            backdrop-filter: blur(5px);
        }

        .problem-option.selected,
        .request-option.selected {
            background: var(--primary);
            color: #FFFFFF;
        }

        /* Нет результатов */
        .no-results {
            text-align: center;
            color: var(--text-light);
            font-style: italic;
        }

        .booking-detail {
            margin-bottom: 0.5rem;
        }

        .booking-summary {
            background: var(--accent);
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            box-shadow: var(--glass-shadow);
        }

        /* Emotion options in notes */
        .emotions-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .emotion-option {
            padding: 0.5rem 1rem;
            border: var(--glass-border);
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            background: var(--glass-bg);
            backdrop-filter: blur(5px);
        }

        .emotion-option.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: #FFFFFF;
        }

        /* Client actions buttons */
        .client-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .client-actions .btn {
            flex: 1;
            min-width: 100px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }

        /* Appointments container */
        #appointmentsContainer .help-card {
            margin-bottom: 4rem;
        }

        #allAppointmentsContainer .client-card {
            margin-bottom: 4rem;
        }

        /* Полный профиль клиента в модале */
        .client-full-profile {
            text-align: left;
        }

        .client-full-profile .client-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .client-full-profile .profile-section {
            background: var(--accent);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            box-shadow: var(--glass-shadow);
        }

        .client-full-profile .profile-section h4 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-family: "Raleway", sans-serif;
            font-weight: 600;
        }

        .client-full-profile .notes-section {
            max-height: 300px;
            overflow-y: auto;
        }

        /* Полный профиль специалиста в модале клиента */
        .specialist-detail-modal .modal {
            max-width: 800px;
        }

        .specialist-full-profile .profile-section {
            background: var(--accent);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            box-shadow: var(--glass-shadow);
        }

        .specialist-full-profile .profile-section h4 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-family: "Raleway", sans-serif;
            font-weight: 600;
        }

        .specialist-full-profile .video-section {
            text-align: center;
            margin: 1rem 0;
        }

        .specialist-full-profile .video-preview {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
        }

        /* Widget styles for profiles */
        .profile-section {
            background: var(--glass-bg);
            padding: 1.5rem;
            border-radius: 20px;
            margin-bottom: 1rem;
            border: var(--glass-border);
            box-shadow: var(--glass-shadow);
            backdrop-filter: blur(10px);
        }

        /* Pending appointment card style */
        .pending-appointment-card {
            background: #FEF9E7;
            border-left: 4px solid #F39C12;
        }

        /* Добавить промежуток между записями */
        #allAppointmentsContainer .client-card,
        #appointmentsContainer .help-card {
            margin-bottom: 4rem;
        }

        /* Стили для отзывов */
        .review-section {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--glass-bg);
            border-radius: 15px;
            box-shadow: var(--glass-shadow);
            border: var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .review-entry {
            margin-bottom: 1rem;
            padding: 0.5rem;
            border-bottom: 1px solid var(--secondary);
        }

        .review-rating {
            color: #FFD700;
        }

        .review-form {
            margin-top: 1rem;
        }

        .star-rating {
            display: flex;
            flex-direction: row-reverse;
            justify-content: flex-end;
        }

        .star-rating input {
            display: none;
        }

        .star-rating label {
            color: #CCC;
            cursor: pointer;
            font-size: 1.5rem;
            transition: var(--transition);
        }

        .star-rating input:checked ~ label,
        .star-rating label:hover,
        .star-rating label:hover ~ label {
            color: #FFD700;
        }

        /* Улучшения для мобильных устройств */
        @media (max-width: 768px) {
            body {
                background: linear-gradient(135deg, #CDC7E3 0%, #E4D6E9 50%, #F6EAF3 100%);
            }

            .hero::before {
                opacity: 0.5;
                filter: blur(3px);
            }

            .navbar {
                background: linear-gradient(to bottom, var(--primary-light), var(--primary-dark));
                border-bottom-left-radius: 30px;
                border-bottom-right-radius: 30px;
            }

            .nav-logo {
                color: rgb(86, 53, 116);
            }

            .feature-card, .help-card {
                border-radius: 25px;
                box-shadow: 0 6px 18px rgba(168, 141, 192, 0.2);
            }

            .feature-icon, .help-title i {
                animation: bounce 1.5s infinite;
            }

            .btn-register {
                background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            }

            .btn-login {
                background: linear-gradient(135deg, var(--accent), var(--secondary));
            }

            .modal {
                border-radius: 20px;
                padding: 1.5rem;
            }

            .calendar-container {
                border-radius: 15px;
                padding: 1rem;
            }

            .calendar-day {
                border-radius: 8px;
                padding: 0.6rem;
            }

            .time-slot {
                border-radius: 8px;
                padding: 0.6rem;
            }

            /* Для мобильных: только название и бургер меню */
            .nav-right .nav-item {
                display: none;
            }

            .nav-right .nav-auth {
                display: none;
            }

            .nav-right .nav-logout {
                display: none;
            }

            .nav-right {
                justify-content: flex-end;
            }
        }
    </style>
</head>

<body>
    <!-- Навигация -->
    <nav class="navbar">
        <div class="nav-left">
            <div class="nav-logo"><i class="fas fa-cube"></i> Центр супервизоров</div>
        </div>

        <div class="nav-right">
            <a class="nav-item">Главная</a>
            <a class="nav-item">О нас</a>
            <a class="nav-item">Услуги</a>
            <a class="nav-item">Блог</a>
            <a class="nav-item">Контакты</a>
            <div class="nav-auth">
                <a class="btn btn-login" id="loginBtn">Вход</a>
                <a class="btn btn-register" id="registerBtn">Регистрация</a>
            </div>

            <div class="nav-logout">
                <a class="btn btn-login" id="navLogoutBtn">Выйти</a>
            </div>
            <div class="menu-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </div>

        <div class="mobile-menu">
            <a class="nav-item" href="#services">Услуги</a>
            <a class="nav-item" href="#reviews">Отзывы</a>
            <a class="nav-item" href="#about">О нас</a>
            <a class="nav-item" href="#blog">Блог</a>
            <a class="nav-item" href="#contacts">Контакты</a>
            <div class="nav-auth">
                <a class="btn btn-login" id="mobileLoginBtn">Вход</a>
                <a class="btn btn-register" id="mobileRegisterBtn">Регистрация</a>
            </div>
            <div class="nav-logout" style="display: none;">
                <a class="btn btn-login" id="mobileLogoutBtn">Выйти</a>
            </div>
        </div>

        <div class="menu-overlay"></div>
    </nav>

    <!-- Герой секция с большой фото справа и дополнительным текстом -->
    <section class="hero" id="main-content">
        <div class="hero-content">
            <h1 class="hero-title">
                Центр супервизоров: "Путь к профессиональному росту начинается здесь"
            </h1>
            <p class="hero-description">
                Мы создаем пространство, где каждый специалист может безопасно и уверенно обратиться за супервизией, зная, что его примут, поймут и профессионально поддержат в развитии.
            </p>
            <p class="hero-description">
                Присоединяйтесь к сообществу профессионалов! Наша платформа предлагает индивидуальные сессии, групповые супервизии и ресурсы для непрерывного обучения. Откройте новые горизонты в своей карьере.
            </p>
           
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number">140+</div>
                    <div class="stat-label">Специалистов</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">7+</div>
                    <div class="stat-label">Лет опыта</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">15+</div>
                    <div class="stat-label">Публикаций</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">500+</div>
                    <div class="stat-label">Успешных сессий</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">98%</div>
                    <div class="stat-label">Довольных клиентов</div>
                </div>
            </div>
        </div>
        <img src="C:\Users\user\Downloads\snapedit_1758597351469.png" alt="Профессиональная поддержка" class="hero-image">
    </section>

    <!-- Особенности -->
    <section class="features">
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h3 class="feature-title">Доверие и Безопасность</h3>
                <p class="feature-description">Создаем доверительную атмосферу для обсуждения рабочих моментов без осуждения. Конфиденциальность - наш приоритет. Мы соблюдаем все этические стандарты.</p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <h3 class="feature-title">Эмпатия и Открытость</h3>
                <p class="feature-description">Мы слушаем, слышим и понимаем ваши профессиональные переживания, принимая вас без условий. Поддержка в сложных ситуациях - наша миссия.</p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h3 class="feature-title">Профессионализм и Развитие</h3>
                <p class="feature-description">Наши супервизоры постоянно совершенствуются, чтобы помочь вам наиболее эффективно развиваться. Регулярные тренинги и семинары для всех участников.</p>
            </div>
            
    </section>

    <!-- Секция помощи -->
    <section class="help" id="services">
        <h2 class="section-title">Мы поможем, если...</h2>

        <div class="help-cards">
            <div class="help-card">
                <h3 class="help-title">
                    <i class="fas fa-user"></i> Вы — специалист, и:
                </h3>
                <ul class="help-list">
                    <li>Столкнулись с трудностями в работе, ошибками или неуверенностью</li>
                    <li>Хотите обсудить сильные и слабые стороны своей практики</li>
                    <li>Ищете поддержку в профессиональном развитии</li>
                    <li>Чувствуете выгорание или потерю мотивации</li>
                    <li>Нуждаетесь в свежем взгляде на сложные случаи</li>
                </ul>
            </div>

            <div class="help-card">
                <h3 class="help-title">
                    <i class="fas fa-users"></i> Вы работаете с клиентами, и:
                </h3>
                <ul class="help-list">
                    <li>Нуждаетесь в анализе сложных случаев</li>
                    <li>Хотите улучшить качество своей работы</li>
                    <li>Анализ случаев</li>
                    <li>Стремитесь к долгосрочному развитию навыков</li>
                    <li>Ищете способы повышения эффективности терапии</li>
                </ul>
            </div>

            <div class="help-card">
                <h3 class="help-title">
                    <i class="fas fa-hands-helping"></i> Вы переживаете кризис, и:
                </h3>
                <ul class="help-list">
                    <li>Нуждаетесь в обсуждении профессиональных утрат или неудач</li>
                    <li>Испытываете эмоциональное истощение</li>
                    <li>Хотите получить объективную обратную связь</li>
                    <li>Ищете поддержку в сложных этических вопросах</li>
                    <li>Боретесь с последствиями травматичных случаев</li>
                </ul>
            </div>

            <div class="help-card">
                <h3 class="help-title"><i class="fas fa-hands"></i> И если:</h3>
                <ul class="help-list">
                    <li>Вам важно быть услышанным без осуждения</li>
                    <li>Вы ищете профессиональную, бережную супервизию</li>
                    <li>
                        Вы готовы начать путь к профессиональному росту — в удобном темпе и в безопасной среде
                    </li>
                    <li>Хотите повысить свою компетентность и уверенность</li>
                    <li>Стремитесь к балансу между работой и личной жизнью</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Футер с дополнительной информацией -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-info">
                <div class="footer-logo">Центр супервизоров</div>
                <p class="footer-description">
                    Пространство, где каждый специалист может получить профессиональную
                    супервизию и поддержку в вашем развитии.
                </p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-vk"></i></a>
                    <a href="#"><i class="fab fa-telegram"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                </div>
            </div>

            <div class="footer-links-container">
                <h3 class="footer-heading">Навигация</h3>
                <ul class="footer-links">
                    <li><a href="#services">Услуги</a></li>
                    <li><a href="#reviews">Отзывы</a></li>
                    <li><a href="#about">О нас</a></li>
                    <li><a href="#blog">Блог</a></li>
                    <li><a href="#contacts">Контакты</a></li>
                </ul>
            </div>

            <div class="footer-links-container">
                <h3 class="footer-heading">Контакты</h3>
                <ul class="footer-links">
                    <li><i class="fas fa-map-marker-alt"></i> Челябинск</li>
                    <li><i class="fas fa-phone"></i> +7 (999) 123-45-67</li>
                    <li><i class="fas fa-envelope"></i> info@supervizor-center.ru</li>
                    <li><i class="fas fa-clock"></i> Пн-Пт: 9:00-21:00</li>
                </ul>
            </div>
        </div>

        <div class="footer-info-additional">
            <p>Мы предлагаем широкий спектр услуг по супервизии для психологов и специалистов. Наша команда состоит из опытных профессионалов, готовых помочь в вашем росте.</p>
            <p>Подписывайтесь на нашу рассылку для получения обновлений и советов по профессиональному развитию.</p>
            <p>Мы регулярно проводим вебинары и мастер-классы. Следите за анонсами в блоге.</p>
        </div>

        <div class="copyright">
            &copy; 2025 Центр супервизоров. Все права защищены.
        </div>
    </footer>

    <!-- Модальное окно входа -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal">
            <span class="modal-close" data-modal="loginModal">&times;</span>
            <h2 class="modal-title">Вход в личный кабинет</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label" for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" class="form-input" placeholder="Ваш email" required />
                    <div class="form-error" id="loginEmailError">
                        Пожалуйста, введите корректный email
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="loginPassword">Пароль</label>
                    <input type="password" id="loginPassword" class="form-input" placeholder="Ваш пароль" required />
                    <div class="form-error" id="loginPasswordError">
                        Пароль должен содержать не менее 6 символов
                    </div>
                </div>
                <button type="submit" class="btn btn-register" style="width: 100%">
                    Войти
                </button>
                <div class="form-footer">
                    <p>
                        Еще нет аккаунта?
                        <a class="form-link" data-from="loginModal" data-to="registerModal">Зарегистрироваться</a>
                    </p>
                </div>
            </form>
        </div>
    </div>

    <!-- Модальное окно регистрации -->
    <div class="modal-overlay" id="registerModal">
        <div class="modal">
            <span class="modal-close" data-modal="registerModal">&times;</span>
            <h2 class="modal-title">Регистрация</h2>
            <form id="registerForm">
                <div class="role-selector">
                    <div class="role-option selected" data-role="client">
                        <div class="role-icon"><i class="fas fa-user"></i></div>
                        <div>Клиент</div>
                    </div>
                    <div class="role-option" data-role="specialist">
                        <div class="role-icon"><i class="fas fa-graduation-cap"></i></div>
                        <div>Супервизор</div>
                    </div>
                </div>
                <input type="hidden" id="userRole" name="role" value="client" />

                <div class="form-group">
                    <label class="form-label" for="registerName">Имя</label>
                    <input type="text" id="registerName" class="form-input" placeholder="Ваше имя" required />
                    <div class="form-error" id="registerNameError">
                        Пожалуйста, введите ваше имя
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" class="form-input" placeholder="Ваш email" required />
                    <div class="form-error" id="registerEmailError">
                        Пожалуйста, введите корректный email
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="registerPassword">Пароль</label>
                    <input type="password" id="registerPassword" class="form-input" placeholder="Придумайте пароль"
                        required />
                    <div class="form-error" id="registerPasswordError">
                        Пароль должен содержать не менее 6 символов
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="registerConfirmPassword">Подтверждение пароля</label>
                    <input type="password" id="registerConfirmPassword" class="form-input"
                        placeholder="Повторите пароль" required />
                    <div class="form-error" id="registerConfirmPasswordError">
                        Пароли не совпадают
                    </div>
                </div>

                <button type="submit" class="btn btn-register" style="width: 100%">
                    Зарегистрироваться
                </button>

                <div class="form-footer">
                    <p>
                        Уже есть аккаунт?
                        <a class="form-link" data-from="registerModal" data-to="loginModal">Войти</a>
                    </p>
                </div>
            </form>
        </div>
    </div>

    <!-- Модальное окно опроса -->
    <div class="modal-overlay survey-modal" id="surveyModal">
        <div class="modal">
            <span class="modal-close" data-modal="surveyModal">&times;</span>
            <h2 class="modal-title">Расскажите, какая супервизия вам нужна</h2>
            <form id="surveyForm">
                <div class="survey-options">
                    <label class="survey-option" data-problem="Профессиональное выгорание">
                        <input type="radio" name="problem" value="Профессиональное выгорание" style="display: none;">
                        <i class="fas fa-fire"></i> Профессиональное выгорание
                    </label>
                    <label class="survey-option" data-problem="Этические вопросы">
                        <input type="radio" name="problem" value="Этические вопросы" style="display: none;">
                        <i class="fas fa-balance-scale"></i> Этические вопросы
                    </label>
                    <label class="survey-option" data-problem="Анализ случаев">
                        <input type="radio" name="problem" value="Анализ случаев" style="display: none;">
                        <i class="fas fa-search"></i> Анализ случаев
                    </label>
                    <label class="survey-option" data-problem="Развитие навыков">
                        <input type="radio" name="problem" value="Развитие навыков" style="display: none;">
                        <i class="fas fa-chart-line"></i> Развитие навыков
                    </label>
                    <label class="survey-option" data-problem="Другое">
                        <input type="radio" name="problem" value="Другое" style="display: none;">
                        <i class="fas fa-question"></i> Другое
                    </label>
                </div>
                <button type="submit" class="btn btn-register" style="width: 100%; margin-top: 1rem;">
                    Продолжить
                </button>
            </form>
        </div>
    </div>

    <!-- Модальное окно оценки занятия -->
    <div class="modal-overlay rate-session-modal" id="rateSessionModal">
        <div class="modal">
            <span class="modal-close" data-modal="rateSessionModal">&times;</span>
            <h2 class="modal-title">Оцените сессию</h2>
            <form id="rateSessionForm">
                <div class="form-group">
                    <label class="form-label">Выберите эмоции</label>
                    <div class="emotions-grid">
                        <button type="button" class="emotion-btn" data-emotion="Радость">Радость</button>
                        <button type="button" class="emotion-btn" data-emotion="Спокойствие">Спокойствие</button>
                        <button type="button" class="emotion-btn" data-emotion="Тревога">Тревога</button>
                        <button type="button" class="emotion-btn" data-emotion="Гнев">Гнев</button>
                        <button type="button" class="emotion-btn" data-emotion="Печаль">Печаль</button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="sessionProblem">С какой проблемой вы пришли?</label>
                    <textarea id="sessionProblem" class="form-input" rows="2"
                        placeholder="Опишите проблему..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label" for="sessionConclusions">Какие выводы сделали для себя?</label>
                    <textarea id="sessionConclusions" class="form-input" rows="2"
                        placeholder="Ваши выводы..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label" for="sessionComment">Комментарий к сессии</label>
                    <textarea id="sessionComment" class="form-input" rows="4"
                        placeholder="Ваши мысли о сессии..."></textarea>
                </div>
                <input type="hidden" id="sessionAppId" value="">
                <button type="submit" class="btn btn-register" style="width: 100%">Сохранить оценку</button>
            </form>
        </div>
    </div>

    <!-- Модальное окно для выбора для заметок к записи -->
    <div class="modal-overlay" id="appointmentNotesChoiceModal">
        <div class="modal">
            <span class="modal-close" data-modal="appointmentNotesChoiceModal">&times;</span>
            <h2 class="modal-title">Заметки к записи</h2>
            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem;">
                <button class="btn btn-login" id="sessionNoteBtn">Заметка до сессии</button>
                <button class="btn btn-register" id="conductedBtn">Сессия проведена</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно написания заметки к записи -->
    <div class="modal-overlay" id="appointmentNoteModal">
        <div class="modal">
            <span class="modal-close" data-modal="appointmentNoteModal">&times;</span>
            <h2 class="modal-title">Написать заметку</h2>
            <form id="appointmentNoteForm">
                <div class="form-group">
                    <label class="form-label" for="noteContent">Появились ли у вас после сессии какие-либо мысли, вопросы или инсайты, которые вы хотите отметить?</label>
                    <textarea id="noteContent" class="form-input" rows="4" placeholder="Ваши мысли, эмоции..."
                        required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Насколько вы чувствуете себя понятым/ой и услышанным/ой после нашей беседы? (по шкале от 1 до 5)</label>
                    <div class="survey-options">
                        <label class="survey-option">
                            <input type="radio" name="noteScale" value="1" style="display: none;">
                            1 — Совсем нет
                        </label>
                        <label class="survey-option">
                            <input type="radio" name="noteScale" value="2" style="display: none;">
                            2 — Скорее нет, чем да.
                        </label>
                        <label class="survey-option">
                            <input type="radio" name="noteScale" value="3" style="display: none;">
                            3 — Нейтрально / Затрудняюсь ответить.
                        </label>
                        <label class="survey-option">
                            <input type="radio" name="noteScale" value="4" style="display: none;">
                            4 — Скорее да, чем нет.
                        </label>
                        <label class="survey-option">
                            <input type="radio" name="noteScale" value="5" style="display: none;">
                            5 — Абсолютно да.
                        </label>
                    </div>
                </div>
                <button type="submit" class="btn btn-register" style="width: 100%">Сохранить заметку</button>
            </form>
        </div>
    </div>

    <!-- Личный кабинет клиента -->
    <section class="dashboard" id="clientDashboard">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Личный кабинет</h1>
            <p class="dashboard-subtitle">
                Добро пожаловать, <span id="clientName">Алексей</span>!
            </p>
        </div>

        <div class="dashboard-tabs">
            <button class="tab-btn active" data-tab="search">
                Поиск супервизора
            </button>
            <button class="tab-btn" data-tab="appointments">Мои записи</button>
            <button class="tab-btn" data-tab="journal">Мой дневник</button>
            <button class="tab-btn" data-tab="profile">Профиль</button>
        </div>

        <div class="tab-content active" id="searchTab">
            <div class="search-filters">
                <div class="filter-row">
                    <div class="form-group">
                        <label class="form-label" for="specialtyFilter">Специализация</label>
                        <select id="specialtyFilter" class="form-input">
                            <option value="">Все специализации</option>
                            <option value="Супервизия для семейных психологов">Супервизия для семейных психологов</option>
                            <option value="Супервизия для детских психологов">Супервизия для детских психологов</option>
                            <option value="Супервизия для клинических психологов">Супервизия для клинических психологов</option>
                            <option value="Супервизия для нейропсихологов">Супервизия для нейропсихологов</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="priceFilter">Цена за сессию</label>
                        <select id="priceFilter" class="form-input">
                            <option value="">Любая</option>
                            <option value="1000-2000">1000-2000 руб.</option>
                            <option value="2000-3000">2000-3000 руб.</option>
                            <option value="3000-5000">3000-5000 руб.</option>
                            <option value="5000+">от 5000 руб.</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="ratingFilter">Рейтинг</label>
                        <select id="ratingFilter" class="form-input">
                            <option value="">Любой</option>
                            <option value="4+">от 4 звезд</option>
                            <option value="4.5+">от 4.5 звезд</option>
                        </select>
                    </div>
                </div>

                <div class="filter-row">
                    <div class="form-group">
                        <label class="form-label" for="searchInput">Поиск по имени</label>
                        <input type="text" id="searchInput" class="form-input" placeholder="Введите имя супервизора" />
                    </div>

                    <button class="btn btn-register" id="applyFilters">
                        Применить фильтры
                    </button>
                </div>
            </div>

            <div class="specialists-grid" id="specialistsContainer">
                <!-- Супервизоры будут добавляться через JavaScript -->
            </div>
        </div>

        <div class="tab-content" id="appointmentsTab">
            <h2>Мои записи</h2>
            <div id="appointmentsContainer">
                <!-- Записи будут добавляться через JavaScript -->
            </div>
        </div>

        <div class="tab-content" id="journalTab">
            <h2>Мой дневник эмоций</h2>
            <div class="journal-container">
                <div id="journalEntries">
                    <!-- Записи дневника будут добавляться через JavaScript -->
                </div>
                <form id="journalForm" class="journal-form">
                    <div class="form-group">
                        <label class="form-label" for="journalContent">Описание чувств и эмоций</label>
                        <textarea id="journalContent" class="form-input"
                            placeholder="Опишите свои чувства и эмоции сегодня..." required></textarea>
                    </div>
                    <button type="submit" class="btn btn-register">
                        Добавить запись
                    </button>
                </form>
            </div>
        </div>

        <div class="tab-content" id="profileTab">
            <h2>Мой профиль</h2>
            <form id="clientProfileForm">
                <div class="form-group">
                    <label class="form-label" for="clientProfileName">Имя</label>
                    <input type="text" id="clientProfileName" class="form-input" value="Алексей" />
                </div>

                <div class="form-group">
                    <label class="form-label" for="clientProfileEmail">Email</label>
                    <input type="email" id="clientProfileEmail" class="form-input" value="alexey@example.com"
                        readonly />
                </div>

                <div class="form-group">
                    <label class="form-label" for="clientProfilePhone">Телефон</label>
                    <input type="tel" id="clientProfilePhone" class="form-input" placeholder="+7 (999) 123-45-67" />
                </div>

                <div class="form-group">
                    <label class="form-label" for="clientProfileBirthdate">Дата рождения</label>
                    <input type="date" id="clientProfileBirthdate" class="form-input" />
                </div>

                <div class="form-group">
                    <label class="form-label" for="clientProfilePhoto">Фото профиля</label>
                    <input type="file" id="clientProfilePhoto" class="form-input" accept="image/*">
                    <img id="clientPhotoPreview" class="media-preview" style="display: none;">
                </div>

                <button type="submit" class="btn btn-register">
                    Сохранить изменения
                </button>
            </form>
        </div>
    </section>

    <!-- Личный кабинет супервизора -->
    <section class="dashboard" id="specialistDashboard">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Кабинет супервизора</h1>
            <p class="dashboard-subtitle">
                Добро пожаловать, <span id="specialistName">Доктор Петрова</span>!
            </p>
        </div>

        <div class="dashboard-tabs">
            <button class="tab-btn active" data-tab="schedule">Расписание</button>
            <button class="tab-btn" data-tab="clients">Мои клиенты</button>
            <button class="tab-btn" data-tab="allAppointments">Все записи</button>
            <button class="tab-btn" data-tab="addClient">Добавить клиента</button>
            <button class="tab-btn" data-tab="specialistProfile">Профиль</button>
        </div>

        <div class="tab-content active" id="scheduleTab">
            <h2>Мое расписание</h2>
            <div class="calendar-container">
                <div class="calendar-header">
                    <h3 id="calendarMonth">Июль 2025</h3>
                    <div>
                        <button class="btn btn-login" id="prevMonth">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="btn btn-login" id="nextMonth">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>

                <div class="calendar-grid" id="calendarDays">
                    <!-- Дни календаря будут добавляться через JavaScript -->
                </div>

                <div class="time-slots" id="timeSlotsContainer">
                    <!-- Временные слоты будут добавляться через JavaScript -->
                </div>
            </div>
            <div class="form-group">
                <button class="btn btn-register" id="saveSchedule">
                    Сохранить расписание
                </button>
            </div>
        </div>

        <div class="tab-content" id="clientsTab">
            <h2>Мои клиенты</h2>
            <div class="clients-list" id="clientsContainer">
                <!-- Клиенты будут добавляться через JavaScript -->
            </div>
        </div>

        <div class="tab-content" id="allAppointmentsTab">
            <h2>Все записи</h2>
            <div id="allAppointmentsContainer">
                <!-- Записи будут добавляться через JavaScript -->
            </div>
        </div>

        <div class="tab-content" id="addClientTab">
            <h2>Добавить клиента</h2>
            <form id="addClientForm">
                <div class="form-group">
                    <label class="form-label" for="clientFirstName">Имя</label>
                    <input type="text" id="clientFirstName" class="form-input" required />
                </div>

                <div class="form-group">
                    <label class="form-label" for="clientLastName">Фамилия</label>
                    <input type="text" id="clientLastName" class="form-input" required />
                </div>

                <div class="form-group">
                    <label class="form-label" for="clientEmail">Email</label>
                    <input type="email" id="clientEmail" class="form-input" />
                </div>

                <div class="form-group">
                    <label class="form-label" for="clientPhone">Телефон</label>
                    <input type="tel" id="clientPhone" class="form-input" required />
                </div>

                <div class="form-group">
                    <label class="form-label" for="clientBirthdate">Дата рождения</label>
                    <input type="date" id="clientBirthdate" class="form-input" />
                </div>

                <div class="form-group">
                    <label class="form-label" for="clientNotes">Заметки</label>
                    <textarea id="clientNotes" class="form-input" rows="4"></textarea>
                </div>

                <button type="submit" class="btn btn-register">
                    Добавить клиента
                </button>
            </form>
        </div>

        <div class="tab-content" id="specialistProfileTab">
            <h2>Мой профиль</h2>
            <form id="specialistProfileForm">
                <div class="form-group">
                    <label class="form-label" for="specialistProfileName">Имя и фамилия</label>
                    <input type="text" id="specialistProfileName" class="form-input" value="Мария Петрова" />
                </div>

                <div class="form-group">
                    <label class="form-label" for="specialistProfileEmail">Email</label>
                    <input type="email" id="specialistProfileEmail" class="form-input" value="petrova@example.com"
                        readonly />
                </div>

                <div class="form-group">
                    <label class="form-label" for="specialistProfileSpecialty">Специализация</label>
                    <select id="specialistProfileSpecialty" class="form-input">
                        <option value="Супервизия для семейных психологов">Супервизия для семейных психологов</option>
                        <option value="Супервизия для детских психологов">Супервизия для детских психологов</option>
                        <option value="Супервизия для клинических психологов" selected>Супервизия для клинических психологов</option>
                        <option value="Супервизия для нейропсихологов">Супервизия для нейропсихологов</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label" for="specialistProfileExperience">Опыт работы (лет)</label>
                    <input type="number" id="specialistProfileExperience" class="form-input" value="7" min="0" />
                </div>

                <div class="form-group">
                    <label class="form-label" for="specialistProfileEducation">Образование</label>
                    <textarea id="specialistProfileEducation" class="form-input"
                        rows="3">МГУ, факультет психологии</textarea>
                </div>

                <div class="form-group">
                    <label class="form-label" for="specialistProfileDescription">О себе</label>
                    <textarea id="specialistProfileDescription" class="form-input"
                        rows="4">Специализируюсь на супервизии работы с тревожными расстройствами и депрессией. Использую методы КПТ и гештальт-терапии.</textarea>
                </div>

                <div class="form-group">
                    <label class="form-label" for="specialistProfilePrice">Цена за сессию (руб.)</label>
                    <input type="number" id="specialistProfilePrice" class="form-input" value="3500" min="0" />
                </div>

                <div class="form-group">
                    <label class="form-label" for="specialistProfilePhoto">Фото профиля</label>
                    <input type="file" id="specialistProfilePhoto" class="form-input" accept="image/*">
                    <img id="specialistPhotoPreview" class="media-preview" style="display: none;">
                </div>

                <div class="form-group">
                    <label class="form-label" for="specialistProfileVideo">Видео профиля</label>
                    <input type="file" id="specialistProfileVideo" class="form-input" accept="video/*">
                    <video id="specialistVideoPreview" class="video-preview" style="display: none;" controls></video>
                </div>

                <button type="submit" class="btn btn-register">
                    Сохранить изменения
                </button>
            </form>
        </div>
    </section>

    <!-- Модальное окно для полного профиля клиента -->
    <div class="modal-overlay client-detail-modal" id="clientDetailModal">
        <div class="modal modal-wide client-full-profile">
            <span class="modal-close" data-modal="clientDetailModal">&times;</span>
            <h2 class="modal-title" id="clientDetailTitle">Профиль клиента</h2>
            <div id="clientFullProfileContent">
                <!-- Содержимое профиля будет добавляться через JS -->
            </div>
        </div>
    </div>

    <!-- Модальное окно для полного профиля супервизора (в кабинете клиента) -->
    <div class="modal-overlay specialist-detail-modal" id="specialistDetailModal">
        <div class="modal modal-wide specialist-full-profile">
            <span class="modal-close" data-modal="specialistDetailModal">&times;</span>
            <h2 class="modal-title" id="specialistDetailTitle">Профиль супервизора</h2>
            <div id="specialistFullProfileContent">
                <!-- Содержимое профиля будет добавляться через JS -->
            </div>
        </div>
    </div>

    <!-- Модальное окно для заметок супервизора -->
    <div class="modal-overlay notes-modal" id="notesModal">
        <div class="modal">
            <span class="modal-close" data-modal="notesModal">&times;</span>
            <h2 class="modal-title" id="notesTitle">Заметки для клиента</h2>
            <div class="notes-list" id="notesList">
                <!-- Заметки будут добавляться через JS -->
            </div>
            <form id="notesForm" class="notes-form">
                <div class="form-group">
                    <label class="form-label" for="noteContent">Описание сессии, чувств и эмоций клиента</label>
                    <textarea id="noteContent" class="form-input"
                        placeholder="Опишите ключевые моменты сессии, наблюдаемые эмоции и прогресс..."
                        required></textarea>
                </div>
                <div class="form-group problem-selector">
                    <label class="form-label">Основная проблема клиента</label>
                    <div>
                        <div class="problem-option selected" data-problem="Эмоциональное выгорание">Эмоциональное
                            выгорание
                        </div>
                        <div class="problem-option" data-problem="Отношения и конфликты">Отношения и конфликты</div>
                        <div class="problem-option" data-problem="Тревога и стресс">Тревога и стресс</div>
                        <div class="problem-option" data-problem="Самооценка">Самооценка</div>
                        <div class="problem-option" data-problem="Другое">Другое</div>
                    </div>
                </div>
                <div class="form-group request-selector">
                    <label class="form-label">Выявленный ключевой запрос</label>
                    <div>
                        <div class="request-option selected" data-request="Развитие личности">Развитие личности</div>
                        <div class="request-option" data-request="Семейные отношения">Семейные отношения</div>
                        <div class="request-option" data-request="Карьерный рост">Карьерный рост</div>
                        <div class="request-option" data-request="Здоровье и благополучие">Здоровье и благополучие</div>
                        <div class="request-option" data-request="Другое">Другое</div>
                    </div>
                </div>
                <button type="submit" class="btn btn-register">
                    Добавить заметку
                </button>
            </form>
        </div>
    </div>

    <!-- Модальное окно для записи на супервизию (подтверждение) -->
    <div class="modal-overlay booking-modal" id="bookingModal">
        <div class="modal">
            <span class="modal-close" data-modal="bookingModal">&times;</span>
            <h2 class="modal-title">Запись на супервизию</h2>
            <div class="booking-summary" id="bookingSummary">
                <!-- Информация о записи будет добавляться через JS -->
            </div>
            <form id="bookingForm">
                <div class="form-group">
                    <label class="form-label" for="bookingNotes">Ваши пожелания или вопросы</label>
                    <textarea id="bookingNotes" class="form-input" rows="3"
                        placeholder="Опишите, с какой проблемой вы хотите обратиться..."></textarea>
                </div>
                <button type="submit" class="btn btn-register" style="width: 100%">
                    Подтвердить запись
                </button>
            </form>
        </div>
    </div>

    <!-- Модальное окно записи клиента (супервизор) -->
    <div class="modal-overlay modal-large" id="bookClientModal">
        <div class="modal modal-large">
            <span class="modal-close" data-modal="bookClientModal">&times;</span>
            <h2 class="modal-title">Записать клиента</h2>
            <div class="calendar-container" id="bookCalendarContainer">
                <div class="calendar-header">
                    <h3 id="bookCalendarMonth"></h3>
                    <div>
                        <button class="btn btn-login" id="bookPrevMonth"><i class="fas fa-chevron-left"></i></button>
                        <button class="btn btn-login" id="bookNextMonth"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                <div class="calendar-grid" id="bookCalendarDays"></div>
                <div class="time-slots" id="bookTimeSlotsContainer"></div>
            </div>
            <button class="btn btn-register" id="confirmBookClient" style="width: 100%">Подтвердить запись</button>
        </div>
    </div>

    <!-- Модальное окно выбора для расписания -->
    <div class="modal-overlay" id="scheduleChoiceModal">
        <div class="modal">
            <span class="modal-close" data-modal="scheduleChoiceModal">&times;</span>
            <h2 class="modal-title">Что планируете на это время?</h2>
            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem;">
                <button class="btn btn-register" id="bookClientChoice">Записать клиента</button>
                <button class="btn btn-login" id="otherPlanChoice">Другой план</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно записи конкретного клиента из расписания -->
    <div class="modal-overlay" id="bookSpecificClientModal">
        <div class="modal">
            <span class="modal-close" data-modal="bookSpecificClientModal">&times;</span>
            <h2 class="modal-title">Записать клиента на выбранное время</h2>
            <form id="bookSpecificClientForm">
                <div class="form-group">
                    <label class="form-label" for="selectClient">Выберите клиента</label>
                    <select id="selectClient" class="form-input" required>
                        <!-- Опции добавляются динамически -->
                    </select>
                </div>
                <div class="booking-summary" id="selectedSlotInfo">
                    <!-- Информация о слоте -->
                </div>
                <button type="submit" class="btn btn-register" style="width: 100%">Записать</button>
            </form>
        </div>
    </div>

    <!-- Модальное окно другого плана -->
    <div class="modal-overlay" id="otherPlanModal">
        <div class="modal">
            <span class="modal-close" data-modal="otherPlanModal">&times;</span>
            <h2 class="modal-title">Другой план</h2>
            <form id="otherPlanForm">
                <div class="form-group">
                    <label class="form-label" for="planTitle">Название плана</label>
                    <input type="text" id="planTitle" class="form-input" required />
                </div>
                <div class="form-group">
                    <label class="form-label" for="planDescription">Описание</label>
                    <textarea id="planDescription" class="form-input" rows="3" required></textarea>
                </div>
                <div class="booking-summary" id="selectedPlanSlotInfo">
                    <!-- Информация о слоте -->
                </div>
                <button type="submit" class="btn btn-register" style="width: 100%">Добавить план</button>
            </form>
        </div>
    </div>

    <!-- Модальное окно выбора даты/времени для клиента -->
    <div class="modal-overlay modal-large" id="clientBookingModal">
        <div class="modal modal-large">
            <span class="modal-close" data-modal="clientBookingModal">&times;</span>
            <h2 class="modal-title">Выберите дату и время</h2>
            <div class="calendar-container" id="clientCalendarContainer">
                <div class="calendar-header">
                    <h3 id="clientCalendarMonth"></h3>
                    <div>
                        <button class="btn btn-login" id="clientPrevMonth"><i class="fas fa-chevron-left"></i></button>
                        <button class="btn btn-login" id="clientNextMonth"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                <div class="calendar-grid" id="clientCalendarDays"></div>
                <div class="time-slots" id="clientTimeSlotsContainer"></div>
            </div>
            <button class="btn btn-register" id="confirmClientTime" style="width: 100%">Далее</button>
        </div>
    </div>

    <!-- Модальное окно для переноса записи супервизором -->
    <div class="modal-overlay modal-large" id="rescheduleModal">
        <div class="modal modal-large">
            <span class="modal-close" data-modal="rescheduleModal">&times;</span>
            <h2 class="modal-title">Перенести запись</h2>
            <div class="calendar-container" id="rescheduleCalendarContainer">
                <div class="calendar-header">
                    <h3 id="rescheduleCalendarMonth"></h3>
                    <div>
                        <button class="btn btn-login" id="reschedulePrevMonth"><i
                                class="fas fa-chevron-left"></i></button>
                        <button class="btn btn-login" id="rescheduleNextMonth"><i
                                class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                <div class="calendar-grid" id="rescheduleCalendarDays"></div>
                <div class="time-slots" id="rescheduleTimeSlotsContainer"></div>
            </div>
            <button class="btn btn-register" id="confirmReschedule" style="width: 100%">Подтвердить перенос</button>
        </div>
    </div>

    <!-- Контейнер для уведомлений -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Индикатор загрузки -->
    <div class="loader-overlay" id="loaderOverlay">
        <div class="loader"></div>
    </div>


    <script>
        // Система хранения данных
        const Storage = {
            get: (key) => {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            },

            set: (key, data) => {
                localStorage.setItem(key, JSON.stringify(data));
            },

            remove: (key) => {
                localStorage.removeItem(key);
            },

            clear: () => {
                localStorage.clear();
            },
        };

        const STORAGE_KEYS = {
            USERS: "supervizor_users",
            SPECIALISTS: "supervizor_specialists",
            APPOINTMENTS: "supervizor_appointments",
            CLIENTS: "supervizor_clients",
            JOURNALS: "supervizor_journals",
            NOTES: "supervizor_notes",
            REVIEWS: "supervizor_reviews",
            CURRENT_USER: "supervizor_current_user",
        };

        // Инициализация данных при первом запуске
        function initializeData() {
            if (!Storage.get(STORAGE_KEYS.USERS)) {
                const users = [
                    {
                        id: 1,
                        name: "Алексей Козлов",
                        email: "client@example.com",
                        password: "password123",
                        role: "client",
                        phone: "+7 (999) 123-45-67",
                        birthdate: "1990-05-15",
                        photo: "",
                        helpNeeded: "Профессиональное выгорание",
                    },
                    {
                        id: 2,
                        name: "Мария Петрова",
                        email: "specialist@example.com",
                        password: "password123",
                        role: "specialist",
                        specialty: "Супервизия для клинических психологов",
                        experience: 7,
                        education: "МГУ, факультет психологии",
                        description:
                            "Специализируюсь на супервизии работы с тревожными расстройствами и депрессией. Использую методы КПТ и гештальт-терапии.",
                        price: 3500,
                        photo: "",
                        video: "",
                    },
                ];

                Storage.set(STORAGE_KEYS.USERS, users);
            }

            if (!Storage.get(STORAGE_KEYS.SPECIALISTS)) {
                const specialists = [
                    {
                        id: 1,
                        name: "Мария Петрова",
                        specialty: "Супервизия для клинических психологов",
                        experience: 7,
                        rating: 4.8,
                        reviews: 42,
                        price: 3500,
                        avatar: "https://randomuser.me/api/portraits/women/12.jpg",
                        description:
                            "Специализируюсь на супервизии работы с тревожными расстройствами и депрессией. Использую методы КПТ и гештальт-терапии.",
                        userId: 2,
                    },
                    {
                        id: 2,
                        name: "Иван Сидоров",
                        specialty: "Супервизия для семейных психологов",
                        experience: 5,
                        rating: 4.6,
                        reviews: 28,
                        price: 3000,
                        avatar: "https://randomuser.me/api/portraits/men/32.jpg",
                        description:
                            "Помогаю в супервизии парам наладить отношения, решить конфликты и улучшить взаимопонимание.",
                        userId: null,
                    },
                    {
                        id: 3,
                        name: "Ольга Иванова",
                        specialty: "Супервизия для детских психологов",
                        experience: 9,
                        rating: 4.9,
                        reviews: 56,
                        price: 4000,
                        avatar: "https://randomuser.me/api/portraits/women/45.jpg",
                        description:
                            "Работаю в супервизии с детьми и подростками. Помогаю решить проблемы поведения, обучения и социализации.",
                        userId: null,
                    },
                ];

                Storage.set(STORAGE_KEYS.SPECIALISTS, specialists);
            }

            if (!Storage.get(STORAGE_KEYS.APPOINTMENTS)) {
                Storage.set(STORAGE_KEYS.APPOINTMENTS, []);
            }

            if (!Storage.get(STORAGE_KEYS.CLIENTS)) {
                Storage.set(STORAGE_KEYS.CLIENTS, []);
            }

            if (!Storage.get(STORAGE_KEYS.JOURNALS)) {
                Storage.set(STORAGE_KEYS.JOURNALS, []);
            }

            if (!Storage.get(STORAGE_KEYS.NOTES)) {
                Storage.set(STORAGE_KEYS.NOTES, []);
            }

            if (!Storage.get(STORAGE_KEYS.REVIEWS)) {
                Storage.set(STORAGE_KEYS.REVIEWS, []);
            }
        }

        // Данные для демонстрации
        let specialistsData = [];
        let appointmentsData = [];
        let clientsData = [];
        let journalData = [];
        let notesData = [];
        let reviewsData = [];

        // Календарные данные
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();

        let bookings = {};

        // Текущий пользователь
        let currentUser = null;

        // Для заметок к записи
        let currentAppIdForNote = null;
        let isConducted = false;

        // Основной код приложения
        document.addEventListener("DOMContentLoaded", function () {
            // Инициализация данных
            initializeData();
            loadData();

            // Проверяем, есть ли активный пользователь
            const savedUser = Storage.get(STORAGE_KEYS.CURRENT_USER);
            if (savedUser) {
                currentUser = savedUser;
                if (currentUser.role === "specialist") {
                    showDashboard("specialist");
                } else {
                    showDashboard("client");
                }
            }

            // Мобильное меню
            const menuToggle = document.querySelector(".menu-toggle");
            const mobileMenu = document.querySelector(".mobile-menu");
            const menuOverlay = document.querySelector(".menu-overlay");
            const navItems = document.querySelectorAll(".mobile-menu .nav-item");
            const mobileLoginBtn = document.getElementById("mobileLoginBtn");
            const mobileRegisterBtn = document.getElementById("mobileRegisterBtn");
            const mobileLogoutBtn = document.getElementById("mobileLogoutBtn");

            function toggleMenu() {
                const isActive = mobileMenu.classList.toggle("active");
                menuOverlay.classList.toggle("active");
                const icon = menuToggle.querySelector("i");
                icon.classList.toggle("fa-bars");
                icon.classList.toggle("fa-times");

                // Показать/скрыть кнопки авторизации в зависимости от состояния пользователя
                if (currentUser) {
                    mobileMenu.querySelector(".nav-auth").style.display = "none";
                    mobileMenu.querySelector(".nav-logout").style.display = "flex";
                } else {
                    mobileMenu.querySelector(".nav-auth").style.display = "flex";
                    mobileMenu.querySelector(".nav-logout").style.display = "none";
                }
            }

            function closeMenu() {
                mobileMenu.classList.remove("active");
                menuOverlay.classList.remove("active");
                const icon = menuToggle.querySelector("i");
                icon.classList.add("fa-bars");
                icon.classList.remove("fa-times");
            }

            menuToggle.addEventListener("click", toggleMenu);
            menuOverlay.addEventListener("click", closeMenu);

            navItems.forEach((item) => {
                item.addEventListener("click", closeMenu);
            });

            if (mobileLoginBtn) {
                mobileLoginBtn.addEventListener("click", () => {
                    closeMenu();
                    openModal("loginModal");
                });
            }

            if (mobileRegisterBtn) {
                mobileRegisterBtn.addEventListener("click", () => {
                    closeMenu();
                    openModal("registerModal");
                });
            }

            if (mobileLogoutBtn) {
                mobileLogoutBtn.addEventListener("click", () => {
                    closeMenu();
                    logout();
                });
            }

            // Анимация на навигации при прокрутке
            window.addEventListener("scroll", function () {
                const navbar = document.querySelector(".navbar");
                if (window.scrollY > 50) {
                    navbar.classList.add("scrolled");
                } else {
                    navbar.classList.remove("scrolled");
                }

                // Анимация карточек при прокрутке
                const featureCards = document.querySelectorAll(".feature-card");
                const helpCards = document.querySelectorAll(".help-card");
                animateOnScroll(featureCards, "animate");
                animateOnScroll(helpCards, "animate");
            });

            // Функция для анимации при прокрутке
            function animateOnScroll(elements, className) {
                elements.forEach((element) => {
                    const position = element.getBoundingClientRect();
                    if (position.top < window.innerHeight - 100) {
                        element.classList.add(className);
                    }
                });
            }

            // Инициализация анимации при загрузке
            const featureCards = document.querySelectorAll(".feature-card");
            const helpCards = document.querySelectorAll(".help-card");
            animateOnScroll(featureCards, "animate");
            animateOnScroll(helpCards, "animate");

            // Плавная прокрутка для якорных ссылок
            document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
                anchor.addEventListener("click", function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute("href");
                    if (targetId === "#") return;

                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: "smooth",
                        });

                        // Закрыть мобильное меню после клика
                        if (mobileMenu.classList.contains("active")) {
                            closeMenu();
                        }
                    }
                });
            });

            // Инициализация
            initModals();
            initAuth();
            initDashboard();
            initSpecialists();
            initCalendar();
            initNotifications();
            initNotes();
            initJournal();
            initBooking();
            initSpecialistAppointments();
            initBookClient();
            initScheduleChoice();
            initClientBookingModal();
            initRescheduleModal(); // Инициализация модала переноса

            // Запуск инициализации
            initializeData();
        });

        // Загрузка данных из хранилища
        function loadData() {
            specialistsData = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
            appointmentsData = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
            clientsData = Storage.get(STORAGE_KEYS.CLIENTS) || [];
            journalData = Storage.get(STORAGE_KEYS.JOURNALS) || [];
            notesData = Storage.get(STORAGE_KEYS.NOTES) || [];
            reviewsData = Storage.get(STORAGE_KEYS.REVIEWS) || [];

            // Обновляем bookings из appointmentsData
            updateBookingsFromAppointments();
        }

        // Обновление данных о бронированиях из appointmentsData
        function updateBookingsFromAppointments() {
            bookings = {};

            appointmentsData.forEach((appointment) => {
                if (
                    appointment.status !== "cancelled" &&
                    appointment.status !== "completed"
                ) {
                    const specialistId = appointment.specialistId;
                    if (!bookings[specialistId]) bookings[specialistId] = {};
                    const dateKey = `${appointment.dateYear}-${appointment.dateMonth}-${appointment.dateDay}`;
                    if (!bookings[specialistId][dateKey]) bookings[specialistId][dateKey] = {};
                    bookings[specialistId][dateKey][appointment.time] = appointment.type === "plan" ? `План: ${appointment.planTitle}` : appointment.clientName;
                }
            });
        }

        // Инициализация модальных окон
        function initModals() {
            // Открытие модальных окон
            document.getElementById("loginBtn").addEventListener("click", () => {
                openModal("loginModal");
            });

            document.getElementById("registerBtn").addEventListener("click", () => {
                openModal("registerModal");
            });

            // Закрытие модальных окон
            document.querySelectorAll(".modal-close").forEach((closeBtn) => {
                closeBtn.addEventListener("click", function () {
                    const modalId = this.getAttribute("data-modal");
                    closeModal(modalId);
                    if (modalId === "appointmentNotesChoiceModal") {
                        currentAppIdForNote = null;
                    }
                    if (modalId === "appointmentNoteModal") {
                        currentAppIdForNote = null;
                        isConducted = false;
                    }
                });
            });

            // Переключение между модальными окнами
            document.querySelectorAll(".form-link").forEach((link) => {
                link.addEventListener("click", function () {
                    const fromModal = this.getAttribute("data-from");
                    const toModal = this.getAttribute("data-to");
                    closeModal(fromModal);
                    openModal(toModal);
                });
            });

            // Выбор роли при регистрации
            document.querySelectorAll(".role-option").forEach((option) => {
                option.addEventListener("click", function () {
                    document.querySelectorAll(".role-option").forEach((opt) => {
                        opt.classList.remove("selected");
                    });
                    this.classList.add("selected");
                    document.getElementById("userRole").value =
                        this.getAttribute("data-role");
                });
            });

            // Обработка форм
            document
                .getElementById("loginForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    handleLogin();
                });

            document
                .getElementById("registerForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    handleRegistration();
                });

            // Опрос
            document.getElementById("surveyForm").addEventListener("submit", handleSurvey);

            // Оценка занятия
            // Обработчики для всех .emotion-btn в модалах (rateSession и appointmentNote)
            document.addEventListener("click", function (e) {
                if (e.target.classList.contains("emotion-btn")) {
                    e.target.classList.toggle("selected");
                }
            });

            document.getElementById("rateSessionForm").addEventListener("submit", handleRateSession);

            // Опции опроса
            document.addEventListener("click", function (e) {
                if (e.target.classList.contains("survey-option")) {
                    e.target.closest(".modal").querySelectorAll(".survey-option").forEach(opt => opt.classList.remove("selected"));
                    e.target.classList.add("selected");
                    e.target.querySelector("input").checked = true;
                }
            });

            // Проблемы и запросы в заметках
            document.addEventListener("click", function (e) {
                if (e.target.classList.contains("problem-option")) {
                    e.target.closest(".modal").querySelectorAll(".problem-option").forEach(opt => opt.classList.remove("selected"));
                    e.target.classList.add("selected");
                }
                if (e.target.classList.contains("request-option")) {
                    e.target.closest(".modal").querySelectorAll(".request-option").forEach(opt => opt.classList.remove("selected"));
                    e.target.classList.add("selected");
                }
            });

            // Эмоции в заметках (emotion-option в notesModal)
            document.addEventListener("click", function (e) {
                if (e.target.classList.contains("emotion-option")) {
                    e.target.classList.toggle("selected");
                }
            });

            // Заметки к записи - выбор
            document.getElementById("sessionNoteBtn").addEventListener("click", () => {
                isConducted = false;
                openAppointmentNoteModal(currentAppIdForNote);
                closeModal("appointmentNotesChoiceModal");
            });

            document.getElementById("conductedBtn").addEventListener("click", () => {
                isConducted = true;
                const appIndex = appointmentsData.findIndex(a => a.id == currentAppIdForNote);
                if (appIndex !== -1) {
                    appointmentsData[appIndex].status = "completed";
                    Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
                    updateBookingsFromAppointments();
                    renderAppointments();
                }
                openAppointmentNoteModal(currentAppIdForNote);
                closeModal("appointmentNotesChoiceModal");
            });

            // Форма заметки к записи
            document.getElementById("appointmentNoteForm").addEventListener("submit", (e) => {
                e.preventDefault();
                const content = document.getElementById("noteContent").value;
                const scaleInput = document.querySelector('#appointmentNoteModal input[name="noteScale"]:checked');
                const scale = scaleInput ? scaleInput.value : "";
                const app = appointmentsData.find(a => a.id == currentAppIdForNote);
                let noteDate = new Date().toLocaleDateString("ru-RU");
                let noteContent = content;
                if (app) {
                    noteDate = `${app.dateDay} ${getMonthName(app.dateMonth - 1)} ${app.dateYear}`;
                    noteContent = `Заметка к сессии с супервизором ${app.specialistName} в ${app.time} (${noteDate}): ${content}. Шкала понимания: ${scale || "Не указана"}.`;
                } else {
                    noteContent = `Заметка: ${content}. Шкала понимания: ${scale || "Не указана"}.`;
                }
                const newEntry = {
                    id: Date.now(),
                    userId: currentUser.id,
                    date: noteDate,
                    content: noteContent,
                    createdAt: new Date().toISOString(),
                };
                const journals = Storage.get(STORAGE_KEYS.JOURNALS) || [];
                journals.push(newEntry);
                Storage.set(STORAGE_KEYS.JOURNALS, journals);
                journalData = Storage.get(STORAGE_KEYS.JOURNALS) || []; // Reload global
                // Reset
                document.getElementById("noteContent").value = "";
                document.querySelectorAll("#appointmentNoteModal .survey-option").forEach(o => o.classList.remove("selected"));
                currentAppIdForNote = null;
                isConducted = false;
                closeModal("appointmentNoteModal");
                showNotification("Заметка добавлена в дневник", "success");
            });
        }

        // Открытие модального окна заметки к записи
        function openAppointmentNoteModal(appId) {
            currentAppIdForNote = appId;
            openModal("appointmentNoteModal");
        }

        // Открытие модального окна
        function openModal(modalId) {
            document.getElementById(modalId).classList.add("active");
            document.body.style.overflow = "hidden";
        }

        // Закрытие модального окна
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove("active");
            document.body.style.overflow = "auto";
        }

        // Обработка входа
        function handleLogin() {
            showLoader();

            const email = document.getElementById("loginEmail").value;
            const password = document.getElementById("loginPassword").value;
            let isValid = true;

            // Валидация email
            if (!validateEmail(email)) {
                document.getElementById("loginEmailError").classList.add("show");
                isValid = false;
            } else {
                document.getElementById("loginEmailError").classList.remove("show");
            }

            // Валидация пароля
            if (password.length < 6) {
                document.getElementById("loginPasswordError").classList.add("show");
                isValid = false;
            } else {
                document
                    .getElementById("loginPasswordError")
                    .classList.remove("show");
            }

            if (!isValid) {
                hideLoader();
                showNotification("Пожалуйста, исправьте ошибки в форме", "error");
                return;
            }

            // Поиск пользователя в базе
            const users = Storage.get(STORAGE_KEYS.USERS) || [];
            const user = users.find(
                (u) => u.email === email && u.password === password
            );

            if (!user) {
                hideLoader();
                showNotification("Неверный email или пароль", "error");
                return;
            }

            // Сохраняем текущего пользователя
            currentUser = user;
            Storage.set(STORAGE_KEYS.CURRENT_USER, user);

            // Имитация запроса к серверу
            setTimeout(() => {
                hideLoader();
                closeModal("loginModal");
                if (user.role === "client" && !user.helpNeeded) {
                    openModal("surveyModal");
                } else {
                    if (user.role === "specialist") {
                        showDashboard("specialist");
                    } else {
                        showDashboard("client");
                    }
                    showNotification("Вход выполнен успешно!", "success");
                }
            }, 500);
        }

        // Обработка регистрации
        function handleRegistration() {
            showLoader();

            const name = document.getElementById("registerName").value;
            const email = document.getElementById("registerEmail").value;
            const password = document.getElementById("registerPassword").value;
            const confirmPassword = document.getElementById(
                "registerConfirmPassword"
            ).value;
            const role = document.getElementById("userRole").value;

            let isValid = true;

            // Валидация имени
            if (name.trim() === "") {
                document.getElementById("registerNameError").classList.add("show");
                isValid = false;
            } else {
                document.getElementById("registerNameError").classList.remove("show");
            }

            // Валидация email
            if (!validateEmail(email)) {
                document.getElementById("registerEmailError").classList.add("show");
                isValid = false;
            } else {
                document
                    .getElementById("registerEmailError")
                    .classList.remove("show");
            }

            // Валидация пароля
            if (password.length < 6) {
                document
                    .getElementById("registerPasswordError")
                    .classList.add("show");
                isValid = false;
            } else {
                document
                    .getElementById("registerPasswordError")
                    .classList.remove("show");
            }

            // Проверка совпадения паролей
            if (password !== confirmPassword) {
                document
                    .getElementById("registerConfirmPasswordError")
                    .classList.add("show");
                isValid = false;
            } else {
                document
                    .getElementById("registerConfirmPasswordError")
                    .classList.remove("show");
            }

            if (!isValid) {
                hideLoader();
                showNotification("Пожалуйста, исправьте ошибки в форме", "error");
                return;
            }

            // Проверяем, нет ли уже пользователя с таким email
            const users = Storage.get(STORAGE_KEYS.USERS) || [];
            if (users.find((u) => u.email === email)) {
                hideLoader();
                showNotification(
                    "Пользователь с таким email уже существует",
                    "error"
                );
                return;
            }

            // Создаем нового пользователя
            const newUser = {
                id: Date.now(),
                name,
                email,
                password,
                role,
                phone: "",
                birthdate: "",
                photo: "",
                helpNeeded: role === "client" ? null : undefined,
            };

            users.push(newUser);
            Storage.set(STORAGE_KEYS.USERS, users);

            // Если это супервизор, создаем запись в таблице специалистов
            if (role === "specialist") {
                const specialists = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
                const newSpecialist = {
                    id: Date.now(),
                    name,
                    specialty: "Супервизия для клинических психологов",
                    experience: 0,
                    rating: 0,
                    reviews: 0,
                    price: 3000,
                    avatar:
                        "https://randomuser.me/api/portraits/" +
                        (Math.random() > 0.5 ? "men" : "women") +
                        "/" +
                        Math.floor(Math.random() * 50) +
                        ".jpg",
                    description: "Новый супервизор",
                    userId: newUser.id,
                };

                specialists.push(newSpecialist);
                Storage.set(STORAGE_KEYS.SPECIALISTS, specialists);
            }

            // Сохраняем текущего пользователя
            currentUser = newUser;
            Storage.set(STORAGE_KEYS.CURRENT_USER, newUser);

            setTimeout(() => {
                hideLoader();
                closeModal("registerModal");
                if (role === "client") {
                    openModal("surveyModal");
                } else {
                    showDashboard("specialist");
                    showNotification("Регистрация прошла успешно!", "success");
                }
            }, 500);
        }

        // Обработка опроса
        function handleSurvey(e) {
            e.preventDefault();
            const selectedOption = document.querySelector('.survey-option.selected');
            if (!selectedOption) {
                showNotification("Выберите вариант", "error");
                return;
            }
            const selectedProblem = selectedOption.querySelector('input').value;
            const users = Storage.get(STORAGE_KEYS.USERS) || [];
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex].helpNeeded = selectedProblem;
                Storage.set(STORAGE_KEYS.USERS, users);
                currentUser.helpNeeded = selectedProblem;
                Storage.set(STORAGE_KEYS.CURRENT_USER, currentUser);
            }
            closeModal("surveyModal");
            showDashboard("client");
            showNotification("Опрос завершен! Добро пожаловать в кабинет.", "success");
        }

        // Валидация email
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        // Показать/скрыть личный кабинет
        function showDashboard(type) {
            document.getElementById("main-content").style.display = "none";
            document.querySelector(".features").style.display = "none";
            document.querySelector(".help").style.display = "none";
            document.querySelector(".footer").style.display = "none";

            if (type === "client") {
                document.getElementById("clientDashboard").style.display = "block";
                document.getElementById("specialistDashboard").style.display = "none";
                document.getElementById("clientName").textContent = currentUser.name;
                document.getElementById("clientProfileName").value = currentUser.name;
                document.getElementById("clientProfileEmail").value =
                    currentUser.email;
                document.getElementById("clientProfilePhone").value =
                    currentUser.phone || "";
                document.getElementById("clientProfileBirthdate").value =
                    currentUser.birthdate || "";
                if (currentUser.photo) {
                    document.getElementById("clientPhotoPreview").src = currentUser.photo;
                    document.getElementById("clientPhotoPreview").style.display = "block";
                }
                loadUserAppointments();
                renderAppointments();
                loadUserJournal();
                renderJournal();
                renderSpecialists();
                // Проверяем новые записи (pending)
                checkForNewAppointmentsClient();
            } else {
                document.getElementById("clientDashboard").style.display = "none";
                document.getElementById("specialistDashboard").style.display = "block";
                const specialists = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
                const specialist = specialists.find(
                    (s) => s.userId === currentUser.id
                );
                if (specialist) {
                    document.getElementById("specialistName").textContent = specialist.name;
                    document.getElementById("specialistProfileName").value =
                        specialist.name;
                    document.getElementById("specialistProfileEmail").value =
                        currentUser.email;
                    document.getElementById("specialistProfileSpecialty").value =
                        specialist.specialty || "Супервизия для клинических психологов";
                    document.getElementById("specialistProfileExperience").value =
                        specialist.experience || 0;
                    document.getElementById("specialistProfileEducation").value =
                        specialist.education || "";
                    document.getElementById("specialistProfileDescription").value =
                        specialist.description || "";
                    document.getElementById("specialistProfilePrice").value =
                        specialist.price || 3000;
                    if (specialist.photo) {
                        document.getElementById("specialistPhotoPreview").src = specialist.photo;
                        document.getElementById("specialistPhotoPreview").style.display = "block";
                    }
                    if (specialist.video) {
                        document.getElementById("specialistVideoPreview").src = specialist.video;
                        document.getElementById("specialistVideoPreview").style.display = "block";
                    }
                }
                loadSpecialistClients();
                renderClients();
                renderAllAppointments();
                loadSpecialistClients();
                renderClients();
                renderCalendar();
                // Проверяем новые запросы на запись (pending)
                checkForNewAppointmentsSpecialist();
            }

            // Обновляем видимость элементов навигации
            document.querySelector(".nav-auth").style.display = "none";
            document.querySelector(".nav-logout").style.display = "flex";
            window.scrollTo(0, 0);
        }

        // Загрузка записей пользователя (global all)
        function loadUserAppointments() {
            appointmentsData = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
        }

        // Загрузка дневника пользователя (global all)
        function loadUserJournal() {
            journalData = Storage.get(STORAGE_KEYS.JOURNALS) || [];
        }

        // Проверка новых записей для клиента (pending от супервизора)
        function checkForNewAppointmentsClient() {
            const newAppointments = appointmentsData.filter(a => a.clientId === currentUser.id && a.status === "pending" && a.creatorRole === "specialist" && a.seenByClient !== true);
            if (newAppointments.length > 0) {
                newAppointments.forEach(app => {
                    showNotificationNewAppointmentClient(app);
                    app.seenByClient = true;
                });
                Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
            }
        }

        // Показ уведомления новой записи для клиента
        function showNotificationNewAppointmentClient(appointment) {
            const notification = createNewAppointmentNotification(
                appointment,
                "client",
                "Супервизор предлагает запись на сессию!"
            );
            const container = document.getElementById("notificationContainer");
            container.appendChild(notification);
            setTimeout(() => notification.classList.add("show"), 100);
            setTimeout(() => {
                notification.classList.remove("show");
                notification.classList.add("hide");
                setTimeout(() => container.removeChild(notification), 300);
            }, 7000);
        }

        // Проверка новых запросов для супервизора (pending от клиента)
        function checkForNewAppointmentsSpecialist() {
            const mySpecialist = specialistsData.find(s => s.userId === currentUser.id);
            const newRequests = appointmentsData.filter(a => a.specialistId === mySpecialist.id && a.status === "pending" && a.creatorRole === "client" && a.seenBySpecialist !== true);
            if (newRequests.length > 0) {
                newRequests.forEach(app => {
                    showNotificationNewAppointmentSpecialist(app);
                    app.seenBySpecialist = true;
                });
                Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
            }
        }

        // Показ уведомления новой записи для супервизора
        function showNotificationNewAppointmentSpecialist(appointment) {
            const notification = createNewAppointmentNotification(
                appointment,
                "specialist",
                "Клиент запрашивает запись на супервизию!"
            );
            const container = document.getElementById("notificationContainer");
            container.appendChild(notification);
            setTimeout(() => notification.classList.add("show"), 100);
            setTimeout(() => {
                notification.classList.remove("show");
                notification.classList.add("hide");
                setTimeout(() => container.removeChild(notification), 300);
            }, 7000);
        }

        // Создание уведомления новой записи
        function createNewAppointmentNotification(appointment, role, message) {
            const notification = document.createElement("div");
            notification.className = `notification new-appointment`;

            const icon = role === "specialist" ? "user-plus" : "calendar-check";
            const actionText = role === "client" ? "Записаться" : "Записать";
            const declineText = role === "client" ? "Не записываться" : "Не записывать";

            notification.innerHTML = `
          <i class="fas fa-${icon} notification-icon"></i>
          <div>
            <div class="notification-message">${message}</div>
            <div style="margin-top: 0.5rem;">
              <strong>${role === "specialist" ? appointment.clientName : appointment.specialistName}</strong> - ${appointment.dateDay}.${appointment.dateMonth}.${appointment.dateYear} ${appointment.time}
            </div>
            <div class="client-actions" style="margin-top: 0.5rem; gap: 0.5rem;">
              <button class="btn btn-register" onclick="handleAppointmentAction(${appointment.id}, 'confirm')" style="padding: 0.3rem 0.8rem; font-size: 0.8rem;">${actionText}</button>
              <button class="btn btn-login" onclick="handleAppointmentAction(${appointment.id}, 'decline')" style="padding: 0.3rem 0.8rem; font-size: 0.8rem;">${declineText}</button>
            </div>
          </div>
        `;

            return notification;
        }

        // Обработка действий с новой записью (confirm/decline)
        function handleAppointmentAction(appId, action) {
            const appIndex = appointmentsData.findIndex(a => a.id === appId);
            if (appIndex === -1) return;

            const app = appointmentsData[appIndex];
            const otherUserId = app.clientId === currentUser.id ? app.specialistId : app.clientId;
            const otherUserName = app.clientId === currentUser.id ? app.specialistName : app.clientName;

            if (action === "confirm") {
                app.status = "confirmed";
                Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
                updateBookingsFromAppointments();
                showNotification(`Запись с ${otherUserName} подтверждена`, "success");

                // Обновляем виды
                if (currentUser.role === "client") {
                    loadUserAppointments();
                    renderAppointments();
                } else {
                    renderAllAppointments();
                    renderCalendar();
                }
            } else if (action === "decline") {
                app.status = "cancelled";
                Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
                updateBookingsFromAppointments();
                showNotification(`Запись с ${otherUserName} отклонена`, "error");

                // Обновляем виды
                if (currentUser.role === "client") {
                    loadUserAppointments();
                    renderAppointments();
                } else {
                    renderAllAppointments();
                    renderCalendar();
                }
            }

            // Закрыть уведомление
            const notifications = document.querySelectorAll(".notification.new-appointment");
            notifications.forEach(n => {
                n.classList.remove("show");
                n.classList.remove("hide");
                setTimeout(() => n.remove(), 300);
            });
        }

        // Загрузка клиентов супервизора
        function loadSpecialistClients() {
            // Для упрощения будем считать, что все пользователи с ролью client - клиенты
            const users = Storage.get(STORAGE_KEYS.USERS) || [];
            clientsData = users.filter((u) => u.role === "client");

            // Добавляем информацию о записях
            const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];

            clientsData.forEach((client) => {
                const clientAppointments = appointments.filter(
                    (a) => a.clientId === client.id && a.status === "confirmed" && a.type === "client"
                ).sort((a, b) => {
                    const dateA = new Date(a.dateYear, a.dateMonth - 1, a.dateDay, parseInt(a.time.split(':')[0]), parseInt(a.time.split(':')[1]));
                    const dateB = new Date(b.dateYear, b.dateMonth - 1, b.dateDay, parseInt(b.time.split(':')[0]), parseInt(b.time.split(':')[1]));
                    return dateA - dateB;
                });
                client.nextSession =
                    clientAppointments.length > 0
                        ? formatAppointmentDate(clientAppointments[0])
                        : "Нет запланированных сессий";

                // Загружаем заметки для клиента
                client.notes = notesData.filter((n) => n.clientId === client.id);
            });
        }

        // Форматирование даты записи
        function formatAppointmentDate(appointment) {
            const months = [
                "января",
                "февраля",
                "марта",
                "апреля",
                "мая",
                "июня",
                "июля",
                "августа",
                "сентября",
                "октября",
                "ноября",
                "декабря",
            ];
            return `${appointment.dateDay} ${months[appointment.dateMonth - 1]} ${appointment.dateYear
                }, ${appointment.time}`;
        }

        // Инициализация личного кабинета
        function initAuth() {
            // Выход из системы
            document.getElementById("navLogoutBtn").addEventListener("click", function () {
                logout();
            });

            // Переключение вкладок в кабинете клиента
            document
                .querySelectorAll("#clientDashboard .tab-btn")
                .forEach((btn) => {
                    btn.addEventListener("click", function () {
                        const tabId = this.getAttribute("data-tab");
                        switchClientTab(tabId);
                    });
                });

            // Переключение вкладок в кабинете супервизора
            document
                .querySelectorAll("#specialistDashboard .tab-btn")
                .forEach((btn) => {
                    btn.addEventListener("click", function () {
                        const tabId = this.getAttribute("data-tab");
                        switchSpecialistTab(tabId);
                    });
                });

            // Сохранение профиля клиента
            document
                .getElementById("clientProfileForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    saveClientProfile();
                });

            // Сохранение профиля супервизора
            document
                .getElementById("specialistProfileForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    saveSpecialistProfile();
                });

            // Добавление клиента
            document
                .getElementById("addClientForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    addClient();
                });

            // Фото клиента
            document.getElementById("clientProfilePhoto").addEventListener("change", handleClientPhotoUpload);

            // Фото и видео супервизора
            document.getElementById("specialistProfilePhoto").addEventListener("change", handleSpecialistPhotoUpload);
            document.getElementById("specialistProfileVideo").addEventListener("change", handleSpecialistVideoUpload);
        }

        // Сохранение профиля клиента
        function saveClientProfile() {
            showLoader();

            const name = document.getElementById("clientProfileName").value;
            const phone = document.getElementById("clientProfilePhone").value;
            const birthdate = document.getElementById(
                "clientProfileBirthdate"
            ).value;

            // Обновляем данные пользователя
            const users = Storage.get(STORAGE_KEYS.USERS) || [];
            const userIndex = users.findIndex((u) => u.id === currentUser.id);

            if (userIndex !== -1) {
                users[userIndex].name = name;
                users[userIndex].phone = phone;
                users[userIndex].birthdate = birthdate;
                users[userIndex].photo = currentUser.photo;

                Storage.set(STORAGE_KEYS.USERS, users);

                // Обновляем текущего пользователя
                currentUser = users[userIndex];
                Storage.set(STORAGE_KEYS.CURRENT_USER, currentUser);

                document.getElementById("clientName").textContent = name;
            }

            setTimeout(() => {
                hideLoader();
                showNotification("Профиль успешно обновлен", "success");
            }, 500);
        }

        // Сохранение профиля супервизора
        function saveSpecialistProfile() {
            showLoader();

            const name = document.getElementById("specialistProfileName").value;
            const specialty = document.getElementById(
                "specialistProfileSpecialty"
            ).value;
            const experience = document.getElementById(
                "specialistProfileExperience"
            ).value;
            const education = document.getElementById(
                "specialistProfileEducation"
            ).value;
            const description = document.getElementById(
                "specialistProfileDescription"
            ).value;
            const price = document.getElementById("specialistProfilePrice").value;

            // Обновляем данные пользователя
            const users = Storage.get(STORAGE_KEYS.USERS) || [];
            const userIndex = users.findIndex((u) => u.id === currentUser.id);

            if (userIndex !== -1) {
                users[userIndex].name = name;
                Storage.set(STORAGE_KEYS.USERS, users);

                // Обновляем текущего пользователя
                currentUser = users[userIndex];
                Storage.set(STORAGE_KEYS.CURRENT_USER, currentUser);

                document.getElementById("specialistName").textContent = name;
            }

            // Обновляем данные супервизора
            const specialists = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
            const specialistIndex = specialists.findIndex(
                (s) => s.userId === currentUser.id
            );

            if (specialistIndex !== -1) {
                specialists[specialistIndex].name = name;
                specialists[specialistIndex].specialty = specialty;
                specialists[specialistIndex].experience = experience;
                specialists[specialistIndex].education = education;
                specialists[specialistIndex].description = description;
                specialists[specialistIndex].price = price;

                Storage.set(STORAGE_KEYS.SPECIALISTS, specialists);
            }

            setTimeout(() => {
                hideLoader();
                showNotification("Профиль успешно обновлен", "success");
            }, 500);
        }

        // Добавление клиента
        function addClient() {
            showLoader();

            const firstName = document.getElementById("clientFirstName").value;
            const lastName = document.getElementById("clientLastName").value;
            const email = document.getElementById("clientEmail").value;
            const phone = document.getElementById("clientPhone").value;
            const birthdate = document.getElementById("clientBirthdate").value;
            const notes = document.getElementById("clientNotes").value;

            // Создаем нового пользователя (клиента)
            const users = Storage.get(STORAGE_KEYS.USERS) || [];
            const newUser = {
                id: Date.now(),
                name: `${firstName} ${lastName}`,
                email: email || `client${Date.now()}@example.com`,
                password: "tempPassword", // Корректировка: В реальном приложении нужно генерировать временный пароль
                role: "client",
                phone: phone,
                birthdate: birthdate,
                photo: "",
                helpNeeded: "Не указано",
            };

            users.push(newUser);
            Storage.set(STORAGE_KEYS.USERS, users);

            // Добавляем клиента в список клиентов супервизора
            const clients = Storage.get(STORAGE_KEYS.CLIENTS) || [];
            clients.push({
                id: newUser.id,
                specialistId: currentUser.id,
                notes: notes,
            });

            Storage.set(STORAGE_KEYS.CLIENTS, clients);

            setTimeout(() => {
                hideLoader();
                document.getElementById("addClientForm").reset();
                showNotification("Клиент успешно добавлен", "success");

                // Обновляем список клиентов
                loadSpecialistClients();
                renderClients();
            }, 500);
        }

        // Выход из системы
        function logout() {
            showLoader();

            setTimeout(() => {
                hideLoader();

                // Удаляем текущего пользователя
                currentUser = null;
                Storage.remove(STORAGE_KEYS.CURRENT_USER);

                // Скрыть личные кабинеты
                document.getElementById("clientDashboard").style.display = "none";
                document.getElementById("specialistDashboard").style.display = "none";

                // Показать основное содержимое
                document.getElementById("main-content").style.display = "flex";
                document.querySelector(".features").style.display = "block";
                document.querySelector(".help").style.display = "block";
                document.querySelector(".footer").style.display = "block";

                // Обновляем navbar: показываем menu и auth, скрываем logout
                document.querySelector(".nav-auth").style.display = "flex";
                document.querySelector(".nav-logout").style.display = "none";

                showNotification("Вы вышли из системы", "info");
            }, 500);
        }

        // Переключение вкладок в кабинете клиента
        function switchClientTab(tabId) {
            // Деактивировать все кнопки
            document
                .querySelectorAll("#clientDashboard .tab-btn")
                .forEach((btn) => {
                    btn.classList.remove("active");
                });

            // Скрыть все вкладки
            document
                .querySelectorAll("#clientDashboard .tab-content")
                .forEach((tab) => {
                    tab.classList.remove("active");
                });

            // Активировать выбранную кнопку
            const activeBtn = document.querySelector(
                `#clientDashboard .tab-btn[data-tab="${tabId}"]`
            );
            if (activeBtn) activeBtn.classList.add("active");

            // Показать выбранную вкладку
            document.getElementById(`${tabId}Tab`).classList.add("active");

            if (tabId === "journal") {
                loadUserJournal();
                renderJournal();
            } else if (tabId === "appointments") {
                loadUserAppointments();
                renderAppointments();
                checkForNewAppointmentsClient();
            } else if (tabId === "search") {
                renderSpecialists();
            }
        }

        // Переключение вкладок в кабинете супервизора
        function switchSpecialistTab(tabId) {
            // Деактивировать все кнопки
            document
                .querySelectorAll("#specialistDashboard .tab-btn")
                .forEach((btn) => {
                    btn.classList.remove("active");
                });

            // Скрыть все вкладки
            document
                .querySelectorAll("#specialistDashboard .tab-content")
                .forEach((tab) => {
                    tab.classList.remove("active");
                });

            // Активировать выбранную кнопку
            const activeBtn = document.querySelector(
                `#specialistDashboard .tab-btn[data-tab="${tabId}"]`
            );
            if (activeBtn) activeBtn.classList.add("active");

            // Показать выбранную вкладку
            document.getElementById(`${tabId}Tab`).classList.add("active");

            if (tabId === "schedule") {
                renderCalendar();
            } else if (tabId === "clients") {
                loadSpecialistClients();
                renderClients();
            } else if (tabId === "allAppointments") {
                renderAllAppointments();
                checkForNewAppointmentsSpecialist();
            }
        }

        // Инициализация раздела с супервизорами
        function initSpecialists() {
            renderSpecialists();

            // Применение фильтров
            document
                .getElementById("applyFilters")
                .addEventListener("click", function () {
                    renderSpecialists();
                });

            // Обработка обзора супервизора
            document
                .getElementById("specialistsContainer")
                .addEventListener("click", function (e) {
                    if (e.target.classList.contains("btn-register")) {
                        const card = e.target.closest(".specialist-card");
                        const specialistId = card.getAttribute("data-id");
                        openSpecialistFullProfileModal(specialistId);
                    }
                });
        }

        // Открытие полного профиля супервизора в кабинете клиента
        function openSpecialistFullProfileModal(specialistId) {
            const specialist = specialistsData.find(s => s.id == specialistId);
            if (!specialist) return;

            const specialistReviews = reviewsData.filter(r => r.specialistId == specialistId);

            let reviewsHTML = "";
            if (specialistReviews.length > 0) {
                reviewsHTML = specialistReviews.map(review => `
                  <div class="review-entry">
                    <div class="review-rating">${getRatingStars(review.rating)}</div>
                    <p>${review.comment}</p>
                    <p><small>${review.date}</small></p>
                  </div>
                `).join("");
            } else {
                reviewsHTML = "<p>Отзывов пока нет.</p>";
            }

            const hasCompletedSession = appointmentsData.some(a => a.specialistId == specialistId && a.clientId == currentUser.id && a.status == "completed");

            let reviewFormHTML = "";
            if (hasCompletedSession) {
                reviewFormHTML = `
                  <form class="review-form" id="specialistReviewForm" data-specialist-id="${specialistId}">
                    <div class="form-group">
                      <label class="form-label">Ваш рейтинг</label>
                      <div class="star-rating">
                        <input type="radio" id="star5" name="rating" value="5" /><label for="star5"><i class="fas fa-star"></i></label>
                        <input type="radio" id="star4" name="rating" value="4" /><label for="star4"><i class="fas fa-star"></i></label>
                        <input type="radio" id="star3" name="rating" value="3" /><label for="star3"><i class="fas fa-star"></i></label>
                        <input type="radio" id="star2" name="rating" value="2" /><label for="star2"><i class="fas fa-star"></i></label>
                        <input type="radio" id="star1" name="rating" value="1" /><label for="star1"><i class="fas fa-star"></i></label>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label" for="reviewComment">Комментарий</label>
                      <textarea id="reviewComment" class="form-input" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-register">Оставить отзыв</button>
                  </form>
                `;
            } else {
                reviewFormHTML = "<p>Вы можете оставить отзыв после завершенной сессии.</p>";
            }

            document.getElementById("specialistDetailTitle").textContent = `Профиль: ${specialist.name}`;
            const content = document.getElementById("specialistFullProfileContent");
            content.innerHTML = `
          <div class="profile-section">
            <h4><i class="fas fa-user"></i> Основная информация</h4>
            <img src="${specialist.avatar || specialist.photo || 'https://randomuser.me/api/portraits/default.jpg'}" alt="${specialist.name
            }" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; margin: 1rem 0;">
            <p><strong>Имя и фамилия:</strong> ${specialist.name}</p>
            <p><strong>Специализация:</strong> ${specialist.specialty || "Не указана"}</p>
            <p><strong>Опыт работы (лет):</strong> ${specialist.experience || 0}</p>
            <p><strong>Рейтинг:</strong> ${specialist.rating || 0} (${specialist.reviews || 0} отзывов)</p>
          </div>
          <div class="profile-section">
            <h4><i class="fas fa-book"></i> Образование</h4>
            <p>${specialist.education || "Не указано"}</p>
          </div>
          <div class="profile-section">
            <h4><i class="fas fa-info-circle"></i> О себе</h4>
            <p>${specialist.description || "Не указано"}</p>
          </div>
          <div class="profile-section">
            <h4><i class="fas fa-ruble-sign"></i> Цена за сессию</h4>
            <p><strong>${specialist.price || 0} руб.</strong></p>
          </div>
          ${specialist.video ? `
          <div class="profile-section video-section">
            <h4><i class="fas fa-video"></i> Видео профиля</h4>
            <video src="${specialist.video}" class="video-preview" controls></video>
          </div>
          ` : ''}
          <div class="profile-section review-section">
            <h4><i class="fas fa-star"></i> Отзывы</h4>
            ${reviewsHTML}
            ${reviewFormHTML}
          </div>
          <div class="client-actions" style="margin-top: 2rem; text-align: center;">
            <button class="btn btn-register" onclick="handleSpecialistBooking(${specialistId})" style="width: 100%; max-width: 300px;">Записаться на супервизию</button>
          </div>
        `;

            // Обработчик формы отзыва
            if (hasCompletedSession) {
                document.getElementById("specialistReviewForm").addEventListener("submit", handleSubmitReview);
            }

            openModal("specialistDetailModal");
        }

        // Обработка отправки отзыва
        function handleSubmitReview(e) {
            e.preventDefault();
            const form = e.target;
            const specialistId = form.getAttribute("data-specialist-id");
            const rating = form.querySelector('input[name="rating"]:checked')?.value;
            const comment = form.querySelector("#reviewComment").value.trim();

            if (!rating || !comment) {
                showNotification("Заполните рейтинг и комментарий", "error");
                return;
            }

            // Создаем новый отзыв
            const newReview = {
                id: Date.now(),
                specialistId: parseInt(specialistId),
                clientId: currentUser.id,
                rating: parseInt(rating),
                comment,
                date: new Date().toLocaleDateString("ru-RU"),
            };

            // Сохраняем отзыв
            reviewsData.push(newReview);
            Storage.set(STORAGE_KEYS.REVIEWS, reviewsData);

            // Обновляем рейтинг супервизора
            updateSpecialistRating(specialistId);

            // Перезагружаем профиль
            closeModal("specialistDetailModal");
            openSpecialistFullProfileModal(specialistId);

            showNotification("Отзыв оставлен!", "success");
        }

        // Обновление среднего рейтинга супервизора
        function updateSpecialistRating(specialistId) {
            const specialistReviews = reviewsData.filter(r => r.specialistId == specialistId);
            if (specialistReviews.length > 0) {
                const totalRating = specialistReviews.reduce((sum, r) => sum + r.rating, 0);
                const averageRating = (totalRating / specialistReviews.length).toFixed(1);
                const specialistIndex = specialistsData.findIndex(s => s.id == specialistId);
                if (specialistIndex !== -1) {
                    specialistsData[specialistIndex].rating = parseFloat(averageRating);
                    specialistsData[specialistIndex].reviews = specialistReviews.length;
                    Storage.set(STORAGE_KEYS.SPECIALISTS, specialistsData);
                }
            }
        }

        // Обработка записи из профиля супервизора
        function handleSpecialistBooking(specialistId) {
            closeModal("specialistDetailModal");
            openClientBookingModal(specialistId);
        }

        // Отображение супервизоров
        function renderSpecialists() {
            const container = document.getElementById("specialistsContainer");
            container.innerHTML = "";

            const specialtyFilter =
                document.getElementById("specialtyFilter").value;
            const priceFilter = document.getElementById("priceFilter").value;
            const ratingFilter = document.getElementById("ratingFilter").value;
            const searchQuery = document
                .getElementById("searchInput")
                .value.toLowerCase();

            const filteredSpecialists = specialistsData.filter((specialist) => {
                // Фильтр по специальной
                if (specialtyFilter && specialist.specialty !== specialtyFilter) {
                    return false;
                }

                // Фильтр по цене
                if (priceFilter) {
                    const priceRange = priceFilter.split("-");
                    const min = parseInt(priceRange[0]) || 0;

                    if (priceRange[1]) {
                        const max = parseInt(priceRange[1]) || Infinity;
                        if (specialist.price < min || specialist.price > max) {
                            return false;
                        }
                    } else if (specialist.price < min) {
                        return false;
                    }
                }

                // Фильтр по рейтингу
                if (ratingFilter) {
                    const minRating = parseFloat(ratingFilter);
                    if (specialist.rating < minRating) {
                        return false;
                    }
                }

                // Поиск по имени
                if (
                    searchQuery &&
                    !specialist.name.toLowerCase().includes(searchQuery)
                ) {
                    return false;
                }

                return true;
            });

            if (filteredSpecialists.length === 0) {
                container.innerHTML =
                    '<p class="no-results">Супервизоры не найдены. Попробуйте изменить параметры фильтрации.</p>';
                return;
            }

            filteredSpecialists.forEach((specialist) => {
                const card = document.createElement("div");
                card.className = "specialist-card";
                card.setAttribute("data-id", specialist.id);

                card.innerHTML = `
                    <div class="specialist-header">
                        <img src="${specialist.avatar || specialist.photo || 'https://randomuser.me/api/portraits/default.jpg'}" alt="${specialist.name
                    }" class="specialist-avatar">
                        <h3 class="specialist-name">${specialist.name}</h3>
                        <p class="specialist-specialty">${specialist.specialty
                    }</p>
                    </div>
                    <div class="specialist-body">
                        <div class="specialist-info">
                            <div class="specialist-rating">
                                <span class="rating-stars">${getRatingStars(
                        specialist.rating
                    )}</span>
                                <span>${specialist.rating} (${specialist.reviews
                    } отзывов)</span>
                            </div>
                            <p>Опыт работы: ${specialist.experience} лет</p>
                            <p class="specialist-price">${specialist.price
                    } руб. / сессия</p>
                        </div>
                        <p>${specialist.description}</p>
                    </div>
                    <div class="specialist-footer">
                        <button class="btn btn-register" style="width: 100%">Записаться на супервизию</button>
                    </div>
                `;

                container.appendChild(card);
            });
        }

        // Получение HTML для звезд рейтинга
        function getRatingStars(rating) {
            let stars = "";
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;

            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star"></i>';
            }

            if (hasHalfStar) {
                stars += '<i class="fas fa-star-half-alt"></i>';
            }

            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star"></i>';
            }

            return stars;
        }

        // Инициализация системы бронирования
        function initBooking() {
            // Обработка формы бронирования
            document
                .getElementById("bookingForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    confirmBooking();
                });
        }

        // Подтверждение бронирования
        function confirmBooking() {
            showLoader();

            const summaryElement = document.getElementById("bookingSummary");
            const appId = summaryElement.getAttribute("data-app-id");
            const specialistId = summaryElement.getAttribute("data-specialist-id");
            const day = summaryElement.getAttribute("data-day");
            const time = summaryElement.getAttribute("data-time");
            const month = summaryElement.getAttribute("data-month");
            const year = summaryElement.getAttribute("data-year");
            const notes = document.getElementById("bookingNotes").value;

            const specialist = specialistsData.find((s) => s.id == specialistId);
            if (!specialist) return;

            if (appId) {
                // Обновление существующей записи (перенос)
                const index = appointmentsData.findIndex(a => a.id == appId);
                if (index !== -1) {
                    appointmentsData[index].dateDay = parseInt(day);
                    appointmentsData[index].dateMonth = parseInt(month);
                    appointmentsData[index].dateYear = parseInt(year);
                    appointmentsData[index].time = time;
                    appointmentsData[index].notes = notes;
                    appointmentsData[index].status = "pending"; // Ожидает подтверждения после переноса

                    Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
                    updateBookingsFromAppointments();

                    closeModal("bookingModal");
                    showNotification("Перенос записи отправлен! Ожидайте подтверждения от супервизора.", "success");
                    renderAppointments();
                }
            } else {
                // Создание новой записи
                const newAppointment = {
                    id: Date.now(),
                    type: "client",
                    clientId: currentUser.id,
                    clientName: currentUser.name,
                    specialistId: specialistId,
                    specialistName: specialist.name,
                    dateDay: parseInt(day),
                    dateMonth: parseInt(month),
                    dateYear: parseInt(year),
                    time: time,
                    status: "pending",
                    creatorRole: "client",
                    notes: notes,
                    createdAt: new Date().toISOString(),
                    seenBySpecialist: false,
                };

                // Сохраняем запись
                const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
                appointments.push(newAppointment);
                Storage.set(STORAGE_KEYS.APPOINTMENTS, appointments);

                // Обновляем данные
                appointmentsData = Storage.get(STORAGE_KEYS.APPOINTMENTS) || []; // Reload global
                updateBookingsFromAppointments();

                closeModal("bookingModal");
                showNotification(
                    "Запрос на запись отправлен! Ожидайте подтверждения от супервизора.",
                    "success"
                );

                // Обновляем календарь
                renderCalendar();
                renderTimeSlots(day);

                // Уведомляем супервизора (симуляция, в реальности - push или email)
                setTimeout(() => {
                    showNotification("Супервизор уведомлен о вашем запросе", "info");
                }, 1000);
            }

            hideLoader();
        }

        // Получение названия месяца
        function getMonthName(monthIndex) {
            const months = [
                "января",
                "февраля",
                "марта",
                "апреля",
                "мая",
                "июня",
                "июля",
                "августа",
                "сентября",
                "октября",
                "ноября",
                "декабря",
            ];
            return months[monthIndex];
        }

        // Инициализация календаря
        function initCalendar() {
            document
                .getElementById("prevMonth")
                .addEventListener("click", function () {
                    currentMonth--;
                    if (currentMonth < 0) {
                        currentMonth = 11;
                        currentYear--;
                    }
                    renderCalendar();
                });

            document
                .getElementById("nextMonth")
                .addEventListener("click", function () {
                    currentMonth++;
                    if (currentMonth > 11) {
                        currentMonth = 0;
                        currentYear++;
                    }
                    renderCalendar();
                });

            // Выбор дня
            document
                .getElementById("calendarDays")
                .addEventListener("click", function (e) {
                    if (
                        e.target.classList.contains("calendar-day") &&
                        !e.target.classList.contains("disabled")
                    ) {
                        document
                            .querySelectorAll(".calendar-day")
                            .forEach((day) => day.classList.remove("selected"));
                        e.target.classList.add("selected");
                        renderTimeSlots(e.target.textContent);
                    }
                });

            // Выбор слота
            document
                .getElementById("timeSlotsContainer")
                .addEventListener("click", function (e) {
                    if (
                        e.target.classList.contains("time-slot")
                    ) {
                        if (e.target.classList.contains("booked")) {
                            // Переключаемся на вкладку со всеми записями
                            switchSpecialistTab("allAppointments");
                        } else {
                            document
                                .querySelectorAll(".time-slot")
                                .forEach((slot) => slot.classList.remove("selected"));
                            e.target.classList.add("selected");

                            // Получаем день
                            const selectedDayElement = document.querySelector(".calendar-day.selected");
                            if (selectedDayElement) {
                                const day = selectedDayElement.textContent;
                                const time = e.target.textContent;
                                openScheduleChoiceModal(day, time);
                            }
                        }
                    }
                });

            // Сохранение расписания
            document
                .getElementById("saveSchedule")
                .addEventListener("click", function () {
                    showLoader();

                    setTimeout(() => {
                        hideLoader();
                        showNotification("Расписание успешно сохранено", "success");
                    }, 500);
                });

            renderCalendar();
        }

        function openScheduleChoiceModal(day, time) {
            document.getElementById("scheduleChoiceModal").setAttribute("data-day", day);
            document.getElementById("scheduleChoiceModal").setAttribute("data-time", time);
            openModal("scheduleChoiceModal");
        }

        // Отображение календаря
        function renderCalendar() {
            const calendarDays = document.getElementById("calendarDays");
            calendarDays.innerHTML = "";

            const monthNames = [
                "Январь",
                "Февраль",
                "Март",
                "Апрель",
                "Май",
                "Июнь",
                "Июль",
                "Август",
                "Сентябрь",
                "Октябрь",
                "Ноябрь",
                "Декабрь",
            ];
            document.getElementById(
                "calendarMonth"
            ).textContent = `${monthNames[currentMonth]} ${currentYear}`;

            // Заголовки дней недели
            const daysOfWeek = ["Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"];
            daysOfWeek.forEach((day) => {
                const dayElement = document.createElement("div");
                dayElement.className = "calendar-day";
                dayElement.textContent = day;
                dayElement.style.fontWeight = "bold";
                calendarDays.appendChild(dayElement);
            });

            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1; // Корректировка для отображения понедельника первым
            const daysInMonth = new Date(
                currentYear,
                currentMonth + 1,
                0
            ).getDate();

            // Пустые ячейки для дней предыдущего месяца
            for (let i = 0; i < adjustedFirstDay; i++) {
                const emptyDay = document.createElement("div");
                emptyDay.className = "calendar-day disabled";
                calendarDays.appendChild(emptyDay);
            }

            const specialist = specialistsData.find(s => s.userId === currentUser.id);
            const specialistId = specialist ? specialist.id : null;

            // Дни текущего месяца
            for (let i = 1; i <= daysInMonth; i++) {
                const dayElement = document.createElement("div");
                dayElement.className = "calendar-day";
                dayElement.textContent = i;

                // Проверяем, есть ли бронирования на этот день
                const dateKey = `${currentYear}-${currentMonth + 1}-${i}`;
                if (specialistId && bookings[specialistId] && bookings[specialistId][dateKey]) {
                    dayElement.classList.add("has-bookings");
                }

                // Проверяем, является ли день прошедшим
                const currentDate = new Date();
                const cellDate = new Date(currentYear, currentMonth, i);
                if (
                    cellDate < currentDate &&
                    cellDate.getDate() !== currentDate.getDate()
                ) {
                    dayElement.classList.add("disabled");
                }

                calendarDays.appendChild(dayElement);
            }

            renderTimeSlots();
        }

        // Отображение временных слотов
        function renderTimeSlots(selectedDay = null) {
            const timeSlotsContainer =
                document.getElementById("timeSlotsContainer");
            timeSlotsContainer.innerHTML = "";

            if (!selectedDay) {
                timeSlotsContainer.innerHTML =
                    "<p style='text-align: center; color: var(--text-light);'></p>";
                return;
            }

            const timeSlots = [
                "09:00",
                "10:00",
                "11:00",
                "12:00",
                "13:00",
                "14:00",
                "15:00",
                "16:00",
                "17:00",
                "18:00",
            ];

            const specialist = specialistsData.find(s => s.userId === currentUser.id);
            const specialistId = specialist ? specialist.id : null;

            timeSlots.forEach((slot, index) => {
                const slotElement = document.createElement("div");
                slotElement.className = "time-slot";
                slotElement.textContent = slot;
                slotElement.style.animationDelay = `${index * 0.1}s`;

                const dateKey = `${currentYear}-${currentMonth + 1}-${selectedDay}`;
                if (specialistId && bookings[specialistId] && bookings[specialistId][dateKey] && bookings[specialistId][dateKey][slot]) {
                    slotElement.classList.add("booked");
                    slotElement.setAttribute("data-client", bookings[specialistId][dateKey][slot]);
                }

                timeSlotsContainer.appendChild(slotElement);
            });
        }

        // Инициализация уведомлений
        function initNotifications() {
            // Код уже реализован в функциях showNotification, createNotification
        }

        // Показать уведомление
        function showNotification(message, type = "info") {
            const notification = createNotification(message, type);
            const container = document.getElementById("notificationContainer");

            container.appendChild(notification);

            // Показать уведомление
            setTimeout(() => {
                notification.classList.add("show");
            }, 100);

            // Скрыть уведомление через 5 секунд
            setTimeout(() => {
                notification.classList.remove("show");
                notification.classList.add("hide");

                // Удалить уведомление из DOM после анимации
                setTimeout(() => {
                    if (notification.parentNode) {
                        container.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Создание элемента уведомления
        function createNotification(message, type) {
            const notification = document.createElement("div");
            notification.className = `notification ${type}`;

            let icon = "info-circle";
            if (type === "success") icon = "check-circle";
            if (type === "error") icon = "exclamation-circle";

            notification.innerHTML = `
                <i class="fas fa-${icon} notification-icon"></i>
                <div class="notification-message">${message}</div>
            `;

            return notification;
        }

        // Показать индикатор загрузки
        function showLoader() {
            document.getElementById("loaderOverlay").classList.add("active");
        }

        // Скрыть индикатор загрузки
        function hideLoader() {
            document.getElementById("loaderOverlay").classList.remove("active");
        }

        // Инициализация дашборда
        function initDashboard() {
            // Загрузка данных клиентов для супервизора
            renderClients();

            // Загрузка записей для клиента
            renderAppointments();

            // Обработка клика по карточке клиента (открытие модала полного профиля)
            document.getElementById("clientsContainer").addEventListener("click", function (e) {
                if (e.target.closest(".client-card")) {
                    const clientId = e.target.closest(".client-card").getAttribute("data-client-id");
                    openClientFullProfileModal(clientId);
                }
            });

            // Обработка кнопок в записях клиента
            document.getElementById("appointmentsContainer").addEventListener("click", function (e) {
                if (e.target.classList.contains("cancel-btn")) {
                    const appId = e.target.getAttribute("data-app-id");
                    cancelAppointment(appId);
                } else if (e.target.classList.contains("reschedule-btn")) {
                    const appId = e.target.getAttribute("data-app-id");
                    rescheduleAppointment(appId);
                } else if (e.target.classList.contains("notes-btn")) {
                    const appId = e.target.getAttribute("data-app-id");
                    currentAppIdForNote = appId;
                    openModal("appointmentNotesChoiceModal");
                } else if (e.target.classList.contains("confirm-btn")) {
                    const appId = e.target.getAttribute("data-app-id");
                    handleAppointmentAction(appId, 'confirm');
                } else if (e.target.classList.contains("decline-btn")) {
                    const appId = e.target.getAttribute("data-app-id");
                    handleAppointmentAction(appId, 'decline');
                }
            });

            // Обработка кнопок в записях супервизора
            document.getElementById("allAppointmentsContainer").addEventListener("click", function (e) {
                if (e.target.tagName === "BUTTON") {
                    const appId = e.target.getAttribute("data-app-id");
                    const appIndex = appointmentsData.findIndex(a => a.id == appId);
                    if (appIndex !== -1) {
                        if (e.target.textContent === "Подтвердить") {
                            handleAppointmentAction(appId, 'confirm');
                        } else if (e.target.textContent === "Отклонить") {
                            handleAppointmentAction(appId, 'decline');
                        } else if (e.target.textContent === "Отменить") {
                            if (appointmentsData[appIndex].status === "pending") {
                                handleAppointmentAction(appId, 'decline');
                            } else {
                                cancelAppointment(appId);
                            }
                        } else if (e.target.textContent === "Перенести") {
                            openRescheduleModal(appId);
                            return;
                        } else if (e.target.textContent === "Сессия проведена") {
                            completeAppointment(appId);
                        }
                        Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
                        updateBookingsFromAppointments();
                        renderAllAppointments();
                        renderCalendar(); // Обновляем календарь после отмены
                    }
                }
            });
        }

        // Открытие полного профиля клиента в модале
        function openClientFullProfileModal(clientId) {
            const client = clientsData.find(c => c.id == clientId);
            if (!client) return;

            document.getElementById("clientDetailTitle").textContent = `Профиль клиента`;
            const content = document.getElementById("clientFullProfileContent");
            content.innerHTML = `
          <div class="client-info-grid">
            <div class="profile-section">
              <h4><i class="fas fa-user"></i> Основная информация</h4>
              <img src="${client.photo || 'https://randomuser.me/api/portraits/default.jpg'}" alt="${client.name}" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; margin: 1rem 0;">
              <p><strong>Имя:</strong> ${client.name}</p>
              <p><strong>Email:</strong> ${client.email}</p>
              <p><strong>Телефон:</strong> ${client.phone || "Не указан"}</p>
              <p><strong>Дата рождения:</strong> ${client.birthdate || "Не указана"}</p>
            </div>
            <div class="profile-section">
              <h4><i class="fas fa-exclamation-triangle"></i> Проблема / Запрос</h4>
              <p class="client-problem"><strong>Нужная помощь:</strong> ${client.helpNeeded || "Не указано"}</p>
            </div>
            <div class="profile-section">
              <h4><i class="fas fa-calendar-check"></i> Следующая сессия</h4>
              <p><strong>Дата и время:</strong> ${client.nextSession}</p>
            </div>
          </div>
          <div class="profile-section notes-section">
            <h4><i class="fas fa-notes-medical"></i> Заметки (${client.notes.length})</h4>
            ${client.notes.length > 0 ? client.notes.map(note => `
              <div class="note-entry" data-note-id="${note.id}">
                <div class="note-date">${note.date}</div>
                <div class="note-content">${note.content}</div>
                <p><strong>Проблема:</strong> ${note.problemCameWith || "Не указано"}</p>
                <p><strong>Запрос:</strong> ${note.revealedRequest || "Не указано"}</p>
                <div class="note-actions">
                  <button class="note-edit-btn" onclick="editNote(${note.id})">Редактировать</button>
                  <button class="note-delete-btn" onclick="deleteNote(${note.id})">Удалить</button>
                </div>
              </div>
            `).join("") : "<p>Заметок пока нет.</p>"}
          </div>
          <div class="client-actions">
            <button class="btn btn-register" onclick="openBookClientModal(${client.id})">Записать на сессию</button>
            <button class="btn btn-login" onclick="openNotesModal(${client.id})">Добавить заметку</button>
          </div>
        `;
            openModal("clientDetailModal");
        }

        // Редактирование заметки
        function editNote(noteId) {
            const note = notesData.find(n => n.id == noteId);
            if (note) {
                const noteEntry = document.querySelector(`.note-entry[data-note-id="${noteId}"]`);
                const contentDiv = noteEntry.querySelector(".note-content");
                const problemP = noteEntry.querySelector("p strong:contains('Проблема:')").parentNode;
                const requestP = noteEntry.querySelector("p strong:contains('Запрос:')").parentNode;

                // Заменяем на поля ввода
                contentDiv.innerHTML = `<textarea class="edit-note-content">${note.content}</textarea>`;
                problemP.innerHTML = `<input type="text" class="edit-note-problem" value="${note.problemCameWith || ''}">`;
                requestP.innerHTML = `<input type="text" class="edit-note-request" value="${note.revealedRequest || ''}">`;

                // Изменяем кнопки
                const actions = noteEntry.querySelector(".note-actions");
                actions.innerHTML = `
                  <button class="note-save-btn" onclick="saveEditedNote(${noteId})">Сохранить</button>
                  <button class="note-cancel-btn" onclick="cancelEditNote(${noteId})">Отмена</button>
                `;
            }
        }

        // Сохранение отредактированной заметки
        function saveEditedNote(noteId) {
            const noteEntry = document.querySelector(`.note-entry[data-note-id="${noteId}"]`);
            const newContent = noteEntry.querySelector(".edit-note-content").value;
            const newProblem = noteEntry.querySelector(".edit-note-problem").value;
            const newRequest = noteEntry.querySelector(".edit-note-request").value;

            const noteIndex = notesData.findIndex(n => n.id == noteId);
            if (noteIndex !== -1) {
                notesData[noteIndex].content = newContent;
                notesData[noteIndex].problemCameWith = newProblem;
                notesData[noteIndex].revealedRequest = newRequest;
                Storage.set(STORAGE_KEYS.NOTES, notesData);

                // Обновляем модал
                const clientId = document.getElementById("notesForm").getAttribute("data-client-id");
                renderNotes(clientId);
                showNotification("Заметка обновлена", "success");
            }
        }

        // Отмена редактирования заметки
        function cancelEditNote(noteId) {
            const clientId = document.getElementById("notesForm").getAttribute("data-client-id");
            renderNotes(clientId);
        }

        // Удаление заметки
        function deleteNote(noteId) {
            if (confirm("Удалить заметку?")) {
                notesData = notesData.filter(n => n.id != noteId);
                Storage.set(STORAGE_KEYS.NOTES, notesData);

                const clientId = document.getElementById("notesForm").getAttribute("data-client-id");
                renderNotes(clientId);
                showNotification("Заметка удалена", "success");
            }
        }

        // Открытие оценки сессии
        function openRateSessionModal(appId) {
            document.getElementById("sessionAppId").value = appId;
            document.getElementById("sessionComment").value = "";
            document.getElementById("sessionProblem").value = "";
            document.getElementById("sessionConclusions").value = "";
            document.querySelectorAll(".emotion-btn").forEach(btn => btn.classList.remove("selected"));
            openModal("rateSessionModal");
        }

        // Обработка оценки
        function handleRateSession(e) {
            e.preventDefault();
            const appId = document.getElementById("sessionAppId").value;
            const comment = document.getElementById("sessionComment").value;
            const problem = document.getElementById("sessionProblem").value;
            const conclusions = document.getElementById("sessionConclusions").value;
            const emotions = Array.from(document.querySelectorAll(".emotion-btn.selected")).map(btn => btn.dataset.emotion);

            const appointment = appointmentsData.find(a => a.id == appId);
            if (!appointment || appointment.status !== "completed") return;

            const newJournalEntry = {
                id: Date.now(),
                userId: currentUser.id,
                date: `${appointment.dateDay} ${getMonthName(appointment.dateMonth - 1)} ${appointment.dateYear}`,
                content: `Оценка сессии с ${appointment.specialistName} (${appointment.time}): Проблема: ${problem || "Не указана"}. Выводы: ${conclusions || "Не указаны"}. Комментарий: ${comment}. Эмоции: ${emotions.join(", ") || "Не указаны"}`,
                createdAt: new Date().toISOString(),
            };

            const journals = Storage.get(STORAGE_KEYS.JOURNALS) || [];
            journals.push(newJournalEntry);
            Storage.set(STORAGE_KEYS.JOURNALS, journals);
            journalData = Storage.get(STORAGE_KEYS.JOURNALS) || []; // Reload global

            loadUserJournal();
            renderJournal();

            closeModal("rateSessionModal");
            showNotification("Оценка добавлена в дневник", "success");
        }

        // Отмена записи клиента
        function cancelAppointment(appId) {
            const index = appointmentsData.findIndex(a => a.id == appId);
            if (index !== -1) {
                appointmentsData[index].status = "cancelled";
                Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
                updateBookingsFromAppointments();
                loadUserAppointments();
                renderAppointments();
                showNotification("Запись отменена", "success");
            }
        }

        // Завершение записи
        function completeAppointment(appId) {
            const index = appointmentsData.findIndex(a => a.id == appId);
            if (index !== -1) {
                appointmentsData[index].status = "completed";
                Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
                updateBookingsFromAppointments();
                renderAllAppointments();
                showNotification("Сессия отмечена как проведенная", "success");
            }
        }

        // Перенос записи клиента
        function rescheduleAppointment(appId) {
            const appointment = appointmentsData.find(a => a.id == appId);
            if (appointment) {
                if (currentUser.role === "client") {
                    document.getElementById("clientBookingModal").setAttribute("data-app-id", appId);
                    openClientBookingModal(appointment.specialistId);
                } else {
                    openRescheduleModal(appId);
                }
            }
        }

        // Отображение клиентов
        function renderClients() {
            const container = document.getElementById("clientsContainer");
            container.innerHTML = "";

            if (clientsData.length === 0) {
                container.innerHTML = "<p>У вас пока нет клиентов.</p>";
                return;
            }

            clientsData.forEach((client) => {
                const card = document.createElement("div");
                card.className = "client-card";
                card.setAttribute("data-client-id", client.id);

                card.innerHTML = `
                    <div class="client-header">
                        <img src="${client.photo || 'https://randomuser.me/api/portraits/default.jpg'}" alt="${client.name
                    }" class="client-avatar">
                        <div>
                            <h3 class="client-name">${client.name}</h3>
                            <p class="client-next-session">Следующая сессия: ${client.nextSession
                    }</p>
                            <p><strong>Проблема:</strong> ${client.helpNeeded || "Не указано"
                    }</p>
                        </div>
                    </div>
                    <p><strong>Телефон:</strong> ${client.phone || "Не указан"
                    }</p>
                    <p><strong>Email:</strong> ${client.email}</p>
                    <div class="client-actions">
                      <button class="btn btn-register" onclick="openBookClientModal(${client.id})">Записать</button>
                      <button class="btn btn-login" onclick="openNotesModal(${client.id})">Заметки</button>
                    </div>
                `;

                container.appendChild(card);
            });
        }

        // Отображение записей клиента (с сортировкой по дате)
        function renderAppointments() {
            const container = document.getElementById("appointmentsContainer");
            container.innerHTML = "";

            const userAppointments = appointmentsData.filter(
                (a) => a.clientId === currentUser.id && a.type === "client"
            ).sort((a, b) => {
                const dateA = new Date(a.dateYear, a.dateMonth - 1, a.dateDay, parseInt(a.time.split(':')[0]), parseInt(a.time.split(':')[1]));
                const dateB = new Date(b.dateYear, b.dateMonth - 1, b.dateDay, parseInt(b.time.split(':')[0]), parseInt(b.time.split(':')[1]));
                return dateA - dateB;
            });

            if (userAppointments.length === 0) {
                container.innerHTML =
                    "<p>У вас нет записей на супервизию.</p>";
                return;
            }

            userAppointments.forEach((appointment) => {
                if (appointment.status === "cancelled" || appointment.status === "completed") return; // Не показываем отмененные и проведенные

                const appointmentElement = document.createElement("div");
                appointmentElement.className = `help-card ${appointment.status === "pending" ? "pending-appointment-card" : ""}`;

                let statusText = "";
                let actions = "";
                if (appointment.status === "pending") {
                    if (appointment.creatorRole === "specialist") {
                        // Запись от супервизора, клиент подтверждает
                        statusText = '<span style="color: #f39c12;">Предложена супервизором</span>';
                        actions = `
                <div class="client-actions">
                  <button class="btn btn-register confirm-btn" data-app-id="${appointment.id}">Подтвердить</button>
                  <button class="btn btn-login decline-btn" data-app-id="${appointment.id}">Отклонить</button>
                </div>
              `;
                    } else {
                        // Запись от клиента, ждет супервизора
                        statusText = '<span style="color: #f39c12;">Ожидание подтверждения</span>';
                        actions = `
                <div class="client-actions">
                  <button class="btn btn-login reschedule-btn" data-app-id="${appointment.id}">Перенести</button>
                  <button class="btn btn-register cancel-btn" data-app-id="${appointment.id}">Отменить</button>
                </div>
              `;
                    }
                } else if (appointment.status === "confirmed") {
                    statusText = '<span style="color: var(--success);">Подтверждена</span>';
                    actions = `
              <div class="client-actions">
                <button class="btn btn-login reschedule-btn" data-app-id="${appointment.id}">Перенести</button>
                <button class="btn btn-info notes-btn" data-app-id="${appointment.id}">Заметки</button>
                <button class="btn btn-register cancel-btn" data-app-id="${appointment.id}">Отменить</button>
              </div>
            `;
                }

                appointmentElement.innerHTML = `
                    <h3 class="help-title"><i class="fas fa-calendar-check"></i> Супервизия у ${appointment.specialistName
                    }</h3>
                    <p><strong>Дата и время:</strong> ${appointment.dateDay
                    } ${getMonthName(appointment.dateMonth - 1)} ${appointment.dateYear
                    }, ${appointment.time}</p>
                    <p><strong>Статус:</strong> ${statusText}</p>
                    ${actions}
                `;

                container.appendChild(appointmentElement);
            });
        }

        // Отображение всех записей супервизора с сортировкой и группировкой по дням
        function renderAllAppointments() {
            const container = document.getElementById("allAppointmentsContainer");
            container.innerHTML = "";

            const mySpecialist = specialistsData.find(s => s.userId === currentUser.id);
            if (!mySpecialist) {
                container.innerHTML = "<p>Ошибка: супервизор не найден.</p>";
                return;
            }

            let myAppointments = appointmentsData.filter(a => a.specialistId === mySpecialist.id).sort((a, b) => {
                const dateA = new Date(a.dateYear, a.dateMonth - 1, a.dateDay, parseInt(a.time.split(':')[0]), parseInt(a.time.split(':')[1]));
                const dateB = new Date(b.dateYear, b.dateMonth - 1, b.dateDay, parseInt(b.time.split(':')[0]), parseInt(b.time.split(':')[1]));
                return dateA - dateB;
            });

            if (myAppointments.length === 0) {
                container.innerHTML =
                    "<p>Записей пока нет.</p>";
                return;
            }

            // Группировка по дням
            let currentDate = null;
            myAppointments.forEach(app => {
                const appDate = `${app.dateDay}.${app.dateMonth}.${app.dateYear}`;
                if (appDate !== currentDate) {
                    const dateHeader = document.createElement("h3");
                    dateHeader.textContent = appDate;
                    dateHeader.style.marginTop = "1rem";
                    container.appendChild(dateHeader);
                    currentDate = appDate;
                }

                const card = document.createElement("div");
                if (app.type === "plan") {
                    card.className = "client-card plan-card";

                    let statusText = "";
                    let actions = "";
                    if (app.status === "cancelled") {
                        statusText = '<span style="color: var(--error);">Отменено</span>';
                        actions = "";
                    }else if (app.status === "completed") {
                        statusText = '<span style="color: var(--success);">Проведено</span>';
                        actions = "";
                    } else {
                        statusText = '<span style="color: var(--success);">Запланировано</span>';
                        actions = `
                <div class="client-actions" style="margin-top: 1rem;">
                  <button class="btn btn-register cancel-btn" data-app-id="${app.id}">Отменить</button>
                </div>
              `;
                    }

                    card.innerHTML = `
              <h3><i class="fas fa-calendar-alt"></i> ${app.planTitle} - ${app.time}</h3>
              <p>Описание: ${app.planDescription}</p>
              <p>Статус: ${statusText}</p>
              ${actions}
            `;
                } else {
                    card.className = `client-card ${app.status === "pending" ? "pending-appointment-card" : ""}`;
                    let statusText = "";
                    let actions = "";
                    if (app.status === "confirmed") {
                        statusText = '<span style="color: var(--success);">Подтверждена</span>';
                        actions = `
                <div class="client-actions">
                  <button class="btn btn-login reschedule-btn" data-app-id="${app.id}">Перенести</button>
                  <button class="btn btn-register cancel-btn" data-app-id="${app.id}">Отменить</button>
                  <button class="btn btn-register complete-btn" data-app-id="${app.id}">Сессия проведена</button>
                </div>
              `;
                    } else if (app.status === "pending") {
                        if (app.creatorRole === "client") {
                            // Запрос от клиента
                            statusText = '<span style="color: #f39c12;">Новый запрос на запись</span>';
                            actions = `
                  <div class="client-actions">
                    <button class="btn btn-register confirm-btn" data-app-id="${app.id}">Подтвердить</button>
                    <button class="btn btn-login decline-btn" data-app-id="${app.id}">Отклонить</button>
                  </div>
                `;
                        } else {
                            // Запись от супервизора, ждет клиента
                            statusText = '<span style="color: #f39c12;">Ожидание подтверждения клиента</span>';
                            actions = `
                  <div class="client-actions">
                    <button class="btn btn-register cancel-btn" data-app-id="${app.id}">Отменить</button>
                  </div>
                `;
                        }
                    } else if (app.status === "completed") {
                        statusText = '<span style="color: var(--success);">Проведена</span>';
                        actions = "";
                    } else if (app.status === "cancelled") {
                        statusText = '<span style="color: var(--error);">Отменена</span>';
                    }

                    card.innerHTML = `
              <h3><i class="fas fa-user"></i> ${app.clientName} - ${app.time}</h3>
              <p>Статус: ${statusText}</p>
              <p>Заметки: ${app.notes || "Нет"}</p>
              ${actions}
            `;
                }

                container.appendChild(card);
            });
        }

        // Инициализация заметок
        function initNotes() {
            // Добавление заметки
            document
                .getElementById("notesForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    const clientId = this.getAttribute("data-client-id");
                    const content = document.getElementById("noteContent").value;
                    const problem = document.querySelector(".problem-option.selected").dataset.problem;
                    const request = document.querySelector(".request-option.selected").dataset.request;

                    if (content.trim() === "") return;

                    // Создаем новую заметку
                    const newNote = {
                        id: Date.now(),
                        clientId: parseInt(clientId),
                        specialistId: currentUser.id,
                        date: new Date().toLocaleDateString("ru-RU"),
                        content,
                        problemCameWith: problem,
                        revealedRequest: request,
                        createdAt: new Date().toISOString(),
                    };

                    // Сохраняем заметку
                    const notes = Storage.get(STORAGE_KEYS.NOTES) || [];
                    notes.push(newNote);
                    Storage.set(STORAGE_KEYS.NOTES, notes);
                    notesData = Storage.get(STORAGE_KEYS.NOTES) || []; // Reload global

                    document.getElementById("noteContent").value = "";
                    document
                        .querySelectorAll(".problem-option")
                        .forEach((el) => el.classList.remove("selected"));
                    document
                        .querySelectorAll(".request-option")
                        .forEach((el) => el.classList.remove("selected"));

                    renderNotes(clientId);
                    loadSpecialistClients();
                    renderClients();
                    showNotification("Заметка добавлена", "success");
                });
        }

        // Открытие модального окна заметок
        function openNotesModal(clientId) {
            const client = clientsData.find((c) => c.id == clientId);
            if (client) {
                document.getElementById(
                    "notesTitle"
                ).textContent = `Заметки для ${client.name}`;
                document
                    .getElementById("notesForm")
                    .setAttribute("data-client-id", clientId);
                renderNotes(clientId);
                openModal("notesModal");
            }
        }

        // Отображение заметок
        function renderNotes(clientId) {
            const container = document.getElementById("notesList");
            container.innerHTML = "";

            const clientNotes = notesData.filter((n) => n.clientId == clientId);

            if (clientNotes.length === 0) {
                container.innerHTML = "<p>Заметок пока нет.</p>";
                return;
            }

            clientNotes.forEach((note, index) => {
                const entry = document.createElement("div");
                entry.className = "note-entry";
                entry.style.animationDelay = `${index * 0.1}s`;
                entry.setAttribute("data-note-id", note.id);

                entry.innerHTML = `
                    <div class="note-date">${note.date}</div>
                    <div class="note-content">${note.content}</div>
                    <p><strong>Проблема:</strong> ${note.problemCameWith || "Не указано"}</p>
                    <p><strong>Запрос:</strong> ${note.revealedRequest || "Не указано"}</p>
                    <div class="note-actions">
                      <button class="note-edit-btn" onclick="editNote(${note.id})">Редактировать</button>
                      <button class="note-delete-btn" onclick="deleteNote(${note.id})">Удалить</button>
                    </div>
                `;

                container.appendChild(entry);
            });
        }

        // Инициализация дневника клиента
        function initJournal() {
            document
                .getElementById("journalForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    const content = document.getElementById("journalContent").value;

                    if (content.trim() === "") return;

                    // Создаем новую запись в дневнике
                    const newJournalEntry = {
                        id: Date.now(),
                        userId: currentUser.id,
                        date: new Date().toLocaleDateString("ru-RU"),
                        content,
                        createdAt: new Date().toISOString(),
                    };

                    // Сохраняем запись
                    const journals = Storage.get(STORAGE_KEYS.JOURNALS) || [];
                    journals.push(newJournalEntry);
                    Storage.set(STORAGE_KEYS.JOURNALS, journals);
                    journalData = Storage.get(STORAGE_KEYS.JOURNALS) || []; // Reload global

                    document.getElementById("journalContent").value = "";
                    loadUserJournal();
                    renderJournal();
                    showNotification("Запись добавлена в дневник", "success");
                });
        }

        // Отображение дневника
        function renderJournal() {
            const container = document.getElementById("journalEntries");
            container.innerHTML = "";

            const userJournalEntries = journalData.filter((j) => j.userId === currentUser.id).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

           if (userJournalEntries.length === 0) {
                container.innerHTML = "<p>Записей пока нет.</p>";
                return;
            }

            userJournalEntries.forEach((entry, index) => {
                const journalEntry = document.createElement("div");
                journalEntry.className = "journal-entry animate";
                journalEntry.style.animationDelay = `${index * 0.1}s`;

                journalEntry.innerHTML = `
                    <div class="journal-date">${entry.date}</div>
                    <div class="journal-content">${entry.content}</div>
                `;

                container.appendChild(journalEntry);
            });
        }

        // Инициализация заметок
        function initNotes() {
            // Добавление заметки
            document
                .getElementById("notesForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    const clientId = this.getAttribute("data-client-id");
                    const content = document.getElementById("noteContent").value;
                    const problem = document.querySelector(".problem-option.selected").dataset.problem;
                    const request = document.querySelector(".request-option.selected").dataset.request;

                    if (content.trim() === "") return;

                    // Создаем новую заметку
                    const newNote = {
                        id: Date.now(),
                        clientId: parseInt(clientId),
                        specialistId: currentUser.id,
                        date: new Date().toLocaleDateString("ru-RU"),
                        content,
                        problemCameWith: problem,
                        revealedRequest: request,
                        createdAt: new Date().toISOString(),
                    };

                    // Сохраняем заметку
                    const notes = Storage.get(STORAGE_KEYS.NOTES) || [];
                    notes.push(newNote);
                    Storage.set(STORAGE_KEYS.NOTES, notes);
                    notesData = Storage.get(STORAGE_KEYS.NOTES) || []; // Reload global

                    document.getElementById("noteContent").value = "";
                    document
                        .querySelectorAll(".problem-option")
                        .forEach((el) => el.classList.remove("selected"));
                    document
                        .querySelectorAll(".request-option")
                        .forEach((el) => el.classList.remove("selected"));

                    renderNotes(clientId);
                    loadSpecialistClients();
                    renderClients();
                    showNotification("Заметка добавлена", "success");
                });
        }

        // Открытие модального окна заметок
        function openNotesModal(clientId) {
            const client = clientsData.find((c) => c.id == clientId);
            if (client) {
                document.getElementById(
                    "notesTitle"
                ).textContent = `Заметки для ${client.name}`;
                document
                    .getElementById("notesForm")
                    .setAttribute("data-client-id", clientId);
                renderNotes(clientId);
                openModal("notesModal");
            }
        }

        // Отображение заметок
        function renderNotes(clientId) {
            const container = document.getElementById("notesList");
            container.innerHTML = "";

            const clientNotes = notesData.filter((n) => n.clientId == clientId);

            if (clientNotes.length === 0) {
                container.innerHTML = "<p>Заметок пока нет.</p>";
                return;
            }

            clientNotes.forEach((note, index) => {
                const entry = document.createElement("div");
                entry.className = "note-entry";
                entry.style.animationDelay = `${index * 0.1}s`;
                entry.setAttribute("data-note-id", note.id);

                entry.innerHTML = `
                    <div class="note-date">${note.date}</div>
                    <div class="note-content">${note.content}</div>
                    <p><strong>Проблема:</strong> ${note.problemCameWith || "Не указано"}</p>
                    <p><strong>Запрос:</strong> ${note.revealedRequest || "Не указано"}</p>
                    <div class="note-actions">
                      <button class="note-edit-btn" onclick="editNote(${note.id})">Редактировать</button>
                      <button class="note-delete-btn" onclick="deleteNote(${note.id})">Удалить</button>
                    </div>
                `;

                container.appendChild(entry);
            });
        }

        // Инициализация дневника клиента
        function initJournal() {
            document
                .getElementById("journalForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();
                    const content = document.getElementById("journalContent").value;

                    if (content.trim() === "") return;

                    // Создаем новую запись в дневнике
                    const newJournalEntry = {
                        id: Date.now(),
                        userId: currentUser.id,
                        date: new Date().toLocaleDateString("ru-RU"),
                        content,
                        createdAt: new Date().toISOString(),
                    };

                    // Сохраняем запись
                    const journals = Storage.get(STORAGE_KEYS.JOURNALS) || [];
                    journals.push(newJournalEntry);
                    Storage.set(STORAGE_KEYS.JOURNALS, journals);
                    journalData = Storage.get(STORAGE_KEYS.JOURNALS) || []; // Reload global

                    document.getElementById("journalContent").value = "";
                    loadUserJournal();
                    renderJournal();
                    showNotification("Запись добавлена в дневник", "success");
                });
        }

        // Отображение дневника
        function renderJournal() {
            const container = document.getElementById("journalEntries");
            container.innerHTML = "";

            const userJournalEntries = journalData.filter((j) => j.userId === currentUser.id).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

           if (userJournalEntries.length === 0) {
                container.innerHTML = "<p>Записей пока нет.</p>";
                return;
            }

            userJournalEntries.forEach((entry, index) => {
                const journalEntry = document.createElement("div");
                journalEntry.className = "journal-entry animate";
                journalEntry.style.animationDelay = `${index * 0.1}s`;

                journalEntry.innerHTML = `
                    <div class="journal-date">${entry.date}</div>
                    <div class="journal-content">${entry.content}</div>
                `;

                container.appendChild(journalEntry);
            });
        }

        // Инициализация всех записей супервизора
        function initSpecialistAppointments() {
            document.getElementById("allAppointmentsContainer").addEventListener("click", function (e) {
                if (e.target.tagName === "BUTTON") {
                    const appId = e.target.getAttribute("data-app-id");
                    const appIndex = appointmentsData.findIndex(a => a.id == appId);
                    if (appIndex !== -1) {
                        if (e.target.textContent === "Подтвердить") {
                            handleAppointmentAction(appId, 'confirm');
                        } else if (e.target.textContent === "Отклонить") {
                            handleAppointmentAction(appId, 'decline');
                        } else if (e.target.textContent === "Отменить") {
                            if (appointmentsData[appIndex].status === "pending") {
                                handleAppointmentAction(appId, 'decline');
                            } else {
                                cancelAppointment(appId);
                            }
                        } else if (e.target.textContent === "Перенести") {
                            openRescheduleModal(appId);
                            return;
                        } else if (e.target.textContent === "Сессия проведена") {
                            completeAppointment(appId);
                        }
                        Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
                        updateBookingsFromAppointments();
                        renderAllAppointments();
                        renderCalendar(); // Обновляем календарь после отмены
                    }
                }
            });
        }

        // Инициализация выбора в расписании
        function initScheduleChoice() {
            document.getElementById("bookClientChoice").addEventListener("click", handleBookClientChoice);
            document.getElementById("otherPlanChoice").addEventListener("click", handleOtherPlanChoice);
            document.getElementById("bookSpecificClientForm").addEventListener("submit", handleSpecificClientBooking);
            document.getElementById("otherPlanForm").addEventListener("submit", handleAddPlan);
        }

        function handleBookClientChoice() {
            const day = document.getElementById("scheduleChoiceModal").getAttribute("data-day");
            const time = document.getElementById("scheduleChoiceModal").getAttribute("data-time");
            closeModal("scheduleChoiceModal");

            // Populate select
            const select = document.getElementById("selectClient");
            select.innerHTML = "";
            clientsData.forEach((client) => {
                const option = document.createElement("option");
                option.value = client.id;
                option.textContent = client.name;
                select.appendChild(option);
            });

            // Set slot info
            document.getElementById("selectedSlotInfo").innerHTML = `
          <div class="booking-detail">
            <strong>Дата:</strong> <span>${day} ${getMonthName(currentMonth)} ${currentYear}</span>
          </div>
          <div class="booking-detail">
            <strong>Время:</strong> <span>${time}</span>
          </div>
        `;

            // Set data
            document.getElementById("bookSpecificClientModal").setAttribute("data-day", day);
            document.getElementById("bookSpecificClientModal").setAttribute("data-time", time);

            openModal("bookSpecificClientModal");
        }

        function handleSpecificClientBooking(e) {
            e.preventDefault();
            const clientId = parseInt(document.getElementById("selectClient").value);
            const day = parseInt(document.getElementById("bookSpecificClientModal").getAttribute("data-day"));
            const time = document.getElementById("bookSpecificClientModal").getAttribute("data-time");
            const client = clientsData.find((c) => c.id === clientId);
            const specialist = specialistsData.find((s) => s.userId === currentUser.id);

            if (!client || !specialist) {
                showNotification("Ошибка: клиент или супервизор не найден", "error");
                return;
            }

            const newAppointment = {
                id: Date.now(),
                type: "client",
                clientId: client.id,
                clientName: client.name,
                specialistId: specialist.id,
                specialistName: specialist.name,
                dateDay: day,
                dateMonth: currentMonth + 1,
                dateYear: currentYear,
                time: time,
                status: "pending",
                creatorRole: "specialist",
                notes: "",
                createdAt: new Date().toISOString(),
                seenByClient: false,
            };

            const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
            appointments.push(newAppointment);
            Storage.set(STORAGE_KEYS.APPOINTMENTS, appointments);
            appointmentsData = Storage.get(STORAGE_KEYS.APPOINTMENTS) || []; // Reload global

            updateBookingsFromAppointments();

            closeModal("bookSpecificClientModal");
            showNotification("Клиент записан на сессию (ожидает подтверждения)", "success");
            renderCalendar();
        }

        function handleOtherPlanChoice() {
            const day = document.getElementById("scheduleChoiceModal").getAttribute("data-day");
            const time = document.getElementById("scheduleChoiceModal").getAttribute("data-time");
            closeModal("scheduleChoiceModal");

            // Set slot info
            document.getElementById("selectedPlanSlotInfo").innerHTML = `
          <div class="booking-detail">
            <strong>Дата:</strong> <span>${day} ${getMonthName(currentMonth)} ${currentYear}</span>
          </div>
          <div class="booking-detail">
            <strong>Время:</strong> <span>${time}</span>
          </div>
        `;

            // Set data
            document.getElementById("otherPlanModal").setAttribute("data-day", day);
            document.getElementById("otherPlanModal").setAttribute("data-time", time);

            openModal("otherPlanModal");
        }

        function handleAddPlan(e) {
            e.preventDefault();
            const title = document.getElementById("planTitle").value.trim();
            const desc = document.getElementById("planDescription").value.trim();
            const day = parseInt(document.getElementById("otherPlanModal").getAttribute("data-day"));
            const time = document.getElementById("otherPlanModal").getAttribute("data-time");
            const specialist = specialistsData.find((s) => s.userId === currentUser.id);

            if (!title || !desc || !specialist) {
                showNotification("Заполните все поля", "error");
                return;
            }

            const newAppointment = {
                id: Date.now(),
                type: "plan",
                planTitle: title,
                planDescription: desc,
                specialistId: specialist.id,
                specialistName: specialist.name,
                dateDay: day,
                dateMonth: currentMonth + 1,
                dateYear: currentYear,
                time: time,
                status: "confirmed",
                notes: "",
                createdAt: new Date().toISOString(),
            };

            const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
            appointments.push(newAppointment);
            Storage.set(STORAGE_KEYS.APPOINTMENTS, appointments);
            appointmentsData = Storage.get(STORAGE_KEYS.APPOINTMENTS) || []; // Reload global

            updateBookingsFromAppointments();

            document.getElementById("otherPlanForm").reset();
            closeModal("otherPlanModal");
            showNotification("План добавлен", "success");
            renderCalendar();
        }

        // Инициализация записи клиента супервизором
        function initBookClient() {
            let bookCurrentMonth = new Date().getMonth();
            let bookCurrentYear = new Date().getFullYear();

            function renderBookCalendar() {
                const calendarDays = document.getElementById("bookCalendarDays");
                calendarDays.innerHTML = "";

                const monthNames = [
                    "Январь",
                    "Февраль",
                    "Март",
                    "Апрель",
                    "Май",
                    "Июнь",
                    "Июль",
                    "Август",
                    "Сентябрь",
                    "Октябрь",
                    "Ноябрь",
                    "Декабрь",
                ];
                document.getElementById(
                    "bookCalendarMonth"
                ).textContent = `${monthNames[bookCurrentMonth]} ${bookCurrentYear}`;

                // Заголовки дней недели
                const daysOfWeek = ["Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"];
                daysOfWeek.forEach((day) => {
                    const dayElement = document.createElement("div");
                    dayElement.className = "calendar-day";
                    dayElement.textContent = day;
                    dayElement.style.fontWeight = "bold";
                    calendarDays.appendChild(dayElement);
                });

                const firstDay = new Date(bookCurrentYear, bookCurrentMonth, 1).getDay();
                const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1;
                const daysInMonth = new Date(
                    bookCurrentYear,
                    bookCurrentMonth + 1,
                    0
                ).getDate();

                for (let i = 0; i < adjustedFirstDay; i++) {
                    const emptyDay = document.createElement("div");
                    emptyDay.className = "calendar-day disabled";
                    calendarDays.appendChild(emptyDay);
                }

                const specialist = specialistsData.find(s => s.userId === currentUser.id);
                const specialistId = specialist ? specialist.id : null;

                for (let i = 1; i <= daysInMonth; i++) {
                    const dayElement = document.createElement("div");
                    dayElement.className = "calendar-day";
                    dayElement.textContent = i;

                    const dateKey = `${bookCurrentYear}-${bookCurrentMonth + 1}-${i}`;
                    if (specialistId && bookings[specialistId] && bookings[specialistId][dateKey]) {
                        dayElement.classList.add("has-bookings");
                    }

                    const currentDate = new Date();
                    const cellDate = new Date(bookCurrentYear, bookCurrentMonth, i);
                   if (
                        cellDate < currentDate &&
                        cellDate.getDate() !== currentDate.getDate()
                    ) {
                        dayElement.classList.add("disabled");
                    }

                    calendarDays.appendChild(dayElement);
                }

                renderBookTimeSlots();
            }

            function renderBookTimeSlots(selectedDay = null) {
                const timeSlotsContainer = document.getElementById("bookTimeSlotsContainer");
                timeSlotsContainer.innerHTML = "";

                if (!selectedDay) {
                    timeSlotsContainer.innerHTML = "<p></p>";
                    return;
                }

                const timeSlots = [
                    "09:00", "10:00", "11:00", "12:00", "13:00",
                    "14:00", "15:00", "16:00", "17:00", "18:00",
                ];

                const specialist = specialistsData.find(s => s.userId === currentUser.id);
                const specialistId = specialist ? specialist.id : null;

                timeSlots.forEach((slot, index) => {
                    const slotElement = document.createElement("div");
                    slotElement.className = "time-slot";
                    slotElement.textContent = slot;
                    slotElement.style.animationDelay = `${index * 0.1}s`;

                    const dateKey = `${bookCurrentYear}-${bookCurrentMonth + 1}-${selectedDay}`;
                    if (specialistId && bookings[specialistId] && bookings[specialistId][dateKey] && bookings[specialistId][dateKey][slot]) {
                        slotElement.classList.add("booked");
                        slotElement.setAttribute("data-client", bookings[specialistId][dateKey][slot]);
                    }

                    timeSlotsContainer.appendChild(slotElement);
                });
            }

            // Обработчики для модального календаря
            document.getElementById("bookPrevMonth").addEventListener("click", () => {
                bookCurrentMonth--;
                if (bookCurrentMonth < 0) {
                    bookCurrentMonth = 11;
                    bookCurrentYear--;
                }
                renderBookCalendar();
            });

            document.getElementById("bookNextMonth").addEventListener("click", () => {
                bookCurrentMonth++;
                if (bookCurrentMonth > 11) {
                    bookCurrentMonth = 0;
                    bookCurrentYear++;
                }
                renderBookCalendar();
            });

            document.getElementById("bookCalendarDays").addEventListener("click", (e) => {
                if (
                    e.target.classList.contains("calendar-day") &&
                    !e.target.classList.contains("disabled")
                ) {
                    document
                        .querySelectorAll("#bookCalendarDays .calendar-day")
                        .forEach((day) => day.classList.remove("selected"));
                    e.target.classList.add("selected");
                    renderBookTimeSlots(e.target.textContent);
                }
            });

            document.getElementById("bookTimeSlotsContainer").addEventListener("click", (e) => {
                if (
                    e.target.classList.contains("time-slot") &&
                    !e.target.classList.contains("booked")
                ) {
                    document
                        .querySelectorAll("#bookTimeSlotsContainer .time-slot")
                        .forEach((slot) => slot.classList.remove("selected"));
                    e.target.classList.add("selected");
                }
            });

            // Подтверждение записи
            document.getElementById("confirmBookClient").addEventListener("click", () => {
                const modal = document.getElementById("bookClientModal");
                const clientId = modal.getAttribute("data-client-id");
                const selectedDayElement = document.querySelector("#bookCalendarDays .calendar-day.selected");
                if (!selectedDayElement) {
                    showNotification("Выберите день", "error");
                    return;
                }
                const selectedDay = selectedDayElement.textContent;
                const selectedTimeElement = document.querySelector("#bookTimeSlotsContainer .time-slot.selected");
                if (!selectedTimeElement) {
                    showNotification("Выберите время", "error");
                    return;
                }
                const selectedTime = selectedTimeElement.textContent;

                const mySpecialist = specialistsData.find(s => s.userId === currentUser.id);
                const client = clientsData.find(c => c.id == clientId);

                if (!mySpecialist || !client) return;

                const newAppointment = {
                    id: Date.now(),
                    type: "client",
                    clientId: client.id,
                    clientName: client.name,
                    specialistId: mySpecialist.id,
                    specialistName: mySpecialist.name,
                    dateDay: parseInt(selectedDay),
                    dateMonth: bookCurrentMonth + 1,
                    dateYear: bookCurrentYear,
                    time: selectedTime,
                    status: "pending",
                    creatorRole: "specialist",
                    notes: "",
                    createdAt: new Date().toISOString(),
                    seenByClient: false,
                };

                const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
                appointments.push(newAppointment);
                Storage.set(STORAGE_KEYS.APPOINTMENTS, appointments);
                appointmentsData = Storage.get(STORAGE_KEYS.APPOINTMENTS) || []; // Reload global

                updateBookingsFromAppointments();

                // Close modal
                closeModal("bookClientModal");
                showNotification("Предложение о записи отправлено клиенту (ожидает подтверждения)", "success");

                // Уведомляем клиента (симуляция)
                setTimeout(() => showNotification("Клиент уведомлен о предложении записи", "info"), 1000);

                // Refresh views
                renderAllAppointments();
                loadSpecialistClients();
                renderClients();
            });
        }

        // Открытие модального окна записи клиента
        function openBookClientModal(clientId) {
            document.getElementById("bookClientModal").setAttribute("data-client-id", clientId);

            // Reset selections
            document.querySelectorAll("#bookCalendarDays .calendar-day").forEach(day => day.classList.remove("selected"));
            document.querySelectorAll("#bookTimeSlotsContainer .time-slot").forEach(slot => slot.classList.remove("selected"));

            openModal("bookClientModal");
            renderBookCalendar();
        }

        // Открытие клиентского модального окна бронирования
        function openClientBookingModal(specialistId) {
            document.getElementById("clientBookingModal").setAttribute("data-specialist-id", specialistId);

            // Reset selections
            document.querySelectorAll("#clientCalendarDays .calendar-day").forEach(day => day.classList.remove("selected"));
            document.querySelectorAll("#clientTimeSlotsContainer .time-slot").forEach(slot => slot.classList.remove("selected"));

            openModal("clientBookingModal");
            renderClientCalendar(specialistId);
        }

        // Инициализация клиентского модального календаря
        function initClientBookingModal() {
            let clientCurrentMonth = new Date().getMonth();
            let clientCurrentYear = new Date().getFullYear();

            function renderClientCalendar(specialistId) {
                const calendarDays = document.getElementById("clientCalendarDays");
                calendarDays.innerHTML = "";

                const monthNames = [
                    "Январь",
                    "Февраль",
                    "Март",
                    "Апрель",
                    "Май",
                    "Июнь",
                    "Июль",
                    "Август",
                    "Сентябрь",
                    "Октябрь",
                    "Ноябрь",
                    "Декабрь",
                ];
                document.getElementById(
                    "clientCalendarMonth"
                ).textContent = `${monthNames[clientCurrentMonth]} ${clientCurrentYear}`;

                // Заголовки дней недели
                const daysOfWeek = ["Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"];
                daysOfWeek.forEach((day) => {
                    const dayElement = document.createElement("div");
                    dayElement.className = "calendar-day";
                    dayElement.textContent = day;
                    dayElement.style.fontWeight = "bold";
                    calendarDays.appendChild(dayElement);
                });

                const firstDay = new Date(clientCurrentYear, clientCurrentMonth, 1).getDay();
                const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1;
                const daysInMonth = new Date(
                    clientCurrentYear,
                    clientCurrentMonth + 1,
                    0
                ).getDate();

                for (let i = 0; i < adjustedFirstDay; i++) {
                    const emptyDay = document.createElement("div");
                    emptyDay.className = "calendar-day disabled";
                    calendarDays.appendChild(emptyDay);
                }

                for (let i = 1; i <= daysInMonth; i++) {
                    const dayElement = document.createElement("div");
                    dayElement.className = "calendar-day";
                    dayElement.textContent = i;

                    const dateKey = `${clientCurrentYear}-${clientCurrentMonth + 1}-${i}`;
                    if (bookings[specialistId] && bookings[specialistId][dateKey]) {
                        dayElement.classList.add("has-bookings");
                    }

                    const currentDate = new Date();
                    const cellDate = new Date(clientCurrentYear, clientCurrentMonth, i);
                    if (
                        cellDate < currentDate &&
                        cellDate.getDate() !== currentDate.getDate()
                    ) {
                        dayElement.classList.add("disabled");
                    }

                    calendarDays.appendChild(dayElement);
                }

                renderClientTimeSlots(specialistId);
            }

            function renderClientTimeSlots(specialistId, selectedDay = null) {
                const timeSlotsContainer = document.getElementById("clientTimeSlotsContainer");
                timeSlotsContainer.innerHTML = "";

                if (!selectedDay) {
                    timeSlotsContainer.innerHTML = "<p></p>";
                    return;
                }

                const timeSlots = [
                    "09:00", "10:00", "11:00", "12:00", "13:00",
                    "14:00", "15:00", "16:00", "17:00", "18:00",
                ];

                timeSlots.forEach((slot, index) => {
                    const slotElement = document.createElement("div");
                    slotElement.className = "time-slot";
                    slotElement.textContent = slot;
                    slotElement.style.animationDelay = `${index * 0.1}s`;

                    const dateKey = `${clientCurrentYear}-${clientCurrentMonth + 1}-${selectedDay}`;
                    if (bookings[specialistId] && bookings[specialistId][dateKey] && bookings[specialistId][dateKey][slot]) {
                        slotElement.classList.add("booked");
                        slotElement.setAttribute("data-client", bookings[specialistId][dateKey][slot]);
                    } else {
                        slotElement.classList.add("available");
                    }

                    timeSlotsContainer.appendChild(slotElement);
                });
            }

            // Обработчики для модального календаря клиента
            document.getElementById("clientPrevMonth").addEventListener("click", () => {
                clientCurrentMonth--;
                if (clientCurrentMonth < 0) {
                    clientCurrentMonth = 11;
                    clientCurrentYear--;
                }
                const specialistId = document.getElementById("clientBookingModal").getAttribute("data-specialist-id");
                renderClientCalendar(specialistId);
            });

            document.getElementById("clientNextMonth").addEventListener("click", () => {
                clientCurrentMonth++;
                if (clientCurrentMonth > 11) {
                    clientCurrentMonth = 0;
                    clientCurrentYear++;
                }
                const specialistId = document.getElementById("clientBookingModal").getAttribute("data-specialist-id");
                renderClientCalendar(specialistId);
            });

            document.getElementById("clientCalendarDays").addEventListener("click", (e) => {
                if (
                    e.target.classList.contains("calendar-day") &&
                    !e.target.classList.contains("disabled")
                ) {
                    document
                        .querySelectorAll("#clientCalendarDays .calendar-day")
                        .forEach((day) => day.classList.remove("selected"));
                    e.target.classList.add("selected");
                    const specialistId = document.getElementById("clientBookingModal").getAttribute("data-specialist-id");
                    renderClientTimeSlots(specialistId, e.target.textContent);
                }
            });

            document.getElementById("clientTimeSlotsContainer").addEventListener("click", (e) => {
                if (
                    e.target.classList.contains("time-slot") &&
                    !e.target.classList.contains("booked")
                ) {
                    document
                        .querySelectorAll("#clientTimeSlotsContainer .time-slot")
                        .forEach((slot) => slot.classList.remove("selected"));
                    e.target.classList.add("selected");
                }
            });

            // Подтверждение выбора времени для клиента
            document.getElementById("confirmClientTime").addEventListener("click", () => {
                const modal = document.getElementById("clientBookingModal");
                const specialistId = modal.getAttribute("data-specialist-id");
                const appId = modal.getAttribute("data-app-id") || "";
                const specialist = specialistsData.find((s) => s.id == specialistId);
                const selectedDayElement = document.querySelector("#clientCalendarDays .calendar-day.selected");
                if (!selectedDayElement) {
                    showNotification("Выберите день", "error");
                    return;
                }
                const selectedDay = selectedDayElement.textContent;
                const selectedTimeElement = document.querySelector("#clientTimeSlotsContainer .time-slot.selected");
                if (!selectedTimeElement) {
                    showNotification("Выберите время", "error");
                    return;
                }
                const selectedTime = selectedTimeElement.textContent;

                // Заполняем информацию о записи
                const summaryElement = document.getElementById("bookingSummary");
                summaryElement.innerHTML = `
                <div class="booking-detail">
                    <strong>Супервизор:</strong> <span>${specialist.name}</span>
                </div>
                <div class="booking-detail">
                    <strong>Дата:</strong> <span>${selectedDay} ${getMonthName(clientCurrentMonth)} ${clientCurrentYear}</span>
                </div>
                <div class="booking-detail">
                    <strong>Время:</strong> <span>${selectedTime}</span>
                </div>
                <div class="booking-detail">
                    <strong>Стоимость:</strong> <span>${specialist.price} руб.</span>
                </div>
            `;

                // Сохраняем данные
                summaryElement.setAttribute("data-specialist-id", specialistId);
                summaryElement.setAttribute("data-day", selectedDay);
                summaryElement.setAttribute("data-time", selectedTime);
                summaryElement.setAttribute("data-month", clientCurrentMonth + 1);
                summaryElement.setAttribute("data-year", clientCurrentYear);
                summaryElement.setAttribute("data-app-id", appId);

                closeModal("clientBookingModal");
                openModal("bookingModal");
            });
        }

        // Инициализация модала переноса для супервизора
        function initRescheduleModal() {
            let rescheduleCurrentMonth = new Date().getMonth();
            let rescheduleCurrentYear = new Date().getFullYear();

            function renderRescheduleCalendar(specialistId) {
                const calendarDays = document.getElementById("rescheduleCalendarDays");
                calendarDays.innerHTML = "";

                const monthNames = [
                    "Январь",
                    "Февраль",
                    "Март",
                    "Апрель",
                    "Май",
                    "Июнь",
                    "Июль",
                    "Август",
                    "Сентября",
                    "Октябрь",
                    "Ноябрь",
                    "Декабрь",
                ];
                document.getElementById(
                    "rescheduleCalendarMonth"
                ).textContent = `${monthNames[rescheduleCurrentMonth]} ${rescheduleCurrentYear}`;

                // Заголовки дней недели
                const daysOfWeek = ["Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"];
                daysOfWeek.forEach((day) => {
                    const dayElement = document.createElement("div");
                    dayElement.className = "calendar-day";
                    dayElement.textContent = day;
                    dayElement.style.fontWeight = "bold";
                    calendarDays.appendChild(dayElement);
                });

                const firstDay = new Date(rescheduleCurrentYear, rescheduleCurrentMonth, 1).getDay();
                const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1;
                const daysInMonth = new Date(
                    rescheduleCurrentYear,
                    rescheduleCurrentMonth + 1,
                    0
                ).getDate();

                for (let i = 0; i < adjustedFirstDay; i++) {
                    const emptyDay = document.createElement("div");
                    emptyDay.className = "calendar-day disabled";
                    calendarDays.appendChild(emptyDay);
                }

                for (let i = 1; i <= daysInMonth; i++) {
                    const dayElement = document.createElement("div");
                    dayElement.className = "calendar-day";
                    dayElement.textContent = i;

                    const dateKey = `${rescheduleCurrentYear}-${rescheduleCurrentMonth + 1}-${i}`;
                    if (bookings[specialistId] && bookings[specialistId][dateKey]) {
                        dayElement.classList.add("has-bookings");
                    }

                    const currentDate = new Date();
                    const cellDate = new Date(rescheduleCurrentYear, rescheduleCurrentMonth, i);
                    if (
                        cellDate < currentDate &&
                        cellDate.getDate() !== currentDate.getDate()
                    ) {
                        dayElement.classList.add("disabled");
                    }

                    calendarDays.appendChild(dayElement);
                }

                renderRescheduleTimeSlots(specialistId);
            }

            function renderRescheduleTimeSlots(specialistId, selectedDay = null) {
                const timeSlotsContainer = document.getElementById("rescheduleTimeSlotsContainer");
                timeSlotsContainer.innerHTML = "";

                if (!selectedDay) {
                    timeSlotsContainer.innerHTML = "<p></p>";
                    return;
                }

                const timeSlots = [
                    "09:00", "10:00", "11:00", "12:00", "13:00",
                    "14:00", "15:00", "16:00", "17:00", "18:00",
                ];

                timeSlots.forEach((slot, index) => {
                    const slotElement = document.createElement("div");
                    slotElement.className = "time-slot";
                    slotElement.textContent = slot;
                    slotElement.style.animationDelay = `${index * 0.1}s`;

                    const dateKey = `${rescheduleCurrentYear}-${rescheduleCurrentMonth + 1}-${selectedDay}`;
                    if (bookings[specialistId] && bookings[specialistId][dateKey] && bookings[specialistId][dateKey][slot]) {
                        slotElement.classList.add("booked");
                        slotElement.setAttribute("data-client", bookings[specialistId][dateKey][slot]);
                    } else {
                        slotElement.classList.add("available");
                    }

                    timeSlotsContainer.appendChild(slotElement);
                });
            }

            // Обработчики для модального календаря переноса
            document.getElementById("reschedulePrevMonth").addEventListener("click", () => {
                rescheduleCurrentMonth--;
                if (rescheduleCurrentMonth < 0) {
                    rescheduleCurrentMonth = 11;
                    rescheduleCurrentYear--;
                }
                const specialistId = document.getElementById("rescheduleModal").getAttribute("data-specialist-id");
                renderRescheduleCalendar(specialistId);
            });

            document.getElementById("rescheduleNextMonth").addEventListener("click", () => {
                rescheduleCurrentMonth++;
                if (rescheduleCurrentMonth > 11) {
                    rescheduleCurrentMonth = 0;
                    rescheduleCurrentYear++;
                }
                const specialistId = document.getElementById("rescheduleModal").getAttribute("data-specialist-id");
                renderRescheduleCalendar(specialistId);
            });

            document.getElementById("rescheduleCalendarDays").addEventListener("click", (e) => {
                if (
                    e.target.classList.contains("calendar-day") &&
                    !e.target.classList.contains("disabled")
                ) {
                    document
                        .querySelectorAll("#rescheduleCalendarDays .calendar-day")
                        .forEach((day) => day.classList.remove("selected"));
                    e.target.classList.add("selected");
                    const specialistId = document.getElementById("rescheduleModal").getAttribute("data-specialist-id");
                    renderRescheduleTimeSlots(specialistId, e.target.textContent);
                }
            });

            document.getElementById("rescheduleTimeSlotsContainer").addEventListener("click", (e) => {
                if (
                    e.target.classList.contains("time-slot") &&
                    !e.target.classList.contains("booked")
                ) {
                    document
                        .querySelectorAll("#rescheduleTimeSlotsContainer .time-slot")
                        .forEach((slot) => slot.classList.remove("selected"));
                    e.target.classList.add("selected");
                }
            });

            // Подтверждение переноса
            document.getElementById("confirmReschedule").addEventListener("click", () => {
                const modal = document.getElementById("rescheduleModal");
                const appId = modal.getAttribute("data-app-id");
                const specialistId = modal.getAttribute("data-specialist-id");
                const selectedDayElement = document.querySelector("#rescheduleCalendarDays .calendar-day.selected");
                if (!selectedDayElement) {
                    showNotification("Выберите день", "error");
                    return;
                }
                const selectedDay = selectedDayElement.textContent;
                const selectedTimeElement = document.querySelector("#rescheduleTimeSlotsContainer .time-slot.selected");
                if (!selectedTimeElement) {
                    showNotification("Выберите время", "error");
                    return;
                }
                const selectedTime = selectedTimeElement.textContent;

                const appIndex = appointmentsData.findIndex(a => a.id == appId);
                if (appIndex !== -1) {
                    appointmentsData[appIndex].dateDay = parseInt(selectedDay);
                    appointmentsData[appIndex].dateMonth = rescheduleCurrentMonth + 1;
                    appointmentsData[appIndex].dateYear = rescheduleCurrentYear;
                    appointmentsData[appIndex].time = selectedTime;
                    appointmentsData[appIndex].status = "confirmed"; // После переноса сразу подтверждаем

                    Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
                    updateBookingsFromAppointments();

                    closeModal("rescheduleModal");
                    showNotification("Перенос записи подтвержден", "success");

                    // Обновляем views
                    renderAllAppointments();
                    renderCalendar();
                    loadSpecialistClients();
                    renderClients();
                }
            });
        }

        // Открытие модального окна переноса
        function openRescheduleModal(appId) {
            const appointment = appointmentsData.find(a => a.id == appId);
            if (appointment) {
                document.getElementById("rescheduleModal").setAttribute("data-app-id", appId);
                document.getElementById("rescheduleModal").setAttribute("data-specialist-id", appointment.specialistId);
                openModal("rescheduleModal");
                renderRescheduleCalendar(appointment.specialistId);
            }
        }

        // Обработка фото клиента
        function handleClientPhotoUpload(e) {
            const file = e.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    currentUser.photo = e.target.result;
                    document.getElementById("clientPhotoPreview").src = currentUser.photo;
                    document.getElementById("clientPhotoPreview").style.display = "block";
                };
                reader.readAsDataURL(file);
            }
        }

        // Обработка фото супервизора
        function handleSpecialistPhotoUpload(e) {
            const file = e.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const specialists = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
                    const specialist = specialists.find(s => s.userId === currentUser.id);
                    if (specialist) {
                        specialist.photo = e.target.result;
                        Storage.set(STORAGE_KEYS.SPECIALISTS, specialists);
                        document.getElementById("specialistPhotoPreview").src = specialist.photo;
                        document.getElementById("specialistPhotoPreview").style.display = "block";
                    }
                };
                reader.readAsDataURL(file);
            }
        }

        // Обработка видео супервизора
        function handleSpecialistVideoUpload(e) {
            const file = e.target.files[0];
            if (file && file.type.startsWith('video/')) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const specialists = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
                    const specialist = specialists.find(s => s.userId === currentUser.id);
                    if (specialist) {
                        specialist.video = e.target.result;
                        Storage.set(STORAGE_KEYS.SPECIALISTS, specialists);
                        document.getElementById("specialistVideoPreview").src = specialist.video;
                        document.getElementById("specialistVideoPreview").style.display = "block";
                    }
                };
                reader.readAsDataURL(file);
            }
        }
    </script>
</body>

</html>
```
