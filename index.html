```html
<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Отображение на телефонах-->
    <title>Центр психологов.рф</title>
    <!-- титульник сайта-->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Raleway:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!--Подключение шрифтов-->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!--Подключение иконок-->
    <style>
      :root {
        --primary: #9bdcdd; /* основной цвет*/
        --primary-light: #9bdcdd; /* светлый вариант основного цвета*/
        --primary-dark:#9bdcdd ; /*темный вариант */
        --secondary: #cbefef; /*Вторичный цвет */
        --accent: #cbefef;
        --text:  #0e4547;
        --text-light:  #03383a;
        --background: #fbfcf6;
        --background-alt:#c6e8e9d8;
        --card: #ffffff;
        --shadow: rgba(105, 178, 160, 0.15);
        --transition: all 0.3s ease;
        --error: #e74c3c;
        --success: #2ecc71;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box; /* Сброс стилей браузера */
      }

      body {
        font-family: "Inter", sans-serif; /* Шрифт */
        background: var(--background);
        color: var(--text);
        line-height: 1.7; /* Ширина шрифта */
        overflow-x: hidden; /* Отвечает за отображение содержимого элемента по горизонтали */
      }

      /* Навигация */
      .navbar {
        position: fixed; /* Фиксация шапки */
        top: 0;
        left: 0;
        width: 100%; /* Расширение на весь экран */
        display: flex; /* Дисплей посредине */
        justify-content: space-between;
        align-items: center;
        padding: 1.2rem 5%;
        background: #3a8a8d; /* Градиентный фон */
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        z-index: 1000;
        transition: var(--transition);
      }

      .navbar.scrolled {
        padding: 0.8rem 5%;
        background: #00868851; /* Градиентный фон */
        backdrop-filter: blur(15px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        --primary: #1a4848; /* основной цвет*/
        --primary-light: #1a4848; /* светлый вариант основного цвета*/
        --primary-dark: #1a4848;
      }

      .nav-left {
        display: flex;
        align-items: center;
        gap: 1.5rem;
      }

      .nav-logo {
        font-family: "Raleway", sans-serif;
        font-weight: 600;
        font-size: 1.8rem;
        color: var(--primary-dark);
      }

      .nav-right {
        display: flex;
        align-items: center;
        gap: 1.5rem;
      }

      .nav-auth {
        display: flex;
        gap: 1.5rem;
        align-items: center;
      }

      .nav-logout {
        display: none;
        align-items: center;
      }

      .btn {
        padding: 1rem 2rem;
        border-radius: 50px;
        font-family: "Raleway", sans-serif;
        font-weight: 500;
        font-size: 1rem;
        cursor: pointer;
        transition: var(--transition);
        text-decoration: none;
        display: inline-block;
        text-align: center;
      }

      .btn-login {
        background: transparent;
        color: var(--primary);
        border: 2px solid var(--primary);
      }

      .btn-login:hover {
        background: var(--primary);
        color:#3a8a8d ;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px var(--shadow);
      }

      .btn-register {
        background: var(--primary);
        color:#179da1;
        border: 2px solid var(--primary);
      }

      .btn-register:hover {
        background: var(--primary-light);
        color: var(--primary-dark);
        color:#3a8a8d;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px var(--shadow);
      }

      .menu-toggle {
        font-size: 1.7rem;
        cursor: pointer;
        color: var(--primary-dark);
        z-index: 1001;
        transition: transform 0.3s ease;
      }

      .menu-toggle:hover {
        transform: scale(1.1);
      }

      /* Мобильное меню - справа */
      .mobile-menu {
        position: fixed;
        top: 0;
        right: -100%; /* Изменено на right */
        width: 80%;
        max-width: 350px;
        height: 100vh;
        background: linear-gradient(135deg, var(--card) 0%, var(--accent) 100%);
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        padding-top: 5rem;
        box-shadow: -10px 0 30px rgba(0, 0, 0, 0.15); /* Тень слева */
        transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1); /* Изменено на right */
        z-index: 999;
        border-left: 1px solid var(--secondary);
      }

      .mobile-menu.active {
        right: 0; /* Активное состояние справа */
      }

      .mobile-menu .nav-item {
        font-size: 1.3rem;
        padding: 1.2rem 2.5rem;
        width: 100%;
        text-align: center;
        color:#43a8a8 ;
        transition:  0.3s ease, transform 0.3s ease;
        opacity: 0;
        transform: translateX(30px); /* Анимация с права */
      }

      .mobile-menu.active .nav-item {
        color: #1f9599;
        opacity: 1;
        transform: translateX(0);
      }

      .mobile-menu .nav-item:nth-child(1) { transition-delay: 0.05s; }
      .mobile-menu .nav-item:nth-child(2) { transition-delay: 0.05s; }
      .mobile-menu .nav-item:nth-child(3) { transition-delay: 0.05s; }
      .mobile-menu .nav-item:nth-child(4) { transition-delay: 0.05s; }
      .mobile-menu .nav-item:nth-child(5) { transition-delay: 0.05s; }

      .mobile-menu .nav-item:hover {
        background: var(--primary-light);
        transform: translateX(-5px);
      }

      .mobile-menu .nav-auth {
        flex-direction: column;
        padding: 1.5rem 2.5rem;
        gap: 1.2rem;
        opacity: 0;
        transform: translateX(30px);
        transition: opacity 0.3s ease, transform 0.3s ease;
        transition-delay: 0.35s;
      }

      .mobile-menu.active .nav-auth {
        opacity: 1;
        transform: translateX(0);
      }

      .mobile-menu .nav-logout {
        display: none;
        flex-direction: column;
        padding: 1.5rem 2.5rem;
        opacity: 0;
        transform: translateX(30px);
        transition: opacity 0.3s ease, transform 0.3s ease;
        transition-delay: 0.35s;
      }

      .mobile-menu.active .nav-logout {
        opacity: 1;
        transform: translateX(0);
      }

      /* Overlay для мобильного меню */
      .menu-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.4s ease;
        z-index: 998;
      }

      .menu-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      /* Модальные окна */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 2000;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
      }

      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .modal {
        background: var(--card);
        border-radius: 20px;
        padding: 2.5rem;
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        transform: translateY(30px);
        opacity: 0;
        transition: var(--transition);
        position: relative;
      }

      .modal-overlay.active .modal {
        transform: translateY(0);
        opacity: 1;
      }

      .modal-close {
        position: absolute;
        top: 1.5rem;
        right: 1.5rem;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--text-light);
        transition: var(--transition);
      }

      .modal-close:hover {
        color: var(--primary);
      }

      .modal-title {
        font-family: "Raleway", sans-serif;
        font-weight: 600;
        font-size: 1.8rem;
        margin-bottom: 1.5rem;
        color: var(--text);
        text-align: center;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: var(--text);
      }

      .form-input {
        width: 100%;
        padding: 0.8rem 1.2rem;
        border: 2px solid var(--secondary);
        border-radius: 10px;
        font-family: "Inter", sans-serif;
        font-size: 1rem;
        transition: var(--transition);
      }

      .form-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(155, 220, 221, 0.2);
      }

      .form-input.error {
        border-color: var(--error);
      }

      .form-error {
        color: var(--error);
        font-size: 0.85rem;
        margin-top: 0.3rem;
        display: none;
      }

      .form-error.show {
        display: block;
      }

      .role-selector {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      .role-option {
        flex: 1;
        text-align: center;
        padding: 1rem;
        border: 2px solid var(--secondary);
        border-radius: 10px;
        cursor: pointer;
        transition: var(--transition);
      }

      .role-option:hover {
        border-color: var(--primary-light);
      }

      .role-option.selected {
        border-color: var(--primary);
        background: var(--accent);
      }

      .role-icon {
        font-size: 2rem;
        margin-bottom: 0.5rem;
        color: var(--primary);
      }

      .form-footer {
        text-align: center;
        margin-top: 1.5rem;
      }

      .form-link {
        color: var(--primary);
        text-decoration: none;
        cursor: pointer;
        transition: var(--transition);
      }

      .form-link:hover {
        text-decoration: underline;
      }

      /* Личный кабинет */
      .dashboard {
        display: none;
        padding: 6rem 5% 4rem;
        min-height: 100vh;
      }

      .dashboard-header {
        margin-bottom: 2.5rem;
      }

      .dashboard-title {
        font-family: "Raleway", sans-serif;
        font-weight: 600;
        font-size: 2.2rem;
        color: var(--text);
        margin-bottom: 0.5rem;
      }

      .dashboard-subtitle {
        color: var(--text-light);
        font-size: 1.1rem;
      }

      .dashboard-tabs {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        border-bottom: 2px solid var(--secondary);
        padding-bottom: 1rem;
      }

      .tab-btn {
        padding: 0.8rem 1.5rem;
        background: transparent;
        border: none;
        border-radius: 8px;
        font-family: "Raleway", sans-serif;
        font-weight: 500;
        font-size: 1rem;
        color: var(--text-light);
        cursor: pointer;
        transition: var(--transition);
      }

      .tab-btn.active {
        background: var(--primary);
        color: white;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
        animation: fadeIn 0.5s ease;
      }

      /* Поиск специалистов */
      .search-filters {
        background: var(--card);
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
      }

      .filter-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 1rem;
      }

      .specialists-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
      }

      .specialist-card {
        background: var(--card);
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        transition: var(--transition);
      }

      .specialist-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }

      .specialist-header {
        padding: 1.5rem;
        background: var(--accent);
        text-align: center;
      }

      .specialist-avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
        margin-bottom: 1rem;
        border: 4px solid var(--card);
      }

      .specialist-name {
        font-family: "Raleway", sans-serif;
        font-weight: 600;
        font-size: 1.3rem;
        margin-bottom: 0.3rem;
      }

      .specialist-specialty {
        color: var(--primary-dark);
        font-weight: 500;
      }

      .specialist-body {
        padding: 1.5rem;
      }

      .specialist-info {
        margin-bottom: 1rem;
      }

      .specialist-rating {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
      }

      .rating-stars {
        color: #ffd700;
      }

      .specialist-price {
        font-weight: 600;
        color: var(--primary);
        margin-bottom: 1rem;
      }

      .specialist-footer {
        padding: 0 1.5rem 1.5rem;
      }

      /* Календарь */
      .calendar-container {
        background: var(--card);
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
      }

      .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }

      .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 0.5rem;
      }

      .calendar-day {
        text-align: center;
        padding: 0.5rem;
        border-radius: 8px;
        cursor: pointer;
        transition: var(--transition);
      }

      .calendar-day:hover {
        background: var(--accent);
      }

      .calendar-day.selected {
        background: var(--primary);
        color: white;
      }

      .calendar-day.disabled {
        color: #ccc;
        cursor: not-allowed;
      }

      .time-slots {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 0.5rem;
        margin-top: 1.5rem;
      }

      .time-slot {
        padding: 0.5rem;
        text-align: center;
        border: 1px solid var(--secondary);
        border-radius: 8px;
        cursor: pointer;
        transition: var(--transition);
      }

      .time-slot:hover {
        background: var(--accent);
      }

      .time-slot.selected {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
      }

      .time-slot.booked {
        background: #f5f5f5;
        color: #ccc;
        cursor: not-allowed;
      }

      /* Список клиентов */
      .clients-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
      }

      .client-card {
        background: var(--card);
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        transition: var(--transition);
      }

      .client-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      }

      .client-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1rem;
      }

      .client-avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        object-fit: cover;
      }

      .client-name {
        font-family: "Raleway", sans-serif;
        font-weight: 600;
        font-size: 1.2rem;
      }

      .client-next-session {
        color: var(--primary);
        font-weight: 500;
      }

      .client-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
      }

      /* Дневник клиента */
      .client-journal {
        background: var(--card);
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        margin-bottom: 2rem;
      }

      .journal-entry {
        margin-bottom: 1.5rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid var(--secondary);
      }

      .journal-date {
        font-weight: 600;
        color: var(--primary-dark);
        margin-bottom: 0.5rem;
      }

      .journal-content {
        color: var(--text-light);
      }

      .journal-form textarea {
        width: 100%;
        min-height: 150px;
        padding: 1rem;
        border: 2px solid var(--secondary);
        border-radius: 10px;
        font-family: "Inter", sans-serif;
        resize: vertical;
        transition: var(--transition);
      }

      .journal-form textarea:focus {
        outline: none;
        border-color: var(--primary);
      }

      /* Уведомления */
      .notification-container {
        position: fixed;
        top: 100px;
        right: 20px;
        z-index: 3000;
      }

      .notification {
        background: var(--card);
        border-radius: 10px;
        padding: 1rem 1.5rem;
        margin-bottom: 0.5rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        gap: 0.8rem;
        transform: translateX(100%);
        opacity: 0;
        transition: all 0.3s ease;
      }

      .notification.show {
        transform: translateX(0);
        opacity: 1;
      }

      .notification.hide {
        transform: translateX(100%);
        opacity: 0;
      }

      .notification.success {
        border-left: 4px solid var(--success);
      }

      .notification.error {
        border-left: 4px solid var(--error);
      }

      .notification.info {
        border-left: 4px solid var(--primary);
      }

      .notification-icon {
        font-size: 1.2rem;
      }

      .notification.success .notification-icon {
        color: var(--success);
      }

      .notification.error .notification-icon {
        color: var(--error);
      }

      .notification.info .notification-icon {
        color: var(--primary);
      }

      /* Индикатор загрузки */
      .loader-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 4000;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
      }

      .loader-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .loader {
        width: 50px;
        height: 50px;
        border: 5px solid var(--accent);
        border-top: 5px solid var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      /* Герой секция */
      .hero {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 6rem 5% 4rem;
        background: linear-gradient(
          135deg,
          var(--background-alt) 0%,
          var(--background) 100%
        );
        position: relative;
        overflow: hidden;
      }

      .hero::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%239bdcdd' fill-opacity='0.03' d='M0,128L48,117.3C96,107,192,85,288,112C384,139,480,213,576,218.7C672,224,768,160,864,138.7C960,117,1056,139,1152,149.3C1248,160,1344,160,1392,160L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E");
        background-size: cover;
        background-position: center;
        z-index: 0;
      }

      .hero-content {
        max-width: 1000px;
        position: relative;
        z-index: 1;
      }

      .hero-title {
        font-family: "Raleway", sans-serif;
        font-weight: 600;
        font-size: 3.2rem;
        line-height: 1.2;
        margin-bottom: 1.5rem;
        color: var(--text);
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInUp 1s ease forwards 0.3s;
      }

      .hero-subtitle {
        font-family: "Raleway", sans-serif;
        font-weight: 400;
        font-size: 1.8rem;
        margin-bottom: 2rem;
        color: var(--text-light);
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInUp 1s ease forwards 0.6s;
      }

      .divider {
        width: 180px;
        height: 6px;
        background: var(--primary);
        margin: 0 auto 2.5rem;
        border-radius: 3px;
        opacity: 0;
        transform: scaleX(0);
        animation: scaleIn 0.8s ease forwards 0.9s;
      }

      .hero-description {
        font-family: "Raleway", sans-serif;
        font-size: 1.3rem;
        max-width: 900px;
        margin: 0 auto 3rem;
        color: var(--text-light);
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInUp 1s ease forwards 1.2s;
      }

      /* Особенности */
      .features {
        padding: 5rem 5%;
        background: var(--background);
      }

      .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
      }

      .feature-card {
        background: var(--card);
        border-radius: 20px;
        padding: 2.5rem 2rem;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        transition: var(--transition);
        opacity: 0;
        transform: translateY(30px);
      }

      .feature-card.animate {
        animation: fadeInUp 0.8s ease forwards;
      }

      .feature-card:nth-child(2) {
        animation-delay: 0.2s;
      }
      .feature-card:nth-child(3) {
        animation-delay: 0.4s;
      }

      .feature-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 35px var(--shadow);
      }

      .feature-icon {
        font-size: 3rem;
        color: var(--primary);
        margin-bottom: 1.5rem;
      }

      .feature-title {
        font-family: "Raleway", sans-serif;
        font-weight: 600;
        font-size: 1.5rem;
        margin-bottom: 1rem;
        color: var(--text);
      }

      .feature-description {
        color: var(--text-light);
        font-size: 1.1rem;
      }

      /* Секция помощи */
      .help {
        padding: 5rem 5%;
        background: var(--background-alt);
        position: relative;
      }

      .help::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%23c8ebeb' fill-opacity='0.1' d='M0,128L48,117.3C96,107,192,85,288,112C384,139,480,213,576,218.7C672,224,768,160,864,138.7C960,117,1056,139,1152,149.3C1248,160,1344,160,1392,160L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E");
        background-size: cover;
        background-position: center;
        z-index: 0;
      }

      .section-title {
        font-family: "Raleway", sans-serif;
        font-weight: 700;
        font-size: 2.5rem;
        text-align: center;
        margin-bottom: 3.5rem;
        position: relative;
        z-index: 1;
        color: var(--text);
      }

      .section-title::after {
        content: "";
        position: absolute;
        bottom: -15px;
        left: 50%;
        transform: translateX(-50%);
        width: 80px;
        height: 4px;
        background: var(--primary);
        border-radius: 2px;
      }

      .help-cards {
        display: flex;
        flex-direction: column;
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
        position: relative;
        z-index: 1;
      }

      .help-card {
        background: var(--card);
        border-radius: 20px;
        padding: 2.5rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        transition: var(--transition);
        opacity: 0;
        transform: translateY(30px);
      }

      .help-card.animate {
        animation: fadeInUp 0.8s ease forwards;
      }

      .help-card:nth-child(1) {
        animation-delay: 0.1s;
      }
      .help-card:nth-child(2) {
        animation-delay: 0.2s;
      }
      .help-card:nth-child(3) {
        animation-delay: 0.3s;
      }
      .help-card:nth-child(4) {
        animation-delay: 0.4s;
      }

      .help-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px var(--shadow);
      }

      .help-title {
        font-family: "Raleway", sans-serif;
        font-weight: 600;
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
        color: var(--primary-dark);
        display: flex;
        align-items: center;
        gap: 0.8rem;
      }

      .help-title i {
        color: var(--primary);
        font-size: 1.8rem;
      }

      .help-list {
        list-style: none;
      }

      .help-list li {
        margin-bottom: 0.8rem;
        padding-left: 2rem;
        position: relative;
        font-size: 1.1rem;
        color: var(--text-light);
      }

      .help-list li::before {
        content: "•";
        color: var(--primary);
        font-size: 1.5rem;
        position: absolute;
        left: 0;
        top: -0.4rem;
      }

      /* Футер */
      .footer {
        background: var(--primary-dark);
        color: white;
        padding: 4rem 5% 2rem;
        text-align: center;
      }

      .footer-content {
        max-width: 1200px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        text-align: left;
      }

      .footer-logo {
        font-family: "Raleway", sans-serif;
        font-weight: 700;
        font-size: 1.8rem;
        margin-bottom: 1rem;
        color: var(--primary-light);
      }

      .footer-description {
        margin-bottom: 1.5rem;
        opacity: 0.8;
      }

      .footer-heading {
        font-family: "Raleway", sans-serif;
        font-weight: 600;
        font-size: 1.3rem;
        margin-bottom: 1.5rem;
        color: var(--primary-light);
      }

      .footer-links {
        list-style: none;
      }

      .footer-links li {
        margin-bottom: 0.8rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .footer-links a {
        color: white;
        text-decoration: none;
        opacity: 0.8;
        transition: var(--transition);
      }

      .footer-links a:hover {
        opacity: 1;
        color: var(--primary-light);
      }

      .social-links {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
      }

      .social-links a {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        transition: var(--transition);
      }

      .social-links a:hover {
        background: var(--primary);
        transform: translateY(-3px);
      }

      .copyright {
        margin-top: 3rem;
        padding-top: 1.5rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        opacity: 0.7;
      }

      /* Анимации */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes scaleIn {
        from {
          opacity: 0;
          transform: scaleX(0);
        }
        to {
          opacity: 1;
          transform: scaleX(1);
        }
      }

      /* Адаптивность */
      @media (max-width: 992px) {
        .nav-auth {
          display: none;
        }

        .nav-logout {
          display: none;
        }

        .mobile-menu .nav-auth {
          display: flex;
        }

        .mobile-menu .nav-logout {
          display: flex;
        }

        .role-selector {
          flex-direction: column;
        }

        .features-grid, .help-cards {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .navbar {
          padding: 1rem 5%;
        }

        .hero {
          padding: 5rem 5% 3rem;
        }

        .hero-title {
          font-size: 2.2rem;
        }

        .hero-subtitle {
          font-size: 1.3rem;
        }

        .section-title {
          font-size: 2rem;
        }

        .help-card {
          padding: 2rem 1.5rem;
        }

        .modal {
          padding: 2rem 1.5rem;
        }

        .specialists-grid,
        .clients-list {
          grid-template-columns: 1fr;
        }

        .navbar {
          flex-wrap: wrap;
        }

        .nav-left {
          order: 1;
        }

        .nav-logo {
          order: 2;
          flex: 1;
          text-align: center;
        }

        .nav-right {
          order: 3;
        }
      }

      @media (max-width: 576px) {
        .hero-title {
          font-size: 1.8rem;
        }

        .feature-card,
        .help-card {
          padding: 1.5rem;
        }

        .footer-content {
          grid-template-columns: 1fr;
          text-align: center;
        }

        .social-links {
          justify-content: center;
        }

        .dashboard-tabs {
          flex-wrap: wrap;
        }

        .tab-btn {
          flex: 1;
          min-width: 120px;
          padding: 0.6rem 1rem;
          font-size: 0.9rem;
        }

        .nav-right {
          gap: 1rem;
        }

        .btn {
          padding: 0.5rem 1rem;
          font-size: 0.9rem;
        }
      }

      /* Новые стили для улучшенного календаря, заметок и эмоций */
      .calendar-container {
        background: linear-gradient(135deg, var(--card) 0%, var(--accent) 100%);
        border-radius: 20px;
        padding: 2rem;
        box-shadow: 0 10px 40px var(--shadow);
        overflow: hidden;
        position: relative;
      }

      .calendar-header h3 {
        font-family: "Raleway", sans-serif;
        font-size: 1.8rem;
        color: var(--primary-dark);
        animation: fadeInUp 0.5s ease;
      }

      .calendar-grid {
        gap: 0.8rem;
        margin-top: 1rem;
      }

      .calendar-day {
        background: var(--background-alt);
        border: 1px solid var(--secondary);
        padding: 1rem;
        font-weight: 500;
        transition: transform 0.3s ease, background 0.3s ease;
      }

      .calendar-day:hover {
        transform: scale(1.05);
        background: var(--primary-light);
        color: white;
      }

      .calendar-day.selected {
        background: var(--primary);
        color: white;
        box-shadow: 0 4px 15px rgba(91, 170, 176, 0.3);
        animation: pulse 1s infinite;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      .time-slots {
        margin-top: 2rem;
        gap: 1rem;
      }

      .time-slot {
        background: var(--background-alt);
        border: none;
        box-shadow: 0 4px 10px var(--shadow);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        animation: fadeInUp 0.5s ease;
      }

      .time-slot:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px var(--shadow);
      }

      .time-slot.booked {
        background: linear-gradient(135deg, #ffcccc 0%, #ffb3b3 100%);
        color: var(--error);
        position: relative;
      }

      .time-slot.booked::after {
        content: attr(data-client);
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        background: var(--card);
        padding: 0.5rem 1rem;
        border-radius: 10px;
        box-shadow: 0 4px 15px var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease;
      }

      .time-slot.booked:hover::after {
        opacity: 1;
        visibility: visible;
      }

      /* Стили для заметок и эмоций */
      .notes-modal .modal {
        max-width: 700px;
        padding: 3rem;
      }

      .notes-list {
        margin-bottom: 2rem;
      }

      .note-entry {
        background: var(--accent);
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 1rem;
        box-shadow: 0 4px 15px var(--shadow);
        animation: fadeInUp 0.5s ease;
      }

      .note-date {
        font-weight: 600;
        color: var(--primary-dark);
        margin-bottom: 0.5rem;
      }

      .note-content {
        margin-bottom: 1rem;
      }

      .note-emotions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .emotion-tag {
        background: var(--primary-light);
        color: white;
        padding: 0.3rem 0.8rem;
        border-radius: 20px;
        font-size: 0.85rem;
        animation: scaleIn 0.3s ease;
      }

      .notes-form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .notes-form textarea {
        min-height: 200px;
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: inset 0 2px 10px var(--shadow);
      }

      .emotions-selector {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .emotion-option {
        background: var(--secondary);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .emotion-option.selected {
        background: var(--primary);
        color: white;
      }

      /* Клиентский дневник эмоций */
      .journal-container {
        background: var(--card);
        border-radius: 20px;
        padding: 2rem;
        box-shadow: 0 10px 30px var(--shadow);
      }

      .journal-entry.animate {
        animation: fadeInUp 0.5s ease;
      }

      .journal-content {
        background: var(--accent);
        padding: 1rem;
        border-radius: 10px;
      }

      /* Анимации для элементов интерфейса */
      .fade-in {
        animation: fadeIn 0.5s ease forwards;
      }

      .slide-in-left {
        animation: slideInLeft 0.5s ease forwards;
      }

      .slide-in-right {
        animation: slideInRight 0.5s ease forwards;
      }

      .bounce-in {
        animation: bounceIn 0.6s ease forwards;
      }

      .zoom-in {
        animation: zoomIn 0.4s ease forwards;
      }

      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translateX(-50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes bounceIn {
        0% {
          opacity: 0;
          transform: scale(0.3);
        }
        50% {
          opacity: 1;
          transform: scale(1.05);
        }
        70% {
          transform: scale(0.9);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes zoomIn {
        from {
          opacity: 0;
          transform: scale(0.5);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      /* Стили для модального окна записи */
      .booking-modal .modal {
        max-width: 600px;
      }

      .booking-summary {
        background: var(--accent);
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .booking-detail {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
      }

      .booking-detail strong {
        color: var(--primary-dark);
      }

      /* Стили для модала выбора плана */
      #scheduleChoiceModal .modal {
        text-align: center;
      }

      #scheduleChoiceModal .btn {
        flex: 1;
        min-width: 150px;
      }

      /* Стили для плана */
      .plan-card {
        background: linear-gradient(135deg, var(--accent) 0%, var(--secondary) 100%);
        border-left: 4px solid var(--primary);
      }
    </style>
  </head>
  <body>
    <!-- Навигация -->
    <nav class="navbar">
      <div class="nav-left">
        <div class="nav-logo">Центр психологов</div>
      </div>

      <div class="nav-right">
        <div class="nav-auth">
          <a class="btn btn-login" id="loginBtn">Вход</a>
          <a class="btn btn-register" id="registerBtn">Регистрация</a>
        </div>

        <div class="nav-logout">
          <a class="btn btn-login" id="navLogoutBtn">Выйти</a>
        </div>
        <div class="menu-toggle">
          <i class="fas fa-bars"></i>
        </div>
      </div>

      <div class="mobile-menu">
        <a class="nav-item" href="#services">Услуги</a>
        <a class="nav-item" href="#reviews">Отзывы</a>
        <a class="nav-item" href="#about">О нас</a>
        <a class="nav-item" href="#blog">Блог</a>
        <a class="nav-item" href="#contacts">Контакты</a>
        <div class="nav-auth">
          <a class="btn btn-login" id="mobileLoginBtn">Вход</a>
          <a class="btn btn-register" id="mobileRegisterBtn">Регистрация</a>
        </div>
        <div class="nav-logout" style="display: none;">
          <a class="btn btn-login" id="mobileLogoutBtn">Выйти</a>
        </div>
      </div>

      <div class="menu-overlay"></div>
    </nav>

    <!-- Герой секция -->
    <section class="hero" id="main-content">
      <div class="hero-content">
        <h1 class="hero-title">
          Центр психологов: "Путь к внутреннему равновесию начинается здесь"
        </h1>
        <div class="divider"></div>
        <p class="hero-description">
          Мы создаем пространство, где каждый человек может безопасно и уверенно
          обратиться за психологической помощью, зная, что его примут, поймут и
          профессионально поддержат.
        </p>
      </div>
    </section>

    <!-- Особенности -->
    <section class="features">
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
          <h3 class="feature-title">Доверие и Безопасность</h3>
          <p class="feature-description">
            Создаем доверительную атмосферу, где вы можете быть собой без страха
            осуждения
          </p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-heart"></i>
          </div>
          <h3 class="feature-title">Эмпатия и Открытость</h3>
          <p class="feature-description">
            Мы слушаем, слышим и понимаем ваши переживания, принимая вас без
            условий
          </p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-graduation-cap"></i>
          </div>
          <h3 class="feature-title">Профессионализм и Развитие</h3>
          <p class="feature-description">
            Наши специалисты постоянно совершенствуются, чтобы помочь вам
            наиболее эффективно
          </p>
        </div>
      </div>
    </section>

    <!-- Секция помощи -->
    <section class="help" id="services">
      <h2 class="section-title">Мы поможем, если...</h2>

      <div class="help-cards">
        <div class="help-card">
          <h3 class="help-title">
            <i class="fas fa-child"></i> Вы — заботливый родитель, и:
          </h3>
          <ul class="help-list">
            <li>Ваш ребенок тревожный, замкнутый или раздражительный</li>
            <li>
              Подросток столкнулся с кризисом, агрессией, апатией или потерей
              мотивации
            </li>
            <li>У вас возникли трудности в общении с детьми</li>
            <li>
              Вы не понимаете, как поддержать ребенка в новой ситуации — развод,
              переезд, адаптация
            </li>
          </ul>
        </div>

        <div class="help-card">
          <h3 class="help-title">
            <i class="fas fa-user"></i> Вы — взрослый человек, и:
          </h3>
          <ul class="help-list">
            <li>Чувствуете выгорание, потерю интереса к жизни</li>
            <li>
              Стоите перед сложным выбором, сменой профессии или круга общения
            </li>
            <li>Вас не радуют достижения, хотя "всё вроде есть"</li>
            <li>
              Испытываете внутренний кризис — пустоту, потерю смысла,
              одиночество
            </li>
          </ul>
        </div>

        <div class="help-card">
          <h3 class="help-title">
            <i class="fas fa-hands-helping"></i> Вы столкнулись с утратой, и:
          </h3>
          <ul class="help-list">
            <li>Переживаете потерю близкого человека</li>
            <li>Испытываете боль, вину, злость, отчаяние</li>
            <li>Вам трудно говорить об этом, но молчать невозможно</li>
            <li>Окружающие не понимают, а внутри — боль и тишина</li>
          </ul>
        </div>

        <div class="help-card">
          <h3 class="help-title"><i class="fas fa-hands"></i> И если:</h3>
          <ul class="help-list">
            <li>Вам важно, чтобы вас услышали без осуждения</li>
            <li>Вы ищете профессиональную, бережную поддержку</li>
            <li>
              Вы готовы начать путь к себе — в удобном темпе и в безопасной
              среде
            </li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Футер -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-info">
          <div class="footer-logo">Центр психологов</div>
          <p class="footer-description">
            Пространство, где каждый может получить профессиональную
            психологическую помощь и поддержку.
          </p>
          <div class="social-links">
            <a href="#"><i class="fab fa-vk"></i></a>
            <a href="#"><i class="fab fa-telegram"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-youtube"></i></a>
          </div>
        </div>

        <div class="footer-links-container">
          <h3 class="footer-heading">Навигация</h3>
          <ul class="footer-links">
            <li><a href="#services">Услуги</a></li>
            <li><a href="#reviews">Отзывы</a></li>
            <li><a href="#about">О нас</a></li>
            <li><a href="#blog">Блог</a></li>
            <li><a href="#contacts">Контакты</a></li>
          </ul>
        </div>

        <div class="footer-links-container">
          <h3 class="footer-heading">Контакты</h3>
          <ul class="footer-links">
            <li><i class="fas fa-map-marker-alt"></i> Челябинск</li>
            <li><i class="fas fa-phone"></i> +7 (999) 123-45-67</li>
            <li><i class="fas fa-envelope"></i> info@psy-center.ru</li>
            <li><i class="fas fa-clock"></i> Пн-Пт: 9:00-21:00</li>
          </ul>
        </div>
      </div>

      <div class="copyright">
        &copy; 2025 Центр психологов. Все права защищены.
      </div>
    </footer>

    <!-- Модальное окно входа -->
    <div class="modal-overlay" id="loginModal">
      <div class="modal">
        <span class="modal-close" data-modal="loginModal">&times;</span>
        <h2 class="modal-title">Вход в личный кабинет</h2>
        <form id="loginForm">
          <div class="form-group">
            <label class="form-label" for="loginEmail">Email</label>
            <input
              type="email"
              id="loginEmail"
              class="form-input"
              placeholder="Ваш email"
              required
            />
            <div class="form-error" id="loginEmailError">
              Пожалуйста, введите корректный email
            </div>
          </div>
          <div class="form-group">
            <label class="form-label" for="loginPassword">Пароль</label>
            <input
              type="password"
              id="loginPassword"
              class="form-input"
              placeholder="Ваш пароль"
              required
            />
            <div class="form-error" id="loginPasswordError">
              Пароль должен содержать не менее 6 символов
            </div>
          </div>
          <button type="submit" class="btn btn-register" style="width: 100%">
            Войти
          </button>
          <div class="form-footer">
            <p>
              Еще нет аккаунта?
              <a
                class="form-link"
                data-from="loginModal"
                data-to="registerModal"
                >Зарегистрироваться</a
              >
            </p>
          </div>
        </form>
      </div>
    </div>

    <!-- Модальное окно регистрации -->
    <div class="modal-overlay" id="registerModal">
      <div class="modal">
        <span class="modal-close" data-modal="registerModal">&times;</span>
        <h2 class="modal-title">Регистрация</h2>
        <form id="registerForm">
          <div class="role-selector">
            <div class="role-option" data-role="client">
              <div class="role-icon"><i class="fas fa-user"></i></div>
              <div>Клиент</div>
            </div>
            <div class="role-option" data-role="specialist">
              <div class="role-icon"><i class="fas fa-graduation-cap"></i></div>
              <div>Специалист</div>
            </div>
          </div>
          <input type="hidden" id="userRole" name="role" value="client" />

          <div class="form-group">
            <label class="form-label" for="registerName">Имя</label>
            <input
              type="text"
              id="registerName"
              class="form-input"
              placeholder="Ваше имя"
              required
            />
            <div class="form-error" id="registerNameError">
              Пожалуйста, введите ваше имя
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="registerEmail">Email</label>
            <input
              type="email"
              id="registerEmail"
              class="form-input"
              placeholder="Ваш email"
              required
            />
            <div class="form-error" id="registerEmailError">
              Пожалуйста, введите корректный email
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="registerPassword">Пароль</label>
            <input
              type="password"
              id="registerPassword"
              class="form-input"
              placeholder="Придумайте пароль"
              required
            />
            <div class="form-error" id="registerPasswordError">
              Пароль должен содержать не менее 6 символов
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="registerConfirmPassword"
              >Подтверждение пароля</label
            >
            <input
              type="password"
              id="registerConfirmPassword"
              class="form-input"
              placeholder="Повторите пароль"
              required
            />
            <div class="form-error" id="registerConfirmPasswordError">
              Пароли не совпадают
            </div>
          </div>

          <button type="submit" class="btn btn-register" style="width: 100%">
            Зарегистрироваться
          </button>

          <div class="form-footer">
            <p>
              Уже есть аккаунт?
              <a
                class="form-link"
                data-from="registerModal"
                data-to="loginModal"
                >Войти</a
              >
            </p>
          </div>
        </form>
      </div>
    </div>

    <!-- Личный кабинет клиента -->
    <section class="dashboard" id="clientDashboard">
      <div class="dashboard-header">
        <h1 class="dashboard-title">Личный кабинет</h1>
        <p class="dashboard-subtitle">
          Добро пожаловать, <span id="clientName">Алексей</span>!
        </p>
      </div>

      <div class="dashboard-tabs">
        <button class="tab-btn active" data-tab="search">
          Поиск специалиста
        </button>
        <button class="tab-btn" data-tab="appointments">Мои записи</button>
        <button class="tab-btn" data-tab="journal">Мой дневник</button>
        <button class="tab-btn" data-tab="profile">Профиль</button>
      </div>

      <div class="tab-content active" id="searchTab">
        <div class="search-filters">
          <div class="filter-row">
            <div class="form-group">
              <label class="form-label" for="specialtyFilter"
                >Специализация</label
              >
              <select id="specialtyFilter" class="form-input">
                <option value="">Все специализации</option>
                <option value="Семейный психолог">Семейный психолог</option>
                <option value="Детский психолог">Детский психолог</option>
                <option value="Клинический психолог">Клинический психолог</option>
                <option value="Нейропсихолог">Нейропсихолог</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label" for="priceFilter">Цена за сеанс</label>
              <select id="priceFilter" class="form-input">
                <option value="">Любая</option>
                <option value="1000-2000">1000-2000 руб.</option>
                <option value="2000-3000">2000-3000 руб.</option>
                <option value="3000-5000">3000-5000 руб.</option>
                <option value="5000+">от 5000 руб.</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label" for="ratingFilter">Рейтинг</label>
              <select id="ratingFilter" class="form-input">
                <option value="">Любой</option>
                <option value="4+">от 4 звезд</option>
                <option value="4.5+">от 4.5 звезд</option>
              </select>
            </div>
          </div>

          <div class="filter-row">
            <div class="form-group">
              <label class="form-label" for="searchInput">Поиск по имени</label>
              <input
                type="text"
                id="searchInput"
                class="form-input"
                placeholder="Введите имя специалиста"
              />
            </div>

            <button class="btn btn-register" id="applyFilters">
              Применить фильтры
            </button>
          </div>
        </div>

        <div class="specialists-grid" id="specialistsContainer">
          <!-- Специалисты будут добавляться через JavaScript -->
        </div>
      </div>

      <div class="tab-content" id="appointmentsTab">
        <h2>Мои записи</h2>
        <div id="appointmentsContainer">
          <!-- Записи будут добавляться через JavaScript -->
        </div>
      </div>

      <div class="tab-content" id="journalTab">
        <h2>Мой дневник эмоций</h2>
        <div class="journal-container">
          <div id="journalEntries">
            <!-- Записи дневника будут добавляться через JavaScript -->
          </div>
          <form id="journalForm" class="journal-form">
            <div class="form-group">
              <label class="form-label" for="journalContent"
                >Описание чувств и эмоций</label
              >
              <textarea
                id="journalContent"
                class="form-input"
                placeholder="Опишите свои чувства и эмоции сегодня..."
                required
              ></textarea>
            </div>
            <button type="submit" class="btn btn-register">
              Добавить запись
            </button>
          </form>
        </div>
      </div>

      <div class="tab-content" id="profileTab">
        <h2>Мой профиль</h2>
        <form id="clientProfileForm">
          <div class="form-group">
            <label class="form-label" for="clientProfileName">Имя</label>
            <input
              type="text"
              id="clientProfileName"
              class="form-input"
              value="Алексей"
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="clientProfileEmail">Email</label>
            <input
              type="email"
              id="clientProfileEmail"
              class="form-input"
              value="alexey@example.com"
              readonly
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="clientProfilePhone">Телефон</label>
            <input
              type="tel"
              id="clientProfilePhone"
              class="form-input"
              placeholder="+7 (999) 123-45-67"
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="clientProfileBirthdate"
              >Дата рождения</label
            >
            <input type="date" id="clientProfileBirthdate" class="form-input" />
          </div>

          <button type="submit" class="btn btn-register">
            Сохранить изменения
          </button>
        </form>
      </div>
    </section>

    <!-- Личный кабинет специалиста -->
    <section class="dashboard" id="specialistDashboard">
      <div class="dashboard-header">
        <h1 class="dashboard-title">Кабинет специалиста</h1>
        <p class="dashboard-subtitle">
          Добро пожаловать, <span id="specialistName">Доктор Петрова</span>!
        </p>
      </div>

      <div class="dashboard-tabs">
        <button class="tab-btn active" data-tab="schedule">Расписание</button>
        <button class="tab-btn" data-tab="clients">Мои клиенты</button>
        <button class="tab-btn" data-tab="allAppointments">Все записи</button>
        <button class="tab-btn" data-tab="addClient">Добавить клиента</button>
        <button class="tab-btn" data-tab="specialistProfile">Профиль</button>
      </div>

      <div class="tab-content active" id="scheduleTab">
        <h2>Мое расписание</h2>
        <div class="calendar-container">
          <div class="calendar-header">
            <h3 id="calendarMonth">Июль 2025</h3>
            <div>
              <button class="btn btn-login" id="prevMonth">
                <i class="fas fa-chevron-left"></i>
              </button>
              <button class="btn btn-login" id="nextMonth">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>

          <div class="calendar-grid" id="calendarDays">
            <!-- Дни календаря будут добавляться через JavaScript -->
          </div>

          <div class="time-slots" id="timeSlotsContainer">
            <!-- Временные слоты будут добавляться через JavaScript -->
          </div>
        </div>

        <div class="form-group">
          <button class="btn btn-register" id="saveSchedule">
            Сохранить расписание
          </button>
        </div>
      </div>

      <div class="tab-content" id="clientsTab">
        <h2>Мои клиенты</h2>
        <div class="clients-list" id="clientsContainer">
          <!-- Клиенты будут добавляться через JavaScript -->
        </div>
      </div>

      <div class="tab-content" id="allAppointmentsTab">
        <h2>Все записи</h2>
        <div id="allAppointmentsContainer">
          <!-- Записи будут добавляться через JavaScript -->
        </div>
      </div>

      <div class="tab-content" id="addClientTab">
        <h2>Добавить клиента</h2>
        <form id="addClientForm">
          <div class="form-group">
            <label class="form-label" for="clientFirstName">Имя</label>
            <input
              type="text"
              id="clientFirstName"
              class="form-input"
              required
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="clientLastName">Фамилия</label>
            <input
              type="text"
              id="clientLastName"
              class="form-input"
              required
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="clientEmail">Email</label>
            <input type="email" id="clientEmail" class="form-input" />
          </div>

          <div class="form-group">
            <label class="form-label" for="clientPhone">Телефон</label>
            <input type="tel" id="clientPhone" class="form-input" required />
          </div>

          <div class="form-group">
            <label class="form-label" for="clientBirthdate"
              >Дата рождения</label
            >
            <input type="date" id="clientBirthdate" class="form-input" />
          </div>

          <div class="form-group">
            <label class="form-label" for="clientNotes">Заметки</label>
            <textarea id="clientNotes" class="form-input" rows="4"></textarea>
          </div>

          <button type="submit" class="btn btn-register">
            Добавить клиента
          </button>
        </form>
      </div>

      <div class="tab-content" id="specialistProfileTab">
        <h2>Мой профиль</h2>
        <form id="specialistProfileForm">
          <div class="form-group">
            <label class="form-label" for="specialistProfileName"
              >Имя и фамилия</label
            >
            <input
              type="text"
              id="specialistProfileName"
              class="form-input"
              value="Мария Петрова"
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="specialistProfileEmail">Email</label>
            <input
              type="email"
              id="specialistProfileEmail"
              class="form-input"
              value="petrova@example.com"
              readonly
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="specialistProfileSpecialty"
              >Специализация</label
            >
            <select id="specialistProfileSpecialty" class="form-input">
              <option value="Семейный психолог">Семейный психолог</option>
              <option value="Детский психолог">Детский психолог</option>
              <option value="Клинический психолог" selected>Клинический психолог</option>
              <option value="Нейропсихолог">Нейропсихолог</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label" for="specialistProfileExperience"
              >Опыт работы (лет)</label
            >
            <input
              type="number"
              id="specialistProfileExperience"
              class="form-input"
              value="7"
              min="0"
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="specialistProfileEducation"
              >Образование</label
            >
            <textarea
              id="specialistProfileEducation"
              class="form-input"
              rows="3"
            >МГУ, факультет психологии</textarea>
          </div>

          <div class="form-group">
            <label class="form-label" for="specialistProfileDescription"
              >О себе</label
            >
            <textarea
              id="specialistProfileDescription"
              class="form-input"
              rows="4"
            >Специализируюсь на работе с тревожными расстройствами и депрессией. Использую методы КПТ и гештальт-терапии.</textarea>
          </div>

          <div class="form-group">
            <label class="form-label" for="specialistProfilePrice"
              >Цена за сеанс (руб.)</label
            >
            <input
              type="number"
              id="specialistProfilePrice"
              class="form-input"
              value="3500"
              min="0"
            />
          </div>

          <button type="submit" class="btn btn-register">
            Сохранить изменения
          </button>
        </form>
      </div>
    </section>

    <!-- Модальное окно для заметок специалиста -->
    <div class="modal-overlay notes-modal" id="notesModal">
      <div class="modal">
        <span class="modal-close" data-modal="notesModal">&times;</span>
        <h2 class="modal-title" id="notesTitle">Заметки для клиента</h2>
        <div class="notes-list" id="notesList">
          <!-- Заметки будут добавляться через JS -->
        </div>
        <form id="notesForm" class="notes-form">
          <div class="form-group">
            <label class="form-label" for="noteContent">Заметка занятия</label>
            <textarea
              id="noteContent"
              class="form-input"
              placeholder="Описание занятия, чувств и эмоций..."
              required
            ></textarea>
          </div>
          <div class="form-group">
            <label class="form-label">Эмоции</label>
            <div class="emotions-selector">
              <span class="emotion-option" data-emotion="Тревога">Тревога</span>
              <span class="emotion-option" data-emotion="Радость">Радость</span>
              <span class="emotion-option" data-emotion="Гнев">Гнев</span>
              <span class="emotion-option" data-emotion="Печаль">Печаль</span>
              <span class="emotion-option" data-emotion="Страх">Страх</span>
              <span class="emotion-option" data-emotion="Спокойствие"
                >Спокойствие</span
              >
            </div>
          </div>
          <button type="submit" class="btn btn-register">
            Добавить заметку
          </button>
        </form>
      </div>
    </div>

    <!-- Модальное окно для записи на консультацию -->
    <div class="modal-overlay booking-modal" id="bookingModal">
      <div class="modal">
        <span class="modal-close" data-modal="bookingModal">&times;</span>
        <h2 class="modal-title">Запись на консультацию</h2>
        <div class="booking-summary" id="bookingSummary">
          <!-- Информация о записи будет добавляться через JS -->
        </div>
        <form id="bookingForm">
          <div class="form-group">
            <label class="form-label" for="bookingNotes"
              >Ваши пожелания или вопросы</label
            >
            <textarea
              id="bookingNotes"
              class="form-input"
              rows="3"
              placeholder="Опишите, с какой проблемой вы хотите обратиться..."
            ></textarea>
          </div>
          <button type="submit" class="btn btn-register" style="width: 100%">
            Подтвердить запись
          </button>
        </form>
      </div>
    </div>

    <!-- Модальное окно для записи клиента (специалист) -->
    <div class="modal-overlay" id="bookClientModal">
      <div class="modal">
        <span class="modal-close" data-modal="bookClientModal">&times;</span>
        <h2 class="modal-title">Записать клиента</h2>
        <div class="calendar-container" id="bookCalendarContainer">
          <div class="calendar-header">
            <h3 id="bookCalendarMonth"></h3>
            <div>
              <button class="btn btn-login" id="bookPrevMonth"><i class="fas fa-chevron-left"></i></button>
              <button class="btn btn-login" id="bookNextMonth"><i class="fas fa-chevron-right"></i></button>
            </div>
          </div>
          <div class="calendar-grid" id="bookCalendarDays"></div>
          <div class="time-slots" id="bookTimeSlotsContainer"></div>
        </div>
        <button class="btn btn-register" id="confirmBookClient" style="width: 100%">Подтвердить запись</button>
      </div>
    </div>

    <!-- Модальное окно выбора для расписания -->
    <div class="modal-overlay" id="scheduleChoiceModal">
      <div class="modal">
        <span class="modal-close" data-modal="scheduleChoiceModal">&times;</span>
        <h2 class="modal-title">Что планируете на это время?</h2>
        <div style="display: flex; gap: 1rem; justify-content: center; margin-bottom: 1rem;">
          <button class="btn btn-register" id="bookClientChoice">Записать клиента</button>
          <button class="btn btn-login" id="otherPlanChoice">Другой план</button>
        </div>
      </div>
    </div>

    <!-- Модальное окно записи конкретного клиента из расписания -->
    <div class="modal-overlay" id="bookSpecificClientModal">
      <div class="modal">
        <span class="modal-close" data-modal="bookSpecificClientModal">&times;</span>
        <h2 class="modal-title">Записать клиента на выбранное время</h2>
        <form id="bookSpecificClientForm">
          <div class="form-group">
            <label class="form-label" for="selectClient">Выберите клиента</label>
            <select id="selectClient" class="form-input" required>
              <!-- Опции добавляются динамически -->
            </select>
          </div>
          <div class="booking-summary" id="selectedSlotInfo">
            <!-- Информация о слоте -->
          </div>
          <button type="submit" class="btn btn-register" style="width: 100%">Записать</button>
        </form>
      </div>
    </div>

    <!-- Модальное окно другого плана -->
    <div class="modal-overlay" id="otherPlanModal">
      <div class="modal">
        <span class="modal-close" data-modal="otherPlanModal">&times;</span>
        <h2 class="modal-title">Другой план</h2>
        <form id="otherPlanForm">
          <div class="form-group">
            <label class="form-label" for="planTitle">Название плана</label>
            <input type="text" id="planTitle" class="form-input" required />
          </div>
          <div class="form-group">
            <label class="form-label" for="planDescription">Описание</label>
            <textarea id="planDescription" class="form-input" rows="3" required></textarea>
          </div>
          <div class="booking-summary" id="selectedPlanSlotInfo">
            <!-- Информация о слоте -->
          </div>
          <button type="submit" class="btn btn-register" style="width: 100%">Добавить план</button>
        </form>
      </div>
    </div>

    <!-- Контейнер для уведомлений -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Индикатор загрузки -->
    <div class="loader-overlay" id="loaderOverlay">
      <div class="loader"></div>
    </div>

    <script>
      // Система хранения данных
      const Storage = {
        // Получение данных из localStorage
        get: (key) => {
          const data = localStorage.getItem(key);
          return data ? JSON.parse(data) : null;
        },

        // Сохранение данных в localStorage
        set: (key, data) => {
          localStorage.setItem(key, JSON.stringify(data));
        },

        // Удаление данных из localStorage
        remove: (key) => {
          localStorage.removeItem(key);
        },

        // Очистка всех данных
        clear: () => {
          localStorage.clear();
        },
      };

      // Ключи для хранения данных
      const STORAGE_KEYS = {
        USERS: "psycenter_users",
        SPECIALISTS: "psycenter_specialists",
        APPOINTMENTS: "psycenter_appointments",
        CLIENTS: "psycenter_clients",
        JOURNALS: "psycenter_journals",
        NOTES: "psycenter_notes",
        CURRENT_USER: "psycenter_current_user",
      };

      // Инициализация данных при первом запуске
      function initializeData() {
        // Проверяем, инициализированы ли уже данные
        if (!Storage.get(STORAGE_KEYS.USERS)) {
          // Создаем тестовых пользователей
          const users = [
            {
              id: 1,
              name: "Алексей Козлов",
              email: "client@example.com",
              password: "password123",
              role: "client",
              phone: "+7 (999) 123-45-67",
              birthdate: "1990-05-15",
            },
            {
              id: 2,
              name: "Мария Петрова",
              email: "specialist@example.com",
              password: "password123",
              role: "specialist",
              specialty: "Клинический психолог",
              experience: 7,
              education: "МГУ, факультет психологии",
              description:
                "Специализируюсь на работе с тревожными расстройствами и депрессией. Использую методы КПТ и гештальт-терапии.",
              price: 3500,
            },
          ];

          Storage.set(STORAGE_KEYS.USERS, users);
        }

        if (!Storage.get(STORAGE_KEYS.SPECIALISTS)) {
          // Создаем тестовых специалистов
          const specialists = [
            {
              id: 1,
              name: "Мария Петрова",
              specialty: "Клинический психолог",
              experience: 7,
              rating: 4.8,
              reviews: 42,
              price: 3500,
              avatar: "https://randomuser.me/api/portraits/women/12.jpg",
              description:
                "Специализируюсь на работе с тревожными расстройствами и депрессией. Использую методы КПТ и гештальт-терапии.",
              userId: 2,
            },
            {
              id: 2,
              name: "Иван Сидоров",
              specialty: "Семейный психолог",
              experience: 5,
              rating: 4.6,
              reviews: 28,
              price: 3000,
              avatar: "https://randomuser.me/api/portraits/men/32.jpg",
              description:
                "Помогаю парам наладить отношения, решить конфликты и улучшить взаимопонимание.",
              userId: null,
            },
            {
              id: 3,
              name: "Ольга Иванова",
              specialty: "Детский психолог",
              experience: 9,
              rating: 4.9,
              reviews: 56,
              price: 4000,
              avatar: "https://randomuser.me/api/portraits/women/45.jpg",
              description:
                "Работаю с детьми и подростками. Помогаю решить проблемы поведения, обучения и социализации.",
              userId: null,
            },
          ];

          Storage.set(STORAGE_KEYS.SPECIALISTS, specialists);
        }

        if (!Storage.get(STORAGE_KEYS.APPOINTMENTS)) {
          Storage.set(STORAGE_KEYS.APPOINTMENTS, []);
        }

        if (!Storage.get(STORAGE_KEYS.CLIENTS)) {
          Storage.set(STORAGE_KEYS.CLIENTS, []);
        }

        if (!Storage.get(STORAGE_KEYS.JOURNALS)) {
          Storage.set(STORAGE_KEYS.JOURNALS, []);
        }

        if (!Storage.get(STORAGE_KEYS.NOTES)) {
          Storage.set(STORAGE_KEYS.NOTES, []);
        }
      }

      // Данные для демонстрации
      let specialistsData = [];
      let appointmentsData = [];
      let clientsData = [];
      let journalData = [];
      let notesData = [];

      // Календарные данные
      let currentMonth = new Date().getMonth();
      let currentYear = new Date().getFullYear();

      let bookings = {};

      // Текущий пользователь
      let currentUser = null;

      // Основной код приложения
      document.addEventListener("DOMContentLoaded", function () {
        // Инициализация данных
        initializeData();
        loadData();

        // Проверяем, есть ли активный пользователь
        const savedUser = Storage.get(STORAGE_KEYS.CURRENT_USER);
        if (savedUser) {
          currentUser = savedUser;
          if (currentUser.role === "specialist") {
            showDashboard("specialist");
          } else {
            showDashboard("client");
          }
        }

        // Мобильное меню
        const menuToggle = document.querySelector(".menu-toggle");
        const mobileMenu = document.querySelector(".mobile-menu");
        const menuOverlay = document.querySelector(".menu-overlay");
        const navItems = document.querySelectorAll(".mobile-menu .nav-item");
        const mobileLoginBtn = document.getElementById("mobileLoginBtn");
        const mobileRegisterBtn = document.getElementById("mobileRegisterBtn");
        const mobileLogoutBtn = document.getElementById("mobileLogoutBtn");

        function toggleMenu() {
          const isActive = mobileMenu.classList.toggle("active");
          menuOverlay.classList.toggle("active");
          const icon = menuToggle.querySelector("i");
          icon.classList.toggle("fa-bars");
          icon.classList.toggle("fa-times");

          // Показать/скрыть кнопки авторизации в зависимости от состояния пользователя
          if (currentUser) {
            mobileMenu.querySelector(".nav-auth").style.display = "none";
            mobileMenu.querySelector(".nav-logout").style.display = "flex";
          } else {
            mobileMenu.querySelector(".nav-auth").style.display = "flex";
            mobileMenu.querySelector(".nav-logout").style.display = "none";
          }
        }

        function closeMenu() {
          mobileMenu.classList.remove("active");
          menuOverlay.classList.remove("active");
          const icon = menuToggle.querySelector("i");
          icon.classList.add("fa-bars");
          icon.classList.remove("fa-times");
        }

        menuToggle.addEventListener("click", toggleMenu);
        menuOverlay.addEventListener("click", closeMenu);

        navItems.forEach((item) => {
          item.addEventListener("click", closeMenu);
        });

        if (mobileLoginBtn) {
          mobileLoginBtn.addEventListener("click", () => {
            closeMenu();
            openModal("loginModal");
          });
        }

        if (mobileRegisterBtn) {
          mobileRegisterBtn.addEventListener("click", () => {
            closeMenu();
            openModal("registerModal");
          });
        }

        if (mobileLogoutBtn) {
          mobileLogoutBtn.addEventListener("click", () => {
            closeMenu();
            logout();
          });
        }

        // Инициализация
        initModals();
        initAuth();
        initDashboard();
        initSpecialists();
        initCalendar();
        initNotifications();
        initNotes();
        initJournal();
        initBooking();
        initSpecialistAppointments();
        initBookClient();
        initScheduleChoice(); // Новая инициализация для выбора в расписании

        // Анимация навигации при прокрутке
        window.addEventListener("scroll", function () {
          const navbar = document.querySelector(".navbar");
          if (window.scrollY > 50) {
            navbar.classList.add("scrolled");
          } else {
            navbar.classList.remove("scrolled");
          }

          // Анимация карточек при прокрутке
          const featureCards = document.querySelectorAll(".feature-card");
          const helpCards = document.querySelectorAll(".help-card");
          animateOnScroll(featureCards, "animate");
          animateOnScroll(helpCards, "animate");
        });

        // Функция для анимации при прокрутке
        function animateOnScroll(elements, className) {
          elements.forEach((element) => {
            const position = element.getBoundingClientRect();
            if (position.top < window.innerHeight - 100) {
              element.classList.add(className);
            }
          });
        }

        // Инициализация анимации при загрузке
        const featureCards = document.querySelectorAll(".feature-card");
        const helpCards = document.querySelectorAll(".help-card");
        animateOnScroll(featureCards, "animate");
        animateOnScroll(helpCards, "animate");

        // Плавная прокрутка для якорных ссылок
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener("click", function (e) {
            e.preventDefault();
            const targetId = this.getAttribute("href");
            if (targetId === "#") return;

            const targetElement = document.querySelector(targetId);
            if (targetElement) {
              window.scrollTo({
                top: targetElement.offsetTop - 80,
                behavior: "smooth",
              });

              // Закрыть мобильное меню после клика
              if (mobileMenu.classList.contains("active")) {
                closeMenu();
              }
            }
          });
        });
      });

      // Инициализация выбора в расписании
      function initScheduleChoice() {
        document.getElementById("bookClientChoice").addEventListener("click", handleBookClientChoice);
        document.getElementById("otherPlanChoice").addEventListener("click", handleOtherPlanChoice);
        document.getElementById("bookSpecificClientForm").addEventListener("submit", handleSpecificClientBooking);
        document.getElementById("otherPlanForm").addEventListener("submit", handleAddPlan);
      }

      function handleBookClientChoice() {
        const day = document.getElementById("scheduleChoiceModal").getAttribute("data-day");
        const time = document.getElementById("scheduleChoiceModal").getAttribute("data-time");
        closeModal("scheduleChoiceModal");

        // Populate select
        const select = document.getElementById("selectClient");
        select.innerHTML = "";
        clientsData.forEach((client) => {
          const option = document.createElement("option");
          option.value = client.id;
          option.textContent = client.name;
          select.appendChild(option);
        });

        // Set slot info
        document.getElementById("selectedSlotInfo").innerHTML = `
          <div class="booking-detail">
            <strong>Дата:</strong> <span>${day} ${getMonthName(currentMonth)} ${currentYear}</span>
          </div>
          <div class="booking-detail">
            <strong>Время:</strong> <span>${time}</span>
          </div>
        `;

        // Set data
        document.getElementById("bookSpecificClientModal").setAttribute("data-day", day);
        document.getElementById("bookSpecificClientModal").setAttribute("data-time", time);

        openModal("bookSpecificClientModal");
      }

      function handleSpecificClientBooking(e) {
        e.preventDefault();
        const clientId = parseInt(document.getElementById("selectClient").value);
        const day = parseInt(document.getElementById("bookSpecificClientModal").getAttribute("data-day"));
        const time = document.getElementById("bookSpecificClientModal").getAttribute("data-time");
        const client = clientsData.find((c) => c.id === clientId);
        const specialist = specialistsData.find((s) => s.userId === currentUser.id);

        if (!client || !specialist) {
          showNotification("Ошибка: клиент или специалист не найден", "error");
          return;
        }

        const newAppointment = {
          id: Date.now(),
          type: "client",
          clientId: client.id,
          clientName: client.name,
          specialistId: specialist.id,
          specialistName: specialist.name,
          dateDay: day,
          dateMonth: currentMonth + 1,
          dateYear: currentYear,
          time: time,
          status: "confirmed",
          notes: "",
          createdAt: new Date().toISOString(),
        };

        const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
        appointments.push(newAppointment);
        Storage.set(STORAGE_KEYS.APPOINTMENTS, appointments);

        appointmentsData.push(newAppointment);
        updateBookingsFromAppointments();

        closeModal("bookSpecificClientModal");
        showNotification("Клиент записан на консультацию", "success");
        renderCalendar();
      }

      function handleOtherPlanChoice() {
        const day = document.getElementById("scheduleChoiceModal").getAttribute("data-day");
        const time = document.getElementById("scheduleChoiceModal").getAttribute("data-time");
        closeModal("scheduleChoiceModal");

        // Set slot info
        document.getElementById("selectedPlanSlotInfo").innerHTML = `
          <div class="booking-detail">
            <strong>Дата:</strong> <span>${day} ${getMonthName(currentMonth)} ${currentYear}</span>
          </div>
          <div class="booking-detail">
            <strong>Время:</strong> <span>${time}</span>
          </div>
        `;

        // Set data
        document.getElementById("otherPlanModal").setAttribute("data-day", day);
        document.getElementById("otherPlanModal").setAttribute("data-time", time);

        openModal("otherPlanModal");
      }

      function handleAddPlan(e) {
        e.preventDefault();
        const title = document.getElementById("planTitle").value.trim();
        const desc = document.getElementById("planDescription").value.trim();
        const day = parseInt(document.getElementById("otherPlanModal").getAttribute("data-day"));
        const time = document.getElementById("otherPlanModal").getAttribute("data-time");
        const specialist = specialistsData.find((s) => s.userId === currentUser.id);

        if (!title || !desc || !specialist) {
          showNotification("Заполните все поля", "error");
          return;
        }

        const newAppointment = {
          id: Date.now(),
          type: "plan",
          planTitle: title,
          planDescription: desc,
          specialistId: specialist.id,
          specialistName: specialist.name,
          dateDay: day,
          dateMonth: currentMonth + 1,
          dateYear: currentYear,
          time: time,
          status: "confirmed",
          notes: "",
          createdAt: new Date().toISOString(),
        };

        const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
        appointments.push(newAppointment);
        Storage.set(STORAGE_KEYS.APPOINTMENTS, appointments);

        appointmentsData.push(newAppointment);
        updateBookingsFromAppointments();

        document.getElementById("otherPlanForm").reset();
        closeModal("otherPlanModal");
        showNotification("План добавлен", "success");
        renderCalendar();
      }

      // Загрузка данных из хранилища
      function loadData() {
        specialistsData = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
        appointmentsData = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
        clientsData = Storage.get(STORAGE_KEYS.CLIENTS) || [];
        journalData = Storage.get(STORAGE_KEYS.JOURNALS) || [];
        notesData = Storage.get(STORAGE_KEYS.NOTES) || [];

        // Обновляем bookings из appointmentsData
        updateBookingsFromAppointments();
      }

      // Обновление данных о бронированиях из appointmentsData
      function updateBookingsFromAppointments() {
        bookings = {};

        appointmentsData.forEach((appointment) => {
          if (
            appointment.status === "confirmed" ||
            appointment.status === "pending"
          ) {
            const dateKey = `${appointment.dateYear}-${appointment.dateMonth}-${appointment.dateDay}`;

            if (!bookings[dateKey]) {
              bookings[dateKey] = {};
            }

            if (appointment.type === "plan") {
              bookings[dateKey][appointment.time] = `План: ${appointment.planTitle}`;
            } else {
              bookings[dateKey][appointment.time] = appointment.clientName;
            }
          }
        });
      }

      // Инициализация модальных окон
      function initModals() {
        // Открытие модальных окон
        document.getElementById("loginBtn").addEventListener("click", () => {
          openModal("loginModal");
        });

        document.getElementById("registerBtn").addEventListener("click", () => {
          openModal("registerModal");
        });

        // Закрытие модальных окон
        document.querySelectorAll(".modal-close").forEach((closeBtn) => {
          closeBtn.addEventListener("click", function () {
            const modalId = this.getAttribute("data-modal");
            closeModal(modalId);
          });
        });

        // Переключение между модальными окнами
        document.querySelectorAll(".form-link").forEach((link) => {
          link.addEventListener("click", function () {
            const fromModal = this.getAttribute("data-from");
            const toModal = this.getAttribute("data-to");
            closeModal(fromModal);
            openModal(toModal);
          });
        });

        // Выбор роли при регистрации
        document.querySelectorAll(".role-option").forEach((option) => {
          option.addEventListener("click", function () {
            document.querySelectorAll(".role-option").forEach((opt) => {
              opt.classList.remove("selected");
            });
            this.classList.add("selected");
            document.getElementById("userRole").value =
              this.getAttribute("data-role");
          });
        });

        // Обработка форм
        document
          .getElementById("loginForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            handleLogin();
          });

        document
          .getElementById("registerForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            handleRegistration();
          });
      }

      // Открытие модального окна
      function openModal(modalId) {
        document.getElementById(modalId).classList.add("active");
        document.body.style.overflow = "hidden";
      }

      // Закрытие модального окна
      function closeModal(modalId) {
        document.getElementById(modalId).classList.remove("active");
        document.body.style.overflow = "auto";
      }

      // Обработка входа
      function handleLogin() {
        showLoader();

        const email = document.getElementById("loginEmail").value;
        const password = document.getElementById("loginPassword").value;
        let isValid = true;

        // Валидация email
        if (!validateEmail(email)) {
          document.getElementById("loginEmailError").classList.add("show");
          isValid = false;
        } else {
          document.getElementById("loginEmailError").classList.remove("show");
        }

        // Валидация пароля
        if (password.length < 6) {
          document.getElementById("loginPasswordError").classList.add("show");
          isValid = false;
        } else {
          document
            .getElementById("loginPasswordError")
            .classList.remove("show");
        }

        if (!isValid) {
          hideLoader();
          showNotification("Пожалуйста, исправьте ошибки в форме", "error");
          return;
        }

        // Поиск пользователя в базе
        const users = Storage.get(STORAGE_KEYS.USERS) || [];
        const user = users.find(
          (u) => u.email === email && u.password === password
        );

        if (!user) {
          hideLoader();
          showNotification("Неверный email или пароль", "error");
          return;
        }

        // Сохраняем текущего пользователя
        currentUser = user;
        Storage.set(STORAGE_KEYS.CURRENT_USER, user);

        // Имитация запроса к серверу
        setTimeout(() => {
          hideLoader();
          closeModal("loginModal");

          if (user.role === "specialist") {
            showDashboard("specialist");
            showNotification("Вход выполнен успешно!", "success");
          } else {
            showDashboard("client");
            showNotification("Вход выполнен успешно!", "success");
          }
        }, 500);
      }

      // Обработка регистрации
      function handleRegistration() {
        showLoader();

        const name = document.getElementById("registerName").value;
        const email = document.getElementById("registerEmail").value;
        const password = document.getElementById("registerPassword").value;
        const confirmPassword = document.getElementById(
          "registerConfirmPassword"
        ).value;
        const role = document.getElementById("userRole").value;

        let isValid = true;

        // Валидация имени
        if (name.trim() === "") {
          document.getElementById("registerNameError").classList.add("show");
          isValid = false;
        } else {
          document.getElementById("registerNameError").classList.remove("show");
        }

        // Валидация email
        if (!validateEmail(email)) {
          document.getElementById("registerEmailError").classList.add("show");
          isValid = false;
        } else {
          document
            .getElementById("registerEmailError")
            .classList.remove("show");
        }

        // Валидация пароля
        if (password.length < 6) {
          document
            .getElementById("registerPasswordError")
            .classList.add("show");
          isValid = false;
        } else {
          document
            .getElementById("registerPasswordError")
            .classList.remove("show");
        }

        // Проверка совпадения паролей
        if (password !== confirmPassword) {
          document
            .getElementById("registerConfirmPasswordError")
            .classList.add("show");
          isValid = false;
        } else {
          document
            .getElementById("registerConfirmPasswordError")
            .classList.remove("show");
        }

        if (!isValid) {
          hideLoader();
          showNotification("Пожалуйста, исправьте ошибки в форме", "error");
          return;
        }

        // Проверяем, нет ли уже пользователя с таким email
        const users = Storage.get(STORAGE_KEYS.USERS) || [];
        if (users.find((u) => u.email === email)) {
          hideLoader();
          showNotification(
            "Пользователь с таким email уже существует",
            "error"
          );
          return;
        }

        // Создаем нового пользователя
        const newUser = {
          id: Date.now(),
          name,
          email,
          password,
          role,
          phone: "",
          birthdate: "",
        };

        users.push(newUser);
        Storage.set(STORAGE_KEYS.USERS, users);

        // Если это специалист, создаем запись в таблице специалистов
        if (role === "specialist") {
          const specialists = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
          const newSpecialist = {
            id: Date.now(),
            name,
            specialty: "Клинический психолог",
            experience: 0,
            rating: 0,
            reviews: 0,
            price: 3000,
            avatar:
              "https://randomuser.me/api/portraits/" +
              (Math.random() > 0.5 ? "men" : "women") +
              "/" +
              Math.floor(Math.random() * 50) +
              ".jpg",
            description: "Новый специалист",
            userId: newUser.id,
          };

          specialists.push(newSpecialist);
          Storage.set(STORAGE_KEYS.SPECIALISTS, specialists);
        }

        // Сохраняем текущего пользователя
        currentUser = newUser;
        Storage.set(STORAGE_KEYS.CURRENT_USER, newUser);

        setTimeout(() => {
          hideLoader();
          closeModal("registerModal");

          if (role === "specialist") {
            showDashboard("specialist");
          } else {
            showDashboard("client");
          }

          showNotification("Регистрация прошла успешно!", "success");
        }, 500);
      }

      // Валидация email
      function validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      }

      // Показать/скрыть личный кабинет
      function showDashboard(type) {
        document.getElementById("main-content").style.display = "none";
        document.querySelector(".features").style.display = "none";
        document.querySelector(".help").style.display = "none";
        document.querySelector(".footer").style.display = "none";

        if (type === "client") {
          document.getElementById("clientDashboard").style.display = "block";
          document.getElementById("specialistDashboard").style.display = "none";
          document.getElementById("clientName").textContent = currentUser.name;
          document.getElementById("clientProfileName").value = currentUser.name;
          document.getElementById("clientProfileEmail").value =
            currentUser.email;
          document.getElementById("clientProfilePhone").value =
            currentUser.phone || "";
          document.getElementById("clientProfileBirthdate").value =
            currentUser.birthdate || "";
          loadUserAppointments();
          renderAppointments();
        } else {
          document.getElementById("clientDashboard").style.display = "none";
          document.getElementById("specialistDashboard").style.display = "block";
          const specialists = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
          const specialist = specialists.find(
            (s) => s.userId === currentUser.id
          );
          if (specialist) {
            document.getElementById("specialistName").textContent =
              specialist.name;
            document.getElementById("specialistProfileName").value =
              specialist.name;
            document.getElementById("specialistProfileEmail").value =
              currentUser.email;
            document.getElementById("specialistProfileSpecialty").value =
              specialist.specialty || "Клинический психолог";
            document.getElementById("specialistProfileExperience").value =
              specialist.experience || 0;
            document.getElementById("specialistProfileEducation").value =
              specialist.education || "";
            document.getElementById("specialistProfileDescription").value =
              specialist.description || "";
            document.getElementById("specialistProfilePrice").value =
              specialist.price || 3000;
          }
          loadSpecialistClients();
          renderClients();
        }

        // Обновляем видимость элементов навигации
        document.querySelector(".nav-auth").style.display = "none";
        document.querySelector(".nav-logout").style.display = "flex";
        window.scrollTo(0, 0);
      }

      // Загрузка записей пользователя
      function loadUserAppointments() {
        appointmentsData = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
        appointmentsData = appointmentsData.filter(
          (a) => a.clientId === currentUser.id && a.type === "client"
        );
      }

      // Загрузка клиентов специалиста
      function loadSpecialistClients() {
        // Для упрощения будем считать, что все пользователи с ролью client - клиенты
        const users = Storage.get(STORAGE_KEYS.USERS) || [];
        clientsData = users.filter((u) => u.role === "client");

        // Добавляем информацию о записях
        const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];

        clientsData.forEach((client) => {
          const clientAppointments = appointments.filter(
            (a) => a.clientId === client.id && a.status === "confirmed" && a.type === "client"
          );
          client.nextSession =
            clientAppointments.length > 0
              ? formatAppointmentDate(clientAppointments[0])
              : "Нет запланированных сеансов";

          // Загружаем заметки для клиента
          client.notes = notesData.filter((n) => n.clientId === client.id);
        });
      }

      // Форматирование даты записи
      function formatAppointmentDate(appointment) {
        const months = [
          "января",
          "февраля",
          "марта",
          "апреля",
          "мая",
          "июня",
          "июля",
          "августа",
          "сентября",
          "октября",
          "ноября",
          "декабря",
        ];
        return `${appointment.dateDay} ${months[appointment.dateMonth - 1]} ${
          appointment.dateYear
        }, ${appointment.time}`;
      }

      // Инициализация личного кабинета
      function initAuth() {
        // Выход из системы
        document.getElementById("navLogoutBtn").addEventListener("click", function () {
          logout();
        });

        // Переключение вкладок в кабинете клиента
        document
          .querySelectorAll("#clientDashboard .tab-btn")
          .forEach((btn) => {
            btn.addEventListener("click", function () {
              const tabId = this.getAttribute("data-tab");
              switchClientTab(tabId);
            });
          });

        // Переключение вкладок в кабинете специалиста
        document
          .querySelectorAll("#specialistDashboard .tab-btn")
          .forEach((btn) => {
            btn.addEventListener("click", function () {
              const tabId = this.getAttribute("data-tab");
              switchSpecialistTab(tabId);
            });
          });

        // Сохранение профиля клиента
        document
          .getElementById("clientProfileForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            saveClientProfile();
          });

        // Сохранение профиля специалиста
        document
          .getElementById("specialistProfileForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            saveSpecialistProfile();
          });

        // Добавление клиента
        document
          .getElementById("addClientForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            addClient();
          });
      }

      // Сохранение профиля клиента
      function saveClientProfile() {
        showLoader();

        const name = document.getElementById("clientProfileName").value;
        const phone = document.getElementById("clientProfilePhone").value;
        const birthdate = document.getElementById(
          "clientProfileBirthdate"
        ).value;

        // Обновляем данные пользователя
        const users = Storage.get(STORAGE_KEYS.USERS) || [];
        const userIndex = users.findIndex((u) => u.id === currentUser.id);

        if (userIndex !== -1) {
          users[userIndex].name = name;
          users[userIndex].phone = phone;
          users[userIndex].birthdate = birthdate;

          Storage.set(STORAGE_KEYS.USERS, users);

          // Обновляем текущего пользователя
          currentUser = users[userIndex];
          Storage.set(STORAGE_KEYS.CURRENT_USER, currentUser);

          document.getElementById("clientName").textContent = name;
        }

        setTimeout(() => {
          hideLoader();
          showNotification("Профиль успешно обновлен", "success");
        }, 500);
      }

      // Сохранение профиля специалиста
      function saveSpecialistProfile() {
        showLoader();

        const name = document.getElementById("specialistProfileName").value;
        const specialty = document.getElementById(
          "specialistProfileSpecialty"
        ).value;
        const experience = document.getElementById(
          "specialistProfileExperience"
        ).value;
        const education = document.getElementById(
          "specialistProfileEducation"
        ).value;
        const description = document.getElementById(
          "specialistProfileDescription"
        ).value;
        const price = document.getElementById("specialistProfilePrice").value;

        // Обновляем данные пользователя
        const users = Storage.get(STORAGE_KEYS.USERS) || [];
        const userIndex = users.findIndex((u) => u.id === currentUser.id);

        if (userIndex !== -1) {
          users[userIndex].name = name;
          Storage.set(STORAGE_KEYS.USERS, users);

          // Обновляем текущего пользователя
          currentUser = users[userIndex];
          Storage.set(STORAGE_KEYS.CURRENT_USER, currentUser);

          document.getElementById("specialistName").textContent = name;
        }

        // Обновляем данные специалиста
        const specialists = Storage.get(STORAGE_KEYS.SPECIALISTS) || [];
        const specialistIndex = specialists.findIndex(
          (s) => s.userId === currentUser.id
        );

        if (specialistIndex !== -1) {
          specialists[specialistIndex].name = name;
          specialists[specialistIndex].specialty = specialty;
          specialists[specialistIndex].experience = experience;
          specialists[specialistIndex].education = education;
          specialists[specialistIndex].description = description;
          specialists[specialistIndex].price = price;

          Storage.set(STORAGE_KEYS.SPECIALISTS, specialists);
        }

        setTimeout(() => {
          hideLoader();
          showNotification("Профиль успешно обновлен", "success");
        }, 500);
      }

      // Добавление клиента
      function addClient() {
        showLoader();

        const firstName = document.getElementById("clientFirstName").value;
        const lastName = document.getElementById("clientLastName").value;
        const email = document.getElementById("clientEmail").value;
        const phone = document.getElementById("clientPhone").value;
        const birthdate = document.getElementById("clientBirthdate").value;
        const notes = document.getElementById("clientNotes").value;

        // Создаем нового пользователя (клиента)
        const users = Storage.get(STORAGE_KEYS.USERS) || [];
        const newUser = {
          id: Date.now(),
          name: `${firstName} ${lastName}`,
          email: email || `client${Date.now()}@example.com`,
          password: "tempPassword", // В реальном приложении нужно генерировать временный пароль
          role: "client",
          phone: phone,
          birthdate: birthdate,
        };

        users.push(newUser);
        Storage.set(STORAGE_KEYS.USERS, users);

        // Добавляем клиента в список клиентов специалиста
        const clients = Storage.get(STORAGE_KEYS.CLIENTS) || [];
        clients.push({
          id: newUser.id,
          specialistId: currentUser.id,
          notes: notes,
        });

        Storage.set(STORAGE_KEYS.CLIENTS, clients);

        setTimeout(() => {
          hideLoader();
          document.getElementById("addClientForm").reset();
          showNotification("Клиент успешно добавлен", "success");

          // Обновляем список клиентов
          loadSpecialistClients();
          renderClients();
        }, 500);
      }

      // Выход из системы
      function logout() {
        showLoader();

        setTimeout(() => {
          hideLoader();

          // Удаляем текущего пользователя
          currentUser = null;
          Storage.remove(STORAGE_KEYS.CURRENT_USER);

          // Скрыть личные кабинеты
          document.getElementById("clientDashboard").style.display = "none";
          document.getElementById("specialistDashboard").style.display = "none";

          // Показать основное содержимое
          document.getElementById("main-content").style.display = "flex";
          document.querySelector(".features").style.display = "block";
          document.querySelector(".help").style.display = "block";
          document.querySelector(".footer").style.display = "block";

          // Обновляем navbar: показываем menu и auth, скрываем logout
          document.querySelector(".nav-auth").style.display = "flex";
          document.querySelector(".nav-logout").style.display = "none";

          showNotification("Вы вышли из системы", "info");
        }, 500);
      }

      // Переключение вкладок в кабинете клиента
      function switchClientTab(tabId) {
        // Деактивировать все кнопки
        document
          .querySelectorAll("#clientDashboard .tab-btn")
          .forEach((btn) => {
            btn.classList.remove("active");
          });

        // Скрыть все вкладки
        document
          .querySelectorAll("#clientDashboard .tab-content")
          .forEach((tab) => {
            tab.classList.remove("active");
          });

        // Активировать выбранную кнопку
        const activeBtn = document.querySelector(
          `#clientDashboard .tab-btn[data-tab="${tabId}"]`
        );
        if (activeBtn) activeBtn.classList.add("active");

        // Показать выбранную вкладку
        document.getElementById(`${tabId}Tab`).classList.add("active");

        if (tabId === "journal") {
          loadUserJournal();
          renderJournal();
        } else if (tabId === "appointments") {
          loadUserAppointments();
          renderAppointments();
        } else if (tabId === "search") {
          renderSpecialists();
        }
      }

      // Загрузка дневника пользователя
      function loadUserJournal() {
        journalData = Storage.get(STORAGE_KEYS.JOURNALS) || [];
        journalData = journalData.filter((j) => j.userId === currentUser.id);
      }

      // Переключение вкладок в кабинете специалиста
      function switchSpecialistTab(tabId) {
        // Деактивировать все кнопки
        document
          .querySelectorAll("#specialistDashboard .tab-btn")
          .forEach((btn) => {
            btn.classList.remove("active");
          });

        // Скрыть все вкладки
        document
          .querySelectorAll("#specialistDashboard .tab-content")
          .forEach((tab) => {
            tab.classList.remove("active");
          });

        // Активировать выбранную кнопку
        const activeBtn = document.querySelector(
          `#specialistDashboard .tab-btn[data-tab="${tabId}"]`
        );
        if (activeBtn) activeBtn.classList.add("active");

        // Показать выбранную вкладку
        document.getElementById(`${tabId}Tab`).classList.add("active");

        if (tabId === "schedule") {
          renderCalendar();
        } else if (tabId === "clients") {
          loadSpecialistClients();
          renderClients();
        } else if (tabId === "allAppointments") {
          renderAllAppointments();
        }
      }

      // Инициализация раздела со специалистами
      function initSpecialists() {
        renderSpecialists();

        // Применение фильтров
        document
          .getElementById("applyFilters")
          .addEventListener("click", function () {
            renderSpecialists();
          });

        // Обработка клика по специалисту
        document
          .getElementById("specialistsContainer")
          .addEventListener("click", function (e) {
            if (e.target.classList.contains("btn-register")) {
              const card = e.target.closest(".specialist-card");
              const specialistId = card.getAttribute("data-id");
              openBookingModal(specialistId);
            }
          });
      }

      // Отображение специалистов
      function renderSpecialists() {
        const container = document.getElementById("specialistsContainer");
        container.innerHTML = "";

        const specialtyFilter =
          document.getElementById("specialtyFilter").value;
        const priceFilter = document.getElementById("priceFilter").value;
        const ratingFilter = document.getElementById("ratingFilter").value;
        const searchQuery = document
          .getElementById("searchInput")
          .value.toLowerCase();

        const filteredSpecialists = specialistsData.filter((specialist) => {
          // Фильтр по специализации
          if (specialtyFilter && specialist.specialty !== specialtyFilter) {
            return false;
          }

          // Фильтр по цене
          if (priceFilter) {
            const priceRange = priceFilter.split("-");
            const min = parseInt(priceRange[0]) || 0;

            if (priceRange[1]) {
              const max = parseInt(priceRange[1]) || Infinity;
              if (specialist.price < min || specialist.price > max) {
                return false;
              }
            } else if (specialist.price < min) {
              return false;
            }
          }

          // Фильтр по рейтингу
          if (ratingFilter) {
            const minRating = parseFloat(ratingFilter);
            if (specialist.rating < minRating) {
             return false;
            }
          }

          // Поиск по имени
          if (
            searchQuery &&
            !specialist.name.toLowerCase().includes(searchQuery)
          ) {
            return false;
          }

          return true;
        });

        if (filteredSpecialists.length === 0) {
          container.innerHTML =
            '<p class="no-results">Специалисты не найдены. Попробуйте изменить параметры фильтрации.</p>';
          return;
        }

        filteredSpecialists.forEach((specialist) => {
          const card = document.createElement("div");
          card.className = "specialist-card";
          card.setAttribute("data-id", specialist.id);

          card.innerHTML = `
                    <div class="specialist-header">
                        <img src="${specialist.avatar}" alt="${
            specialist.name
          }" class="specialist-avatar">
                        <h3 class="specialist-name">${specialist.name}</h3>
                        <p class="specialist-specialty">${
                          specialist.specialty
                        }</p>
                    </div>
                    <div class="specialist-body">
                        <div class="specialist-info">
                            <div class="specialist-rating">
                                <span class="rating-stars">${getRatingStars(
                                  specialist.rating
                                )}</span>
                                <span>${specialist.rating} (${
            specialist.reviews
          } отзывов)</span>
                            </div>
                            <p>Опыт работы: ${specialist.experience} лет</p>
                            <p class="specialist-price">${
                              specialist.price
                            } руб. / сеанс</p>
                        </div>
                        <p>${specialist.description}</p>
                    </div>
                    <div class="specialist-footer">
                        <button class="btn btn-register" style="width: 100%">Записаться на консультацию</button>
                    </div>
                `;

          container.appendChild(card);
        });
      }

      // Получение HTML для звезд рейтинга
      function getRatingStars(rating) {
        let stars = "";
        const fullStars = Math.floor(rating);
        const hasHalfStar = rating % 1 >= 0.5;

        for (let i = 0; i < fullStars; i++) {
          stars += '<i class="fas fa-star"></i>';
        }

        if (hasHalfStar) {
          stars += '<i class="fas fa-star-half-alt"></i>';
        }

        const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
        for (let i = 0; i < emptyStars; i++) {
          stars += '<i class="far fa-star"></i>';
        }

        return stars;
      }

      // Инициализация системы бронирования
      function initBooking() {
        // Обработка формы бронирования
        document
          .getElementById("bookingForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            confirmBooking();
          });
      }

      // Открытие модального окна записи
      function openBookingModal(specialistId) {
        const specialist = specialistsData.find((s) => s.id == specialistId);
        if (!specialist) return;

        const selectedDayElement = document.querySelector(
          ".calendar-day.selected"
        );
        if (
          !selectedDayElement ||
          selectedDayElement.classList.contains("disabled")
        ) {
          showNotification("Пожалуйста, выберите день для записи", "error");
          return;
        }

        const selectedDay = selectedDayElement.textContent;
        const selectedTimeElement = document.querySelector(
          ".time-slot.selected"
        );
        if (
          !selectedTimeElement ||
          selectedTimeElement.classList.contains("booked")
        ) {
          showNotification("Пожалуйста, выберите время для записи", "error");
          return;
        }

        const selectedTime = selectedTimeElement.textContent;

        // Заполняем информацию о записи
        const summaryElement = document.getElementById("bookingSummary");
        summaryElement.innerHTML = `
                <div class="booking-detail">
                    <strong>Специалист:</strong> <span>${specialist.name}</span>
                </div>
                <div class="booking-detail">
                    <strong>Дата:</strong> <span>${selectedDay} ${getMonthName(
          currentMonth
        )} ${currentYear}</span>
                </div>
                <div class="booking-detail">
                    <strong>Время:</strong> <span>${selectedTime}</span>
                </div>
                <div class="booking-detail">
                    <strong>Стоимость:</strong> <span>${
                      specialist.price
                    } руб.</span>
                </div>
            `;

        // Сохраняем данные о выбранной записи
        summaryElement.setAttribute("data-specialist-id", specialistId);
        summaryElement.setAttribute("data-day", selectedDay);
        summaryElement.setAttribute("data-time", selectedTime);

        openModal("bookingModal");
      }

      // Подтверждение бронирования
      function confirmBooking() {
        showLoader();

        const summaryElement = document.getElementById("bookingSummary");
        const specialistId = summaryElement.getAttribute("data-specialist-id");
        const day = summaryElement.getAttribute("data-day");
        const time = summaryElement.getAttribute("data-time");
        const notes = document.getElementById("bookingNotes").value;

        const specialist = specialistsData.find((s) => s.id == specialistId);
        if (!specialist) return;

        // Создаем новую запись
        const newAppointment = {
          id: Date.now(),
          type: "client",
          clientId: currentUser.id,
          clientName: currentUser.name,
          specialistId: specialistId,
          specialistName: specialist.name,
          dateDay: parseInt(day),
          dateMonth: currentMonth + 1,
          dateYear: currentYear,
          time: time,
          status: "pending",
          notes: notes,
          createdAt: new Date().toISOString(),
        };

        // Сохраняем запись
        const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
        appointments.push(newAppointment);
        Storage.set(STORAGE_KEYS.APPOINTMENTS, appointments);

        // Обновляем данные
        appointmentsData.push(newAppointment);
        updateBookingsFromAppointments();

        setTimeout(() => {
          hideLoader();
          closeModal("bookingModal");
          showNotification(
            "Запись успешно создана! Ожидайте подтверждения от специалиста.",
            "success"
          );

          // Обновляем календарь
          renderCalendar();
          renderTimeSlots(day);
        }, 500);
      }

      // Получение названия месяца
      function getMonthName(monthIndex) {
        const months = [
          "января",
          "февраля",
          "марта",
          "апреля",
          "мая",
          "июня",
          "июля",
          "августа",
          "сентября",
          "октября",
          "ноября",
          "декабря",
        ];
        return months[monthIndex];
      }

      // Инициализация календаря
      function initCalendar() {
        document
          .getElementById("prevMonth")
          .addEventListener("click", function () {
            currentMonth--;
            if (currentMonth < 0) {
              currentMonth = 11;
              currentYear--;
            }
            renderCalendar();
          });

        document
          .getElementById("nextMonth")
          .addEventListener("click", function () {
            currentMonth++;
            if (currentMonth > 11) {
              currentMonth = 0;
              currentYear++;
            }
            renderCalendar();
          });

        // Выбор дня
        document
          .getElementById("calendarDays")
          .addEventListener("click", function (e) {
            if (
              e.target.classList.contains("calendar-day") &&
              !e.target.classList.contains("disabled")
            ) {
              document
                .querySelectorAll(".calendar-day")
                .forEach((day) => day.classList.remove("selected"));
              e.target.classList.add("selected");
              renderTimeSlots(e.target.textContent);
            }
          });

        // Выбор слота
        document
          .getElementById("timeSlotsContainer")
          .addEventListener("click", function (e) {
            if (
              e.target.classList.contains("time-slot")
            ) {
              if (e.target.classList.contains("booked")) {
                // Переключаемся на вкладку со всеми записями
                switchSpecialistTab("allAppointments");
              } else {
                document
                  .querySelectorAll(".time-slot")
                  .forEach((slot) => slot.classList.remove("selected"));
                e.target.classList.add("selected");

                // Получаем день
                const selectedDayElement = document.querySelector(".calendar-day.selected");
                if (selectedDayElement) {
                  const day = selectedDayElement.textContent;
                  const time = e.target.textContent;
                  openScheduleChoiceModal(day, time);
                }
              }
            }
          });

        // Сохранение расписания
        document
          .getElementById("saveSchedule")
          .addEventListener("click", function () {
            showLoader();

            setTimeout(() => {
              hideLoader();
              showNotification("Расписание успешно сохранено", "success");
            }, 500);
          });

        renderCalendar();
      }

      function openScheduleChoiceModal(day, time) {
        document.getElementById("scheduleChoiceModal").setAttribute("data-day", day);
        document.getElementById("scheduleChoiceModal").setAttribute("data-time", time);
        openModal("scheduleChoiceModal");
      }

      // Отображение календаря
      function renderCalendar() {
        const calendarDays = document.getElementById("calendarDays");
        calendarDays.innerHTML = "";

        const monthNames = [
          "Январь",
          "Февраль",
          "Март",
          "Апрель",
          "Май",
          "Июнь",
          "Июль",
          "Август",
          "Сентябрь",
          "Октябрь",
          "Ноябрь",
          "Декабрь",
        ];
        document.getElementById(
          "calendarMonth"
        ).textContent = `${monthNames[currentMonth]} ${currentYear}`;

        // Заголовки дней недели
        const daysOfWeek = ["Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"];
        daysOfWeek.forEach((day) => {
          const dayElement = document.createElement("div");
          dayElement.className = "calendar-day";
          dayElement.textContent = day;
          dayElement.style.fontWeight = "bold";
          calendarDays.appendChild(dayElement);
        });

        const firstDay = new Date(currentYear, currentMonth, 1).getDay();
        const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1; // Корректировка для отображения понедельника первым
        const daysInMonth = new Date(
          currentYear,
          currentMonth + 1,
          0
        ).getDate();

        // Пустые ячейки для дней предыдущего месяца
        for (let i = 0; i < adjustedFirstDay; i++) {
          const emptyDay = document.createElement("div");
          emptyDay.className = "calendar-day disabled";
          calendarDays.appendChild(emptyDay);
        }

        // Дни текущего месяца
        for (let i = 1; i <= daysInMonth; i++) {
          const dayElement = document.createElement("div");
          dayElement.className = "calendar-day";
          dayElement.textContent = i;

          // Проверяем, есть ли бронирования на этот день
          const dateKey = `${currentYear}-${currentMonth + 1}-${i}`;
          if (bookings[dateKey]) {
            dayElement.classList.add("has-bookings");
          }

          // Проверяем, является ли день прошедшим
          const currentDate = new Date();
          const cellDate = new Date(currentYear, currentMonth, i);
          if (
            cellDate < currentDate &&
            cellDate.getDate() !== currentDate.getDate()
          ) {
            dayElement.classList.add("disabled");
          }

          calendarDays.appendChild(dayElement);
        }

        renderTimeSlots();
      }

      // Отображение временных слотов
      function renderTimeSlots(selectedDay = null) {
        const timeSlotsContainer =
          document.getElementById("timeSlotsContainer");
        timeSlotsContainer.innerHTML = "";

        if (!selectedDay) {
          timeSlotsContainer.innerHTML =
            "<p style='text-align: center; color: var(--text-light);'></p>";
          return;
        }

        const timeSlots = [
          "09:00",
          "10:00",
          "11:00",
          "12:00",
          "13:00",
          "14:00",
          "15:00",
          "16:00",
          "17:00",
          "18:00",
        ];

        timeSlots.forEach((slot, index) => {
          const slotElement = document.createElement("div");
          slotElement.className = "time-slot";
          slotElement.textContent = slot;
          slotElement.style.animationDelay = `${index * 0.1}s`;

          const dateKey = `${currentYear}-${currentMonth + 1}-${selectedDay}`;
          if (bookings[dateKey] && bookings[dateKey][slot]) {
            slotElement.classList.add("booked");
            slotElement.setAttribute("data-client", bookings[dateKey][slot]);
          }

          timeSlotsContainer.appendChild(slotElement);
        });
      }

      // Инициализация уведомлений
      function initNotifications() {
        // Код уже реализован в функциях showNotification, createNotification
      }

      // Показать уведомление
      function showNotification(message, type = "info") {
        const notification = createNotification(message, type);
        const container = document.getElementById("notificationContainer");

        container.appendChild(notification);

        // Показать уведомление
        setTimeout(() => {
          notification.classList.add("show");
        }, 100);

        // Скрыть уведомление через 5 секунд
        setTimeout(() => {
          notification.classList.remove("show");
          notification.classList.add("hide");

          // Удалить уведомление из DOM после анимации
          setTimeout(() => {
            if (notification.parentNode) {
              container.removeChild(notification);
            }
          }, 300);
        }, 5000);
      }

      // Создание элемента уведомления
      function createNotification(message, type) {
        const notification = document.createElement("div");
        notification.className = `notification ${type}`;

        let icon = "info-circle";
        if (type === "success") icon = "check-circle";
        if (type === "error") icon = "exclamation-circle";

        notification.innerHTML = `
                <i class="fas fa-${icon} notification-icon"></i>
                <div class="notification-message">${message}</div>
            `;

        return notification;
      }

      // Показать индикатор загрузки
      function showLoader() {
        document.getElementById("loaderOverlay").classList.add("active");
      }

      // Скрыть индикатор загрузки
      function hideLoader() {
        document.getElementById("loaderOverlay").classList.remove("active");
      }

      // Инициализация дашборда
      function initDashboard() {
        // Загрузка данных клиентов для специалиста
        renderClients();

        // Загрузка записей для клиента
        renderAppointments();

        // Обработчик для кнопок в карточках клиентов
        document.getElementById("clientsContainer").addEventListener("click", function (e) {
          if (e.target.classList.contains("notes-btn")) {
            const clientId = e.target.getAttribute("data-client-id");
            openNotesModal(clientId);
          }
          if (e.target.classList.contains("book-client-btn")) {
            const clientId = e.target.getAttribute("data-client-id");
            openBookClientModal(clientId);
          }
        });
      }

      // Отображение клиентов
      function renderClients() {
        const container = document.getElementById("clientsContainer");
        container.innerHTML = "";

        if (clientsData.length === 0) {
          container.innerHTML = "<p>У вас пока нет клиентов.</p>";
          return;
        }

        clientsData.forEach((client) => {
          const card = document.createElement("div");
          card.className = "client-card";

          card.innerHTML = `
                    <div class="client-header">
                        <img src="https://randomuser.me/api/portraits/${Math.random() > 0.5 ? "women" : "men"}/${Math.floor(Math.random() * 50)}.jpg" alt="${
            client.name
          }" class="client-avatar">
                        <div>
                            <h3 class="client-name">${client.name}</h3>
                            <p class="client-next-session">Следующая сессия: ${
                              client.nextSession
                            }</p>
                        </div>
                    </div>
                    <p><strong>Телефон:</strong> ${
                      client.phone || "Не указан"
                    }</p>
                    <p><strong>Email:</strong> ${client.email}</p>
                    <div class="client-actions">
                        <button class="btn btn-login notes-btn" data-client-id="${
                          client.id
                        }">Заметки</button>
                        <button class="btn btn-register book-client-btn" data-client-id="${
                          client.id
                        }">Записать</button>
                    </div>
                `;

          container.appendChild(card);
        });
      }

      // Отображение записей клиента
      function renderAppointments() {
        const container = document.getElementById("appointmentsContainer");
        container.innerHTML = "";

        if (appointmentsData.length === 0) {
          container.innerHTML =
            "<p>У вас пока нет записей на консультации.</p>";
          return;
        }

        appointmentsData.forEach((appointment) => {
          const appointmentElement = document.createElement("div");
          appointmentElement.className = "help-card";

          let statusText = "";
          if (appointment.status === "confirmed") {
            statusText =
              '<span style="color: var(--success);">Подтверждена</span>';
          } else if (appointment.status === "pending") {
            statusText =
              '<span style="color: #f39c12;">Ожидание подтверждения</span>';
          } else if (appointment.status === "cancelled") {
            statusText = '<span style="color: var(--error);">Отменена</span>';
          }

          appointmentElement.innerHTML = `
                    <h3 class="help-title"><i class="fas fa-calendar-check"></i> Консультация у ${
                      appointment.specialistName
                    }</h3>
                    <p><strong>Дата и время:</strong> ${
                      appointment.dateDay
                    } ${getMonthName(appointment.dateMonth - 1)} ${
            appointment.dateYear
          }, ${appointment.time}</p>
                    <p><strong>Статус:</strong> ${statusText}</p>
                    <div class="client-actions" style="margin-top: 1rem;">
                        <button class="btn btn-login">Перенести</button>
                        <button class="btn btn-register">Отменить</button>
                    </div>
                `;

          container.appendChild(appointmentElement);
        });
      }

      // Инициализация заметок
      function initNotes() {
        // Выбор эмоций
        document.querySelectorAll(".emotion-option").forEach((option) => {
          option.addEventListener("click", function () {
            this.classList.toggle("selected");
          });
        });

        // Добавление заметки
        document
          .getElementById("notesForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            const clientId = this.getAttribute("data-client-id");
            const content = document.getElementById("noteContent").value;
            const emotions = Array.from(
              document.querySelectorAll(".emotion-option.selected")
            ).map((el) => el.getAttribute("data-emotion"));

            if (content.trim() === "") return;

            // Создаем новую заметку
            const newNote = {
              id: Date.now(),
              clientId: parseInt(clientId),
              specialistId: currentUser.id,
              date: new Date().toLocaleDateString("ru-RU"),
              content,
              emotions,
              createdAt: new Date().toISOString(),
            };

            // Сохраняем заметку
            const notes = Storage.get(STORAGE_KEYS.NOTES) || [];
            notes.push(newNote);
            Storage.set(STORAGE_KEYS.NOTES, notes);

            // Обновляем данные
            notesData.push(newNote);

            document.getElementById("noteContent").value = "";
            document
              .querySelectorAll(".emotion-option")
              .forEach((el) => el.classList.remove("selected"));

            renderNotes(clientId);
            showNotification("Заметка добавлена", "success");
          });
      }

      // Открытие модального окна заметок
      function openNotesModal(clientId) {
        const client = clientsData.find((c) => c.id == clientId);
        if (client) {
          document.getElementById(
            "notesTitle"
          ).textContent = `Заметки для ${client.name}`;
          document
            .getElementById("notesForm")
            .setAttribute("data-client-id", clientId);
          renderNotes(clientId);
          openModal("notesModal");
        }
      }

      // Отображение заметок
      function renderNotes(clientId) {
        const container = document.getElementById("notesList");
        container.innerHTML = "";

        const clientNotes = notesData.filter((n) => n.clientId == clientId);

        if (clientNotes.length === 0) {
          container.innerHTML = "<p>Заметок пока нет.</p>";
          return;
        }

        clientNotes.forEach((note, index) => {
          const entry = document.createElement("div");
          entry.className = "note-entry";
          entry.style.animationDelay = `${index * 0.1}s`;

          entry.innerHTML = `
                    <div class="note-date">${note.date}</div>
                    <div class="note-content">${note.content}</div>
                    <div class="note-emotions">
                        ${
                          note.emotions
                            ? note.emotions
                                .map(
                                  (emo) =>
                                    `<span class="emotion-tag">${emo}</span>`
                                )
                                .join("")
                            : ""
                        }
                    </div>
                `;

          container.appendChild(entry);
        });
      }

      // Инициализация дневника клиента
      function initJournal() {
        document
          .getElementById("journalForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            const content = document.getElementById("journalContent").value;

            if (content.trim() === "") return;

            // Создаем новую запись в дневнике
            const newJournalEntry = {
              id: Date.now(),
              userId: currentUser.id,
              date: new Date().toLocaleDateString("ru-RU"),
              content,
              createdAt: new Date().toISOString(),
            };

            // Сохраняем запись
            const journals = Storage.get(STORAGE_KEYS.JOURNALS) || [];
            journals.push(newJournalEntry);
            Storage.set(STORAGE_KEYS.JOURNALS, journals);

            // Обновляем данные
            journalData.push(newJournalEntry);

            document.getElementById("journalContent").value = "";
            renderJournal();
            showNotification("Запись добавлена в дневник", "success");
          });
      }

      // Отображение дневника
      function renderJournal() {
        const container = document.getElementById("journalEntries");
        container.innerHTML = "";

        if (journalData.length === 0) {
          container.innerHTML = "<p>Записей пока нет.</p>";
          return;
        }

        journalData.forEach((entry, index) => {
          const journalEntry = document.createElement("div");
          journalEntry.className = "journal-entry animate";
          journalEntry.style.animationDelay = `${index * 0.1}s`;

          journalEntry.innerHTML = `
                    <div class="journal-date">${entry.date}</div>
                    <div class="journal-content">${entry.content}</div>
                `;

          container.appendChild(journalEntry);
        });
      }

      // Инициализация всех записей специалиста
      function initSpecialistAppointments() {
        document.getElementById("allAppointmentsContainer").addEventListener("click", function (e) {
          if (e.target.tagName === "BUTTON") {
            const appId = e.target.getAttribute("data-app-id");
            const appIndex = appointmentsData.findIndex(a => a.id == appId);
            if (appIndex !== -1) {
              if (e.target.textContent === "Подтвердить") {
                appointmentsData[appIndex].status = "confirmed";
                showNotification("Запись подтверждена", "success");
              } else if (e.target.textContent === "Отменить") {
                appointmentsData[appIndex].status = "cancelled";
                showNotification("Запись отменена", "error");
              }
              Storage.set(STORAGE_KEYS.APPOINTMENTS, appointmentsData);
              updateBookingsFromAppointments();
              renderAllAppointments();
            }
          }
        });
      }

      // Отображение всех записей специалиста с сортировкой и группировкой по дням
      function renderAllAppointments() {
        const container = document.getElementById("allAppointmentsContainer");
        container.innerHTML = "";

        const mySpecialist = specialistsData.find(s => s.userId === currentUser.id);
        if (!mySpecialist) {
          container.innerHTML = "<p>Ошибка: специалист не найден.</p>";
          return;
        }

        let myAppointments = appointmentsData.filter(a => a.specialistId === mySpecialist.id);

        if (myAppointments.length === 0) {
          container.innerHTML = "<p>Записей пока нет.</p>";
          return;
        }

        // Сортировка по дате и времени
        myAppointments.sort((a, b) => {
          const dateA = new Date(a.dateYear, a.dateMonth - 1, a.dateDay, parseInt(a.time.split(':')[0]), parseInt(a.time.split(':')[1]));
          const dateB = new Date(b.dateYear, b.dateMonth - 1, b.dateDay, parseInt(b.time.split(':')[0]), parseInt(b.time.split(':')[1]));
          return dateA - dateB;
        });

        // Группировка по дням
        let currentDate = null;
        myAppointments.forEach(app => {
          const appDate = `${app.dateDay}.${app.dateMonth}.${app.dateYear}`;
          if (appDate !== currentDate) {
            const dateHeader = document.createElement("h3");
            dateHeader.textContent = appDate;
            dateHeader.style.marginTop = "1rem";
            container.appendChild(dateHeader);
            currentDate = appDate;
          }

          const card = document.createElement("div");
          if (app.type === "plan") {
            card.className = "client-card plan-card";
            card.innerHTML = `
              <h3><i class="fas fa-calendar-alt"></i> ${app.planTitle} - ${app.time}</h3>
              <p>Описание: ${app.planDescription}</p>
              <p>Статус: <span style="color: var(--success);">Запланировано</span></p>
              <div class="client-actions" style="margin-top: 1rem;">
                <button class="btn btn-register cancel-btn" data-app-id="${app.id}">Отменить</button>
              </div>
            `;
          } else {
            card.className = "client-card";
            let statusText = "";
            let actions = "";
            if (app.status === "confirmed") {
              statusText = '<span style="color: var(--success);">Подтверждена</span>';
              actions = `
                <div class="client-actions">
                  <button class="btn btn-register cancel-btn" data-app-id="${app.id}">Отменить</button>
                </div>
              `;
            } else if (app.status === "pending") {
              statusText = '<span style="color: #f39c12;">Ожидание подтверждения</span>';
              actions = `
                <div class="client-actions">
                  <button class="btn btn-login" data-app-id="${app.id}">Подтвердить</button>
                  <button class="btn btn-register cancel-btn" data-app-id="${app.id}">Отменить</button>
                </div>
              `;
            } else if (app.status === "cancelled") {
              statusText = '<span style="color: var(--error);">Отменена</span>';
            }

            card.innerHTML = `
              <h3><i class="fas fa-user"></i> ${app.clientName} - ${app.time}</h3>
              <p>Статус: ${statusText}</p>
              <p>Заметки: ${app.notes || "Нет"}</p>
              ${actions}
            `;
          }

          container.appendChild(card);
        });
      }

      // Инициализация записи клиента специалистом
      function initBookClient() {
        let bookCurrentMonth = new Date().getMonth();
        let bookCurrentYear = new Date().getFullYear();

        function renderBookCalendar() {
          const calendarDays = document.getElementById("bookCalendarDays");
          calendarDays.innerHTML = "";

          const monthNames = [
            "Январь",
            "Февраль",
            "Март",
            "Апрель",
            "Май",
            "Июнь",
            "Июль",
            "Август",
            "Сентябрь",
            "Октябрь",
            "Ноябрь",
            "Декабрь",
          ];
          document.getElementById(
            "bookCalendarMonth"
          ).textContent = `${monthNames[bookCurrentMonth]} ${bookCurrentYear}`;

          // Заголовки дней недели
          const daysOfWeek = ["Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"];
          daysOfWeek.forEach((day) => {
            const dayElement = document.createElement("div");
            dayElement.className = "calendar-day";
            dayElement.textContent = day;
            dayElement.style.fontWeight = "bold";
            calendarDays.appendChild(dayElement);
          });

          const firstDay = new Date(bookCurrentYear, bookCurrentMonth, 1).getDay();
          const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1;
          const daysInMonth = new Date(
            bookCurrentYear,
            bookCurrentMonth + 1,
            0
          ).getDate();

          for (let i = 0; i < adjustedFirstDay; i++) {
            const emptyDay = document.createElement("div");
            emptyDay.className = "calendar-day disabled";
            calendarDays.appendChild(emptyDay);
          }

          for (let i = 1; i <= daysInMonth; i++) {
            const dayElement = document.createElement("div");
            dayElement.className = "calendar-day";
            dayElement.textContent = i;

            const dateKey = `${bookCurrentYear}-${bookCurrentMonth + 1}-${i}`;
            if (bookings[dateKey]) {
              dayElement.classList.add("has-bookings");
            }

            const currentDate = new Date();
            const cellDate = new Date(bookCurrentYear, bookCurrentMonth, i);
            if (
              cellDate < currentDate &&
              cellDate.getDate() !== currentDate.getDate()
            ) {
              dayElement.classList.add("disabled");
            }

            calendarDays.appendChild(dayElement);
          }

          renderBookTimeSlots();
        }

        function renderBookTimeSlots(selectedDay = null) {
          const timeSlotsContainer = document.getElementById("bookTimeSlotsContainer");
          timeSlotsContainer.innerHTML = "";

          if (!selectedDay) {
            timeSlotsContainer.innerHTML = "<p></p>";
            return;
          }

          const timeSlots = [
            "09:00", "10:00", "11:00", "12:00", "13:00",
            "14:00", "15:00", "16:00", "17:00", "18:00",
          ];

          timeSlots.forEach((slot, index) => {
            const slotElement = document.createElement("div");
            slotElement.className = "time-slot";
            slotElement.textContent = slot;
            slotElement.style.animationDelay = `${index * 0.1}s`;

            const dateKey = `${bookCurrentYear}-${bookCurrentMonth + 1}-${selectedDay}`;
            if (bookings[dateKey] && bookings[dateKey][slot]) {
              slotElement.classList.add("booked");
              slotElement.setAttribute("data-client", bookings[dateKey][slot]);
            }

            timeSlotsContainer.appendChild(slotElement);
          });
        }

        // Обработчики для модального календаря
        document.getElementById("bookPrevMonth").addEventListener("click", () => {
          bookCurrentMonth--;
          if (bookCurrentMonth < 0) {
            bookCurrentMonth = 11;
            bookCurrentYear--;
          }
          renderBookCalendar();
        });

        document.getElementById("bookNextMonth").addEventListener("click", () => {
          bookCurrentMonth++;
          if (bookCurrentMonth > 11) {
            bookCurrentMonth = 0;
            bookCurrentYear++;
          }
          renderBookCalendar();
        });

        document.getElementById("bookCalendarDays").addEventListener("click", (e) => {
          if (
            e.target.classList.contains("calendar-day") &&
            !e.target.classList.contains("disabled")
          ) {
            document
              .querySelectorAll("#bookCalendarDays .calendar-day")
              .forEach((day) => day.classList.remove("selected"));
            e.target.classList.add("selected");
            renderBookTimeSlots(e.target.textContent);
          }
        });

        document.getElementById("bookTimeSlotsContainer").addEventListener("click", (e) => {
          if (
            e.target.classList.contains("time-slot") &&
            !e.target.classList.contains("booked")
          ) {
            document
              .querySelectorAll("#bookTimeSlotsContainer .time-slot")
              .forEach((slot) => slot.classList.remove("selected"));
            e.target.classList.add("selected");
          }
        });

        // Подтверждение записи клиента
        document.getElementById("confirmBookClient").addEventListener("click", () => {
          const modal = document.getElementById("bookClientModal");
          const clientId = modal.getAttribute("data-client-id");
          const selectedDayElement = document.querySelector("#bookCalendarDays .calendar-day.selected");
          if (!selectedDayElement) {
            showNotification("Выберите день", "error");
            return;
          }
          const selectedDay = selectedDayElement.textContent;
          const selectedTimeElement = document.querySelector("#bookTimeSlotsContainer .time-slot.selected");
          if (!selectedTimeElement) {
            showNotification("Выберите время", "error");
            return;
          }
          const selectedTime = selectedTimeElement.textContent;

          const mySpecialist = specialistsData.find(s => s.userId === currentUser.id);
          const client = clientsData.find(c => c.id == clientId);

          if (!mySpecialist || !client) return;

          const newAppointment = {
            id: Date.now(),
            type: "client",
            clientId: client.id,
            clientName: client.name,
            specialistId: mySpecialist.id,
            specialistName: mySpecialist.name,
            dateDay: parseInt(selectedDay),
            dateMonth: bookCurrentMonth + 1,
            dateYear: bookCurrentYear,
            time: selectedTime,
            status: "confirmed",
            notes: "",
            createdAt: new Date().toISOString(),
          };

          // Save to storage
          const appointments = Storage.get(STORAGE_KEYS.APPOINTMENTS) || [];
          appointments.push(newAppointment);
          Storage.set(STORAGE_KEYS.APPOINTMENTS, appointments);

          // Update local data
          appointmentsData.push(newAppointment);
          updateBookingsFromAppointments();

          // Close modal
          closeModal("bookClientModal");
          showNotification("Запись для клиента создана", "success");

          // Refresh views
          renderAllAppointments();
          loadSpecialistClients();
          renderClients();
        });
      }

      // Открытие модального окна записи клиента
      function openBookClientModal(clientId) {
        document.getElementById("bookClientModal").setAttribute("data-client-id", clientId);

        // Reset selections
        document.querySelectorAll("#bookCalendarDays .calendar-day").forEach(day => day.classList.remove("selected"));
        document.querySelectorAll("#bookTimeSlotsContainer .time-slot").forEach(slot => slot.classList.remove("selected"));

        // Render calendar for current month
        const bookCurrentMonth = new Date().getMonth();
        const bookCurrentYear = new Date().getFullYear();
        // Note: Assuming global variables or pass them if needed; for simplicity, re-render

        openModal("bookClientModal");
      }
    </script>
  </body>
</html>
```